FILE_DATA = {"example_recipes.py": "RVhBTVBMRV9SRUNJUEVTX0NPTExFQ1RJT046IGRpY3QgPSB7CiAgICAiZXhhbXBsZV9yZWNpcGUucmVjaXBlIjogewogICAgICAgICJuYW1lIjogIkVYQU1QTEVfIFJFQ0lQRSIsCiAgICAgICAgImRlc2NyaXB0aW9uIjogIkEgbmljZSBFeGFtcGxlIENvY2t0YWlsIiwKICAgICAgICAidmVyc2lvbiI6ICIxLjAuMCIsCiAgICAgICAgImluZ3JlZGllbnRzIjogeyIwIjogIkEiLCAiMSI6ICJCIiwgIjIiOiAiQyJ9LAogICAgICAgICJzdGVwcyI6IFsKICAgICAgICAgICAgeyJhY3Rpb24iOiAic2NhbGUiLCAiaW5ncmVkaWVudCI6ICIwIiwgImFtb3VudCI6IDEwfSwKICAgICAgICAgICAgeyJhY3Rpb24iOiAiY29uZmlybSIsICJ0ZXh0IjogInNoYWtlIGl0In0sCiAgICAgICAgICAgIHsiYWN0aW9uIjogIndhaXQiLCAidGV4dCI6ICJ3YWl0IGZvciBpdCIsICJhbW91bnQiOiAyMH0sCiAgICAgICAgXSwKICAgIH0sCiAgICAiVGVxdWlsYV9TdW5yaXNlLnJlY2lwZSI6IHsKICAgICAgICAibmFtZSI6ICJUZXF1aWxhIFN1bnJpc2UiLAogICAgICAgICJkZXNjcmlwdGlvbiI6ICJBIG5pY2UgVGVxdWlsYSBTdW5yaXNlIENvY2t0YWlsIiwKICAgICAgICAidmVyc2lvbiI6ICIxLjAuMCIsCiAgICAgICAgImluZ3JlZGllbnRzIjogeyIwIjogIndlacOfZXIgVGVxdWlsYSIsICIxIjogIk9yYW5nZW5zYWZ0IiwgIjIiOiAiR3JlbmFkaW5lIn0sCiAgICAgICAgInN0ZXBzIjogWwogICAgICAgICAgICB7ImFjdGlvbiI6ICJzY2FsZSIsICJpbmdyZWRpZW50IjogIjAiLCAiYW1vdW50IjogMTB9LAogICAgICAgICAgICB7ImFjdGlvbiI6ICJzY2FsZSIsICJpbmdyZWRpZW50IjogIjEiLCAiYW1vdW50IjogMTIwfSwKICAgICAgICAgICAgeyJhY3Rpb24iOiAiY29uZmlybSIsICJ0ZXh0IjogIkFERCBJQ0UifSwKICAgICAgICAgICAgeyJhY3Rpb24iOiAic2NhbGUiLCAiaW5ncmVkaWVudCI6ICIyIiwgImFtb3VudCI6IDQwfSwKICAgICAgICAgICAgeyJhY3Rpb24iOiAid2FpdCIsICJ0ZXh0IjogIldBSVQgRk9SIFNFVFRMRSBET1dOIiwgImFtb3VudCI6IDEwfSwKICAgICAgICBdLAogICAgfSwKICAgICJTdHJhd2JlcnJ5X0NvbGFkYS5yZWNpcGUiOiB7CiAgICAgICAgIm5hbWUiOiAiU3RyYXdiZXJyeSBDb2xhZGEiLAogICAgICAgICJkZXNjcmlwdGlvbiI6ICJBIGZydWl0eSBzdHJhd2JlcnJ5IGNvY2t0YWlsIHdpdGggY29jb251dCIsCiAgICAgICAgInZlcnNpb24iOiAiMS4wLjAiLAogICAgICAgICJpbmdyZWRpZW50cyI6IHsKICAgICAgICAgICAgIjAiOiAiMTAgU3RyYXdiZXJyaWVzIiwKICAgICAgICAgICAgIjEiOiAiQ29jb251dC1KdWljZSIsCiAgICAgICAgICAgICIyIjogIkNyZWFtIiwKICAgICAgICAgICAgIjMiOiAiUGluZWFwcGxlLUp1aWNlIiwKICAgICAgICAgICAgIjQiOiAid2hpdGUgUnVtIiwKICAgICAgICAgICAgIjUiOiAiQ3J1c2hlZCBJY2UiLAogICAgICAgIH0sCiAgICAgICAgInN0ZXBzIjogWwogICAgICAgICAgICB7ImFjdGlvbiI6ICJjb25maXJtIiwgInRleHQiOiAicHVyZWUgc3RyYXdiZXJyaWVzIn0sCiAgICAgICAgICAgIHsiYWN0aW9uIjogImNvbmZpcm0iLCAidGV4dCI6ICJhZGQgMS8yIGNydXNoZWQgaWNlIn0sCiAgICAgICAgICAgIHsiYWN0aW9uIjogInNjYWxlIiwgImluZ3JlZGllbnQiOiAiMSIsICJhbW91bnQiOiA2MH0sCiAgICAgICAgICAgIHsiYWN0aW9uIjogInNjYWxlIiwgImluZ3JlZGllbnQiOiAiMiIsICJhbW91bnQiOiAzMH0sCiAgICAgICAgICAgIHsiYWN0aW9uIjogInNjYWxlIiwgImluZ3JlZGllbnQiOiAiMyIsICJhbW91bnQiOiA4MH0sCiAgICAgICAgICAgIHsiYWN0aW9uIjogInNjYWxlIiwgImluZ3JlZGllbnQiOiAiNCIsICJhbW91bnQiOiA1MH0sCiAgICAgICAgICAgIHsiYWN0aW9uIjogIndhaXQiLCAidGV4dCI6ICJTaGFrZSIsICJhbW91bnQiOiAzMH0sCiAgICAgICAgXSwKICAgIH0sCn0K", "main.py": "ZnJvbSB1dGltZSBpbXBvcnQgc2xlZXBfdXMNCmltcG9ydCBtYWNoaW5lDQppbXBvcnQgdGltZQ0KaW1wb3J0IG1hdGgNCmltcG9ydCBuZW9waXhlbA0KaW1wb3J0IHJhbmRvbQ0KaW1wb3J0IGhlbHBlcg0KaW1wb3J0IFNjYWxlcw0KaW1wb3J0IGNvbmZpZw0KaW1wb3J0IHJlY2lwZV9sb2FkZXINCmltcG9ydCB1aQ0KDQpwcmludCgibWFpbjogX19lbnRyeV9fIikNCg0KDQojIFNZU1RFTSBTVEFURVMNClNZU1RBVEVfSURMRSA9IDANCiMgTUVOVQ0KU1lTVEVNU1RBVEVfRU5URVJfTUFJTk1FTlUgPSAxDQpTWVNURU1TVEFURV9NQUlOTUVOVSA9IDINCg0KIyBNSVNDIE1PREVTDQpTWVNURU1TVEFURV9TQ0FMRV9NT0RFID0gMw0KU1lTVEVNU1RBVEVfVVBEQVRFX01PREUgPSA0DQpTWVNURU1TVEFURV9DQUxJQlJBVElPTl9NT0RFX0VOVFJZID0gNQ0KU1lTVEVNU1RBVEVfUkFXX01PREUgPSA2DQoNClNZU1RFTVNUQVRFX0NBTElCUkFUSU9OX01PREVfWkVSTyA9IDcNClNZU1RFTVNUQVRFX0NBTElCUkFUSU9OX01PREVfRlVMTCA9IDgNCiMgU0NBTEUgRU5BQkxFRA0KU1lTVEFURV9SRUNJUEVfU1RBUlQgPSAxMA0KU1lTVEFURV9SRUNJUEVfU0hPV19JTkdSRURJRU5UUyA9IDExDQpTWVNUQVRFX1JFQ0lQRV9QTEFDRUdMQVNTID0gMTINClNZU1RBVEVfUkVDSVBFX1JVTk5JTkcgPSAxMw0KU1lTVEFURV9SRUNJUEVfRklOSVNIRUQgPSAxNA0KDQpTWVNURU1TVEFURV9VUERBVEVfTU9ERV9RUl9TVEFSVCA9IDIwDQpTWVNURU1TVEFURV9VUERBVEVfTU9ERV9RUl9SVU5OSU5HID0gMjENCg0KVUJfTk9ORSA9IDANClVCX1JFTEVBU0UgPSAxDQpVQl9VUCA9IDINClVCX1VQTE9ORyA9IDMNClVCX0RPV04gPSA0DQoNCg0KaWYgX19uYW1lX18gPT0gIl9fbWFpbl9fIjoNCiAgICAgICAgDQogICAgc3lzdGVtX3N0YXRlID0gU1lTVEFURV9JRExFDQogICAgIyBJTklUIFJFQ0lQRSBMT0FERVIgQU5EIElOSVQgU0QgQ0FSRA0KICAgIHJlY2lwZSA9IHJlY2lwZV9sb2FkZXIucmVjaXBlX2xvYWRlcigpDQogICAgICAgIA0KICAgICMgSU5JVCBORU9QSVhFTCBSSU5HDQogICAgbmVvcGl4ZWxyaW5nID0gbmVvcGl4ZWwuTmVvUGl4ZWwobWFjaGluZS5QaW4oY29uZmlnLkNGR19ORU9QSVhFTF9QSU4pLCBjb25maWcuQ0ZHX05FT1BJWEVMX0xFRF9DT1VOVCkNCiAgICBoZWxwZXIuc2V0X25lb3BpeGVsX3JhbmRvbShuZW9waXhlbHJpbmcpDQogICAgDQogICAgIyBJTklUIERJU1BMQVk3DQogICAgZ3VpID0gdWkudWkoKQ0KICAgICMgSU5JVCBTQ0FMRQ0KDQogICAgc2NhbGVzID0gU2NhbGVzLlNjYWxlcyhkX291dD1jb25maWcuQ0ZHX0hYNzExX0RPVVRfUElOLCBwZF9zY2s9Y29uZmlnLkNGR19IWDcxMV9TQ0tfUElOKQ0KICAgIHNjYWxlcy50YXJlKCkNCiAgICANCiAgICANCiAgICANCiAgICAjIENBTElCVEFUSU9OIFZBTFVFUw0KICAgICMgVE9ETyBMT0FEIEZGUk9NIFNFVFRJTkdTDQogICAgY2FsaWJyYXRpb25fZmFjdG9yID0gcmVjaXBlLmdldF9jYWxpYnJhdGlvbl9mYWN0b3IoKQ0KICAgIHByaW50KCJjYWxpYnJhdGlvbl9mYWN0b3Ige30iLmZvcm1hdChjYWxpYnJhdGlvbl9mYWN0b3IpKQ0KICAgIG1hcF92YWx1ZV8wZyA9IDANCiAgICBtYXBfdmFsdWVfNTBnID0gMA0KICAgIA0KICAgIHNjYWxlcy5zZXRfc2NhbGUoY2FsaWJyYXRpb25fZmFjdG9yKQ0KICAgIHNjYWxlcy50YXJlKCkNCiAgICANCiAgICANCiAgICB0YXJlX3ZhbHVlID0gc2NhbGVzLmdldF91bml0KFRydWUpICMgU1RBQkxFIFJFQUQNCiAgICB0YXJlX3ZhbHVlX2luaXRpYWwgPSB0YXJlX3ZhbHVlDQogICAgcHJpbnQoInRhcmVfdmFsdWU6e30iLmZvcm1hdCh0YXJlX3ZhbHVlKSkNCiAgICBzY2FsZV92YWx1ZSA9IDANCiAgICBwcmludCgibG9hZGVkIHNjYWxlIGNhbGlicmF0aW9uIHZhbHVlZCBjYWxfd3t9IGNhbC1mYWN0e30iLmZvcm1hdChjb25maWcuQ0ZHX0NBTElCUkFUSU9OX1dFSUdIVF9XRUlHSFQsIGNhbGlicmF0aW9uX2ZhY3RvcikpDQogICAgDQogICAgDQogICAgIyBDT05GSUdVUkUgVVNFUiBCVVRUT05TDQogICAgcHVzaF9idXR0b25fdXAgPSBtYWNoaW5lLlBpbihjb25maWcuQ0ZHX0JVVFRPTl9VUF9QSU4sIG1hY2hpbmUuUGluLklOLCBtYWNoaW5lLlBpbi5QVUxMX1VQKQ0KICAgIHB1c2hfYnV0dG9uX2Rvd24gPSBtYWNoaW5lLlBpbihjb25maWcuQ0ZHX0JVVFRPTl9ET1dOX1BJTiwgbWFjaGluZS5QaW4uSU4sIG1hY2hpbmUuUGluLlBVTExfVVApDQogICAgDQogICAgDQogICANCiAgICANCiAgICBkZWxheV92YWx1ZSA9IE5vbmUgIyBGT1IgVVNFUiBUSU1FUiAgICAgIA0KICAgICAgICAgICANCiAgICB0YXJnZXRfdmFsdWUgPSBOb25lDQogICAgc2NhbGVfb2Zmc2V0ID0gMC4wDQogICAgc2NhbGVfdmFsdWVfYmVmb3JlX2dsYXNzX2FkZGVkID0gMA0KICAgIA0KICAgIA0KICAgIA0KICAgIA0KICAgIA0KICAgIGxhc3RfZGlzcGxheV91cGRhdGUgPSBoZWxwZXIubWlsbGlzKCkNCiAgICBsYXN0X3N5c3RhdGVfdXBkYXRlID0gaGVscGVyLm1pbGxpcygpDQogICAgbGFzdF9yZWNpcGVfc3RlcF91cGRhdGUgPSBoZWxwZXIubWlsbGlzKCkNCiAgICBsYXN0X3JlY2lwZV9pbmdfdXBkYXRlID0gaGVscGVyLm1pbGxpcygpDQogICAgbGFzdF91c2VyYnV0dG9uX3VwZGF0ZSA9IE5vbmUNCiAgICANCiAgICBpbmdyZWRpZW50X2NvdW50ZXIgPSAwDQogICAgDQogICAgDQogICAgbGFzdF9idXR0b25fcHJlc3NlZCA9IE5vbmUNCiAgICBidXR0b25fcHJlc3NlZCA9IFVCX05PTkUNCiAgICB0aW1lX2VsYXBzZWQgPSAwDQogICAgbG9hZF9uZXh0X3N0ZXAgPSBGYWxzZQ0KICAgIA0KICAgIA0KICANCg0KICAgIA0KICAgIHRhcmdldF92YWx1ZSA9IDAuMA0KICAgIGZvdW5kX3JlY2lwZXMgPSBbXQ0KICAgIG1haW5tZW51X3JlY2lwZV9pbmRleCA9IDANCiAgICANCiAgICBzeXN0ZW1fc3RhdGUgPSBTWVNUQVRFX0lETEUgI1NZU1RFTVNUQVRFX0VOVEVSX01BSU5NRU5VICNTWVNURU1TVEFURV9VUERBVEVfTU9ERQ0KICAgIHdoaWxlIFRydWU6DQogICAgICAgIA0KICAgICAgICANCiAgICAgICAgIyBSRUFEIFVTRVJfQlVUVE9OUw0KICAgICAgICBpZiBub3QgcHVzaF9idXR0b25fdXAudmFsdWUoKSBhbmQgbm90IHB1c2hfYnV0dG9uX2Rvd24udmFsdWUoKSBhbmQgYnV0dG9uX3ByZXNzZWQgaXMgVUJfUkVMRUFTRToNCiAgICAgICAgICAgICNwcmludCgpDQogICAgICAgICAgICAjbGFzdF91c2VyYnV0dG9uX3VwZGF0ZSA9IGhlbHBlci5taWxsaXMoKQ0KICAgICAgICAgICAgI2xhc3RfYnV0dG9uX3ByZXNzZWQgPSBVQl9ET1dODQogICAgICAgICAgICBpZiBsYXN0X3VzZXJidXR0b25fdXBkYXRlIGlzIG5vdCBOb25lIGFuZChoZWxwZXIubWlsbGlzKCkgLSBsYXN0X3VzZXJidXR0b25fdXBkYXRlKSA+IDEwMDoNCiAgICAgICAgICAgICAgICBidXR0b25fcHJlc3NlZCA9IFVCX1VQTE9ORw0KICAgICAgICAgICAgZWxzZToNCiAgICAgICAgICAgICAgICBsYXN0X3VzZXJidXR0b25fdXBkYXRlID0gaGVscGVyLm1pbGxpcygpDQogICAgICAgICAgICAgICAgDQogICAgICAgIGVsaWYgcHVzaF9idXR0b25fdXAudmFsdWUoKSBhbmQgbm90IHB1c2hfYnV0dG9uX2Rvd24udmFsdWUoKSBhbmQgYnV0dG9uX3ByZXNzZWQgaXMgVUJfUkVMRUFTRToNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgDQogICAgICAgICAgICBpZiBsYXN0X3VzZXJidXR0b25fdXBkYXRlIGlzIG5vdCBOb25lIGFuZChoZWxwZXIubWlsbGlzKCkgLSBsYXN0X3VzZXJidXR0b25fdXBkYXRlKSA+IDUwMDoNCiAgICAgICAgICAgICAgICBidXR0b25fcHJlc3NlZCA9IFVCX1VQDQogICAgICAgICAgICBlbHNlOg0KICAgICAgICAgICAgICAgIGxhc3RfdXNlcmJ1dHRvbl91cGRhdGUgPSBoZWxwZXIubWlsbGlzKCkNCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICNsYXN0X2J1dHRvbl9wcmVzc2VkID0gVUJfVVANCiAgICAgICAgICAgICAgICAjYnV0dG9uX3ByZXNzZWQgPSBVQl9VUA0KICAgICAgICBlbGlmIG5vdCBwdXNoX2J1dHRvbl91cC52YWx1ZSgpIGFuZCBwdXNoX2J1dHRvbl9kb3duLnZhbHVlKCkgYW5kIGJ1dHRvbl9wcmVzc2VkIGlzIFVCX1JFTEVBU0U6DQogICAgICAgICAgICBpZiBsYXN0X3VzZXJidXR0b25fdXBkYXRlIGlzIG5vdCBOb25lIGFuZChoZWxwZXIubWlsbGlzKCkgLSBsYXN0X3VzZXJidXR0b25fdXBkYXRlKSA+IDUwMDoNCiAgICAgICAgICAgICAgICBidXR0b25fcHJlc3NlZCA9IFVCX0RPV04NCiAgICAgICAgICAgIGVsc2U6DQogICAgICAgICAgICAgICAgbGFzdF91c2VyYnV0dG9uX3VwZGF0ZSA9IGhlbHBlci5taWxsaXMoKQ0KICAgICAgICAgICAgDQoNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgDQogICAgICAgICAgICANCiAgICAgICAgZWxpZiBwdXNoX2J1dHRvbl91cC52YWx1ZSgpIGFuZCBwdXNoX2J1dHRvbl9kb3duLnZhbHVlKCkgYW5kIGJ1dHRvbl9wcmVzc2VkIGlzIFVCX05PTkU6DQogICAgICAgICAgICBpZiBsYXN0X3VzZXJidXR0b25fdXBkYXRlIGlzIG5vdCBOb25lIGFuZChoZWxwZXIubWlsbGlzKCkgLSBsYXN0X3VzZXJidXR0b25fdXBkYXRlKSA+IDEwMDoNCiAgICAgICAgICAgICAgICBidXR0b25fcHJlc3NlZCA9IFVCX1JFTEVBU0UNCiAgICAgICAgICAgIGVsc2U6DQogICAgICAgICAgICAgICAgbGFzdF91c2VyYnV0dG9uX3VwZGF0ZSA9IGhlbHBlci5taWxsaXMoKQ0KICAgICAgICAgICAgDQogICAgICAgIA0KDQogICAgICAgIHRpbWUuc2xlZXAoMC4wMSkNCg0KICAgICAgICANCiAgICAgICAgDQogICAgICAgICMgUkVBRCBTQ0FMRQ0KICAgICAgICBpZiBzeXN0ZW1fc3RhdGUgPj0gU1lTVEFURV9SRUNJUEVfU1RBUlQgb3Igc3lzdGVtX3N0YXRlID09IFNZU1RFTVNUQVRFX1NDQUxFX01PREUgb3Igc3lzdGVtX3N0YXRlID09IFNZU1RFTVNUQVRFX1JBV19NT0RFIG9yIHN5c3RlbV9zdGF0ZSA9PSBTWVNURU1TVEFURV9DQUxJQlJBVElPTl9NT0RFX0ZVTEwgb3Igc3lzdGVtX3N0YXRlID09IFNZU1RFTVNUQVRFX0NBTElCUkFUSU9OX01PREVfWkVSTzoNCiAgICAgICAgICAgIHNjYWxlX3ZhbHVlX2cgPSBzY2FsZXMuZ2V0X3VuaXQoVHJ1ZSkgLSB0YXJlX3ZhbHVlDQoNCiAgICAgICAgICAgIA0KDQogICAgICAgIA0KICAgICAgICAgICAgDQogICAgICAgICAgICANCiAgICAgICAgICAgIA0KICAgICAgICAjIFJFVFVSTiBCVVRUT04NCiAgICAgICAgaWYgc3lzdGVtX3N0YXRlID4gU1lTVEVNU1RBVEVfTUFJTk1FTlUgYW5kIGJ1dHRvbl9wcmVzc2VkID09IFVCX1VQTE9ORzoNCiAgICAgICAgICAgIGJ1dHRvbl9wcmVzc2VkID0gVUJfTk9ORQ0KICAgICAgICAgICAgc3lzdGVtX3N0YXRlID0gU1lTVEFURV9JRExFDQogICAgICAgICAgICBsYXN0X3N5c3RhdGVfdXBkYXRlID0gaGVscGVyLm1pbGxpcygpDQogICAgICAgICAgICANCiAgICAgICAgDQogICAgICAgICMgR0xPQkFMIFNUQVRFIE1BQ0hJRU5FDQogICAgICAgIGlmIHN5c3RlbV9zdGF0ZSA9PSBTWVNUQVRFX0lETEU6ICMgSU5JVElBTCBTWVNURU1TVEFURQ0KICAgICAgICAgICAgZ3VpLnNob3dfdGl0bGVzY3JlZW4oKQ0KICAgICAgICAgICAgaWYgIGFicyhsYXN0X3N5c3RhdGVfdXBkYXRlIC0gaGVscGVyLm1pbGxpcygpKSA+IDIwMDAwIG9yIGJ1dHRvbl9wcmVzc2VkICE9IFVCX05PTkU6DQogICAgICAgICAgICAgICAgYnV0dG9uX3ByZXNzZWQgPSBVQl9OT05FDQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgbGFzdF9zeXN0YXRlX3VwZGF0ZSA9IGhlbHBlci5taWxsaXMoKQ0KICAgICAgICAgICAgICAgIHN5c3RlbV9zdGF0ZSA9IFNZU1RFTVNUQVRFX0VOVEVSX01BSU5NRU5VDQogICAgICAgICAgICANCiAgICAgICAgZWxpZiBzeXN0ZW1fc3RhdGUgPT0gU1lTVEVNU1RBVEVfRU5URVJfTUFJTk1FTlU6ICMgUkVMT0FEIFJFQ0lQRVMNCiAgICAgICAgICAgIGhlbHBlci5zZXRfbmVvcGl4ZWxfZnVsbChuZW9waXhlbHJpbmcsIDAsIDAsIDEwMCkNCiAgICAgICAgICAgIGZvdW5kX3JlY2lwZXMgPSByZWNpcGUubGlzdF9yZWNwaWVzKCkNCiAgICAgICAgICAgIG1haW5tZW51X3JlY2lwZV9pbmRleCA9IC0xICMgVE8gVFJJR0dFUiBGSVJTVCBUSU1FIERJU1BMQVkgVVBEQVRFIEFGVEVSIEVOVEVSSU5HIFRIRSBTVEFURQ0KICAgICAgICAgICAgcHJpbnQoZm91bmRfcmVjaXBlcykNCiAgICAgICAgICAgIGxhc3Rfc3lzdGF0ZV91cGRhdGUgPSBoZWxwZXIubWlsbGlzKCkNCiAgICAgICAgICAgIHN5c3RlbV9zdGF0ZSA9IFNZU1RFTVNUQVRFX01BSU5NRU5VDQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgDQogICAgICAgIGVsaWYgc3lzdGVtX3N0YXRlID09IFNZU1RFTVNUQVRFX01BSU5NRU5VOiAjIERJU1BMQVkgTUFOSU1FTlUNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgIyBESVNQTEFZIE5FWFQgTUVOVQ0KDQogICAgICAgICAgICBpZiBidXR0b25fcHJlc3NlZCA9PSBVQl9VUCBvciBtYWlubWVudV9yZWNpcGVfaW5kZXggPT0gLTE6DQogICAgICAgICAgICAgICAgYnV0dG9uX3ByZXNzZWQgPSBVQl9OT05FDQogICAgICAgICAgICAgICAgIyBUTyBUUklHR0VSIEZJUlNUIFRJTUUgRElTUExBWSBVUERBVEUgQUZURVIgRU5URVJJTkcgVEhFIFNUQVRFDQogICAgICAgICAgICAgICAgaWYgbWFpbm1lbnVfcmVjaXBlX2luZGV4ID09IC0xOg0KICAgICAgICAgICAgICAgICAgICBtYWlubWVudV9yZWNpcGVfaW5kZXggPSAwDQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICANCiAgICAgICAgDQogICAgICAgICAgICAgICAgaWYgbWFpbm1lbnVfcmVjaXBlX2luZGV4ID49IChsZW4oZm91bmRfcmVjaXBlcyktMSkgKyA0OiAjICsyIGZvciBVUERBVEVfUkVDSVBFUywgU0NBTEVfTU9ERQ0KICAgICAgICAgICAgICAgICAgICBtYWlubWVudV9yZWNpcGVfaW5kZXggPSAwDQogICAgICAgICAgICAgICAgZWxzZToNCiAgICAgICAgICAgICAgICAgICAgbWFpbm1lbnVfcmVjaXBlX2luZGV4ID0gbWFpbm1lbnVfcmVjaXBlX2luZGV4ICsgMQ0KICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAjIFNIT1cgUkVDSVBFUw0KICAgICAgICAgICAgICAgIGlmIG1haW5tZW51X3JlY2lwZV9pbmRleCA8IGxlbihmb3VuZF9yZWNpcGVzKToNCiAgICAgICAgICAgICAgICAgICAgcmVjX25hbWUgPSBmb3VuZF9yZWNpcGVzW21haW5tZW51X3JlY2lwZV9pbmRleF1bMF0NCiAgICAgICAgICAgICAgICAgICAgcHJpbnQocmVjX25hbWUpDQogICAgICAgICAgICAgICAgICAgIGlmIHJlY2lwZS5sb2FkX3JlY2lwZShyZWNfbmFtZSk6DQogICAgICAgICAgICAgICAgICAgICAgICBndWkuc2V0X2Z1bGxfcmVmcmVzaCgpDQogICAgICAgICAgICAgICAgICAgICAgICBpbmZvcm1hdGlvbiA9IHJlY2lwZS5nZXRfcmVjaXBlX2luZm9ybWF0aW9uKCkNCiAgICAgICAgICAgICAgICAgICAgICAgIHByaW50KGluZm9ybWF0aW9uKQ0KICAgICAgICAgICAgICAgICAgICAgICAgZ3VpLnNob3dfcmVjaXBlX2luZm9ybWF0aW9uKGluZm9ybWF0aW9uWzBdLCBpbmZvcm1hdGlvblsxXSkNCiAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIGVsc2U6DQogICAgICAgICAgICAgICAgICAgIHJlY2lwZS51bmxvYWRfcmVjaXBlKCkNCiAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIGlmIG1haW5tZW51X3JlY2lwZV9pbmRleCA9PSAobGVuKGZvdW5kX3JlY2lwZXMpLTEpKzE6DQogICAgICAgICAgICAgICAgICAgICAgICBpZiBoZWxwZXIuaGFzX3dpZmkoKToNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBndWkuc2V0X2Z1bGxfcmVmcmVzaCgpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZ3VpLnNob3dfcmVjaXBlX2luZm9ybWF0aW9uKCJTQ0FMRSBNT0RFIiwgImxpa2UgYSBub3JtYWwga2l0Y2hlbiBzY2FsZSIpDQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1haW5tZW51X3JlY2lwZV9pbmRleCA9IChsZW4oZm91bmRfcmVjaXBlcyktMSkrMw0KICAgICAgICAgICAgICAgICAgICBlbGlmIG1haW5tZW51X3JlY2lwZV9pbmRleCA9PSAobGVuKGZvdW5kX3JlY2lwZXMpLTEpKzI6DQogICAgICAgICAgICAgICAgICAgICAgICBpZiBoZWxwZXIuaGFzX3dpZmkoKToNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBndWkuc2V0X2Z1bGxfcmVmcmVzaCgpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZ3VpLnNob3dfcmVjaXBlX2luZm9ybWF0aW9uKCJSRUNJUEUgVVBEQVRFIiwgInVwZGF0ZXMgYWxsIHJlY2lwZXMgdXNpbmcgdGhlIHdlYmFwcCIpDQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1haW5tZW51X3JlY2lwZV9pbmRleCA9IChsZW4oZm91bmRfcmVjaXBlcyktMSkrMw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICBlbGlmIG1haW5tZW51X3JlY2lwZV9pbmRleCA9PSAobGVuKGZvdW5kX3JlY2lwZXMpLTEpKzM6DQogICAgICAgICAgICAgICAgICAgICAgICBndWkuc2V0X2Z1bGxfcmVmcmVzaCgpDQogICAgICAgICAgICAgICAgICAgICAgICBndWkuc2hvd19yZWNpcGVfaW5mb3JtYXRpb24oIkNBTElCUkFURSIsICJydW4gYSBzY2FsZSBjYWxpYnJhdGlvbiBwcm9ncmFtLiBBIDUwZyB3ZWlnaHQgaXMgbmVlZGVkIikNCiAgICAgICAgICAgICAgICAgICAgZWxpZiBtYWlubWVudV9yZWNpcGVfaW5kZXggPT0gKGxlbihmb3VuZF9yZWNpcGVzKS0xKSs0Og0KICAgICAgICAgICAgICAgICAgICAgICAgZ3VpLnNldF9mdWxsX3JlZnJlc2goKQ0KICAgICAgICAgICAgICAgICAgICAgICAgZ3VpLnNob3dfcmVjaXBlX2luZm9ybWF0aW9uKCJIQVJEV0FSRSBURVNUIiwgInRlc3QgaW50ZXJuYWwgaGFyZHdhcmUiKQ0KICAgICAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIHByaW50KCJleHRyYSBtZW51IHt9Ii5mb3JtYXQobWFpbm1lbnVfcmVjaXBlX2luZGV4KSkNCiAgICAgICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICBlbGlmIGJ1dHRvbl9wcmVzc2VkID09IFVCX1VQTE9ORyBvciBidXR0b25fcHJlc3NlZCA9PSBVQl9ET1dOOg0KICAgICAgICAgICAgICAgIGJ1dHRvbl9wcmVzc2VkID0gVUJfTk9ORQ0KICAgICAgICAgICAgICAgIGxhc3Rfc3lzdGF0ZV91cGRhdGUgPSBoZWxwZXIubWlsbGlzKCkNCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICBpZiByZWNpcGUuaXNfcmVjaXBlX2xvYWRlZCgpOg0KICAgICAgICAgICAgICAgICAgICBzeXN0ZW1fc3RhdGUgPSBTWVNUQVRFX1JFQ0lQRV9TVEFSVA0KICAgICAgICAgICAgICAgIGVsaWYgbWFpbm1lbnVfcmVjaXBlX2luZGV4ID09IChsZW4oZm91bmRfcmVjaXBlcyktMSkrMToNCiAgICAgICAgICAgICAgICAgICAgc3lzdGVtX3N0YXRlID0gU1lTVEVNU1RBVEVfU0NBTEVfTU9ERQ0KICAgICAgICAgICAgICAgICAgICAjIFVQREFURSBORU9QSVhFTA0KICAgICAgICAgICAgICAgICAgICBoZWxwZXIuc2V0X25lb3BpeGVsX2Z1bGwobmVvcGl4ZWxyaW5nLCAwLCAxMDAsIDEwMCkNCg0KICAgICAgICAgICAgICAgIGVsaWYgbWFpbm1lbnVfcmVjaXBlX2luZGV4ID09IChsZW4oZm91bmRfcmVjaXBlcyktMSkrMjoNCiAgICAgICAgICAgICAgICAgICAgc3lzdGVtX3N0YXRlID0gU1lTVEVNU1RBVEVfVVBEQVRFX01PREVfUVJfU1RBUlQNCiAgICAgICAgICAgICAgICAgICAgIyBVUERBVEUgTkVPUElYRUwNCiAgICAgICAgICAgICAgICAgICAgaGVscGVyLnNldF9uZW9waXhlbF9mdWxsKG5lb3BpeGVscmluZywgMTAwLCAwLCAxMDApDQoNCiAgICAgICAgICAgICAgICBlbGlmIG1haW5tZW51X3JlY2lwZV9pbmRleCA9PSAobGVuKGZvdW5kX3JlY2lwZXMpLTEpKzM6DQogICAgICAgICAgICAgICAgICAgIHN5c3RlbV9zdGF0ZSA9IFNZU1RFTVNUQVRFX0NBTElCUkFUSU9OX01PREVfRU5UUlkNCiAgICAgICAgICAgICAgICAgICAgIyBVUERBVEUgTkVPUElYRUwNCiAgICAgICAgICAgICAgICAgICAgaGVscGVyLnNldF9uZW9waXhlbF9mdWxsKG5lb3BpeGVscmluZywgMTAwLCAxMCwgNTApDQogICAgICAgICAgICAgICAgZWxpZiBtYWlubWVudV9yZWNpcGVfaW5kZXggPT0gKGxlbihmb3VuZF9yZWNpcGVzKS0xKSs0Og0KICAgICAgICAgICAgICAgICAgICBzeXN0ZW1fc3RhdGUgPSBTWVNURU1TVEFURV9SQVdfTU9ERQ0KICAgICAgICAgICAgICAgICAgICAjIFVQREFURSBORU9QSVhFTA0KICAgICAgICAgICAgICAgICAgICBoZWxwZXIuc2V0X25lb3BpeGVsX2Z1bGwobmVvcGl4ZWxyaW5nLCAxMDAsIDAsIDEwMCkNCg0KDQogICAgICAgIGVsaWYgc3lzdGVtX3N0YXRlID09IFNZU1RFTVNUQVRFX1JBV19NT0RFOg0KICAgICAgICAgICAgICAgIGd1aS5zaG93X21zZygiU1JWOnt9XG5QQlU6e31cblBCRDp7fVxuU1M6e31cblRSRTp7fVxuSUQ6e30iLmZvcm1hdChzY2FsZXMuc3RhYmxlX3Jhd192YWx1ZSh3aXRob3V0X29mZnNldD1UcnVlKSwgcHVzaF9idXR0b25fdXAudmFsdWUoKSwgcHVzaF9idXR0b25fZG93bi52YWx1ZSgpLCBzeXN0ZW1fc3RhdGUsIHRhcmVfdmFsdWUsIGhlbHBlci5nZXRfc3lzdGVtX2lkKCkpKQ0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIGlmIGJ1dHRvbl9wcmVzc2VkID09IFVCX1VQOg0KICAgICAgICAgICAgICAgICAgICBidXR0b25fcHJlc3NlZCA9IFVCX05PTkUNCiAgICAgICAgICAgICAgICAgICAgdXNlcl9wb3J0YWxfdXJsOiBzdHIgPSByZWNpcGUuY2hlY2tfdXBkYXRlX3VybCgpDQogICAgICAgICAgICAgICAgICAgIGlmIHVzZXJfcG9ydGFsX3VybCAhPSAiIjoNCiAgICAgICAgICAgICAgICAgICAgICAgIGd1aS5zaG93X2RldmljZV9xcl9jb2RlKHVzZXJfcG9ydGFsX3VybCkNCiAgICAgICAgICAgICAgICAgICAgICAgIHRpbWUuc2xlZXAoMTApDQogICAgICAgICANCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICANCiAgICAgICAgZWxpZiBzeXN0ZW1fc3RhdGUgPT0gU1lTVEVNU1RBVEVfQ0FMSUJSQVRJT05fTU9ERV9FTlRSWToNCiAgICAgICAgICAgICAgICBndWkuc2hvd19tc2coIlJFTU9WRSBFVkVSWVRISU5HIEZST00gU0NBTEUiKQ0KICAgICAgICAgICAgICAgIGlmICBidXR0b25fcHJlc3NlZCA9PSBVQl9VUDoNCiAgICAgICAgICAgICAgICAgICAgYnV0dG9uX3ByZXNzZWQgPSBVQl9OT05FDQogICAgICAgICAgICAgICAgICAgIGd1aS5zaG93X21zZygiUExFQVNFIFdBSVQiKQ0KICAgICAgICAgICAgICAgICAgICBtYXBfdmFsdWVfMGcgPSBzY2FsZXMuc3RhYmxlX3Jhd192YWx1ZSh3aXRob3V0X29mZnNldD1UcnVlKQ0KICAgICAgICAgICAgICAgICAgICBwcmludCgibWFwX3ZhbHVlXzBnOnt9Ii5mb3JtYXQobWFwX3ZhbHVlXzBnKSkNCiAgICAgICAgICAgICAgICAgICAgc3lzdGVtX3N0YXRlID0gU1lTVEVNU1RBVEVfQ0FMSUJSQVRJT05fTU9ERV9GVUxMDQoNCiAgICAgICAgZWxpZiBzeXN0ZW1fc3RhdGUgPT0gU1lTVEVNU1RBVEVfQ0FMSUJSQVRJT05fTU9ERV9GVUxMOg0KICAgICAgICAgICAgICAgIGd1aS5zaG93X21zZygiUExFQVNFIFBMQUNFIHt9ZyBXRUlHSFQiLmZvcm1hdChjb25maWcuQ0ZHX0NBTElCUkFUSU9OX1dFSUdIVF9XRUlHSFQpKQ0KICAgICAgICAgICAgICAgIGlmICBidXR0b25fcHJlc3NlZCA9PSBVQl9VUDoNCiAgICAgICAgICAgICAgICAgICAgYnV0dG9uX3ByZXNzZWQgPSBVQl9OT05FDQogICAgICAgICAgICAgICAgICAgIGd1aS5zaG93X21zZygiUExFQVNFIFdBSVQiKQ0KICAgICAgICAgICAgICAgICAgICBtYXBfdmFsdWVfNTBnID0gc2NhbGVzLnN0YWJsZV9yYXdfdmFsdWUod2l0aG91dF9vZmZzZXQ9VHJ1ZSkNCiAgICAgICAgICAgICAgICAgICAgIyBGTElQIE1JTiBNQVggSUYgTE9BRENFTEwgSVMgSU5WRVJURUQNCiAgICAgICAgICAgICAgICAgICAgaWYgbWFwX3ZhbHVlXzBnID4gbWFwX3ZhbHVlXzUwZzoNCiAgICAgICAgICAgICAgICAgICAgICAgdCA9IG1hcF92YWx1ZV8wZw0KICAgICAgICAgICAgICAgICAgICAgICBtYXBfdmFsdWVfMGcgPSBtYXBfdmFsdWVfNTBnDQogICAgICAgICAgICAgICAgICAgICAgIG1hcF92YWx1ZV81MGcgPSB0DQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIHJlY2lwZS5zYXZlX2NhbGlicmF0aW9uX3ZhbHVlcyhtYXBfdmFsdWVfMGcsIG1hcF92YWx1ZV81MGcpDQogICAgICAgICAgICAgICAgICAgIHByaW50KCJDQUxJQlJBVElPTiBTQVZFRCBtYXBfdmFsdWVfMGc6e30gbWFwX3ZhbHVlXzUwZzp7fSIuZm9ybWF0KG1hcF92YWx1ZV8wZywgbWFwX3ZhbHVlXzUwZykpDQogICAgICAgICAgICAgICAgICAgIGNhbGlicmF0aW9uX2ZhY3RvciA9IHJlY2lwZS5nZXRfY2FsaWJyYXRpb25fZmFjdG9yKCkNCiAgICAgICAgICAgICAgICAgICAgc2NhbGVzLnNldF9zY2FsZShjYWxpYnJhdGlvbl9mYWN0b3IpDQogICAgICAgICAgICAgICAgICAgIHN5c3RlbV9zdGF0ZSA9IFNZU1RBVEVfSURMRQ0KICAgICAgICAgICAgICAgICAgICANCg0KDQogICAgICAgIGVsaWYgc3lzdGVtX3N0YXRlID09IFNZU1RFTVNUQVRFX1NDQUxFX01PREU6DQogICAgICAgICAgICAjIFVQREFURSBESVNQTEFZIFdJVEggU0NBTEUgUkVBRElORw0KICAgICAgICAgICAgcHJpbnQoInNjYWxlX3ZhbHVlX2c6e31nIi5mb3JtYXQoc2NhbGVfdmFsdWVfZykpDQogICAgICAgICAgICBndWkuc2hvd19zY2FsZShpbnQoc2NhbGVfdmFsdWVfZykpDQogICAgICAgICAgICANCiAgICAgICAgICAgIGlmIGJ1dHRvbl9wcmVzc2VkID09IFVCX1VQOg0KICAgICAgICAgICAgICAgIGJ1dHRvbl9wcmVzc2VkID0gVUJfTk9ORQ0KICAgICAgICAgICAgICAgIHRhcmVfdmFsdWUgPSBzY2FsZXMuZ2V0X3VuaXQoVHJ1ZSkNCiAgICAgICAgICAgIGVsaWYgYnV0dG9uX3ByZXNzZWQgPT0gVUJfRE9XTjoNCiAgICAgICAgICAgICAgICBidXR0b25fcHJlc3NlZCA9IFVCX05PTkUNCiAgICAgICAgICAgICAgICB0YXJnZXRfdmFsdWUgPSAwLjANCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgIGVsaWYgYnV0dG9uX3ByZXNzZWQgPT0gVUJfVVBMT05HOg0KICAgICAgICAgICAgICAgIGxhc3RfYnV0dG9uX3ByZXNzZWQgPSBVQl9OT05FDQogICAgICAgICAgICAgICAgbGFzdF9zeXN0YXRlX3VwZGF0ZSA9IGhlbHBlci5taWxsaXMoKQ0KICAgICAgICAgICAgICAgIHN5c3RlbV9zdGF0ZSA9IFNZU1RBVEVfSURMRQ0KICAgICAgICAgICAgDQogICAgICAgICAgICAjIFVQREFURSBORU9QSVhFTCBSSU5HIEZST00gVEFSRVZBTFVFIFRPIE1BWCBNRUFTVVJFRCBWQUxVRQ0KICAgICAgICAgICAgdGFyZ2V0X3ZhbHVlID0gbWF4KFtzY2FsZV92YWx1ZV9nLCB0YXJnZXRfdmFsdWUsIDEwXSkNCiAgICAgICAgICAgIGRpc3BfdmFsdWUgPSBtaW4oW2hlbHBlci5pbWFwKHNjYWxlX3ZhbHVlX2csIHRhcmVfdmFsdWUsIHRhcmdldF92YWx1ZSwgMCAsIGNvbmZpZy5DRkdfTkVPUElYRUxfTEVEX0NPVU5UKSwgY29uZmlnLkNGR19ORU9QSVhFTF9MRURfQ09VTlRdKQ0KICAgICAgICAgICAgZm9yIGkgaW4gcmFuZ2UoY29uZmlnLkNGR19ORU9QSVhFTF9MRURfQ09VTlQpOg0KICAgICAgICAgICAgICAgIGNvbG9yX3ZhbHVlID0gaGVscGVyLmltYXAoaSwgMCwgY29uZmlnLkNGR19ORU9QSVhFTF9MRURfQ09VTlQsIDAgLCAxLjApDQogICAgICAgICAgICAgICAgIyBBUFBMWSBTVEFSVCBpbmRFWCBPRkZTRVQNCiAgICAgICAgICAgICAgICBsZWRfaW5kZXggPSBpbnQoKGkrY29uZmlnLkNGR19ORU9QSVhFTF9MRURfU1RBUlRfT0ZGU0VUKSAlIGNvbmZpZy5DRkdfTkVPUElYRUxfTEVEX0NPVU5UKQ0KDQogICAgICAgICAgICAgICAgaWYgdGFyZ2V0X3ZhbHVlIDwgMDoNCiAgICAgICAgICAgICAgICAgICAgbmVvcGl4ZWxyaW5nW2xlZF9pbmRleF0gPSAoMTAsIDAsIDEwKQ0KICAgICAgICAgICAgICAgIGVsaWYgc2NhbGVfdmFsdWVfZyA+PSB0YXJnZXRfdmFsdWU6DQogICAgICAgICAgICAgICAgICAgIG5lb3BpeGVscmluZ1tsZWRfaW5kZXhdID0gKDI1NSwgMCwgMjU1KQ0KICAgICAgICAgICAgICAgIGVsaWYgaSA8IGRpc3BfdmFsdWU6DQogICAgICAgICAgICAgICAgICAgICMgICAgICAgUiAgRyAgQg0KICAgICAgICAgICAgICAgICAgICBuZW9waXhlbHJpbmdbbGVkX2luZGV4XSA9IChpbnQoY29sb3JfdmFsdWUqMjU1KSwgMCwgaW50KCgxLjAgLSBjb2xvcl92YWx1ZSkgKiAyNTUpKQ0KICAgICAgICAgICAgICAgIGVsc2U6DQogICAgICAgICAgICAgICAgICAgIG5lb3BpeGVscmluZ1tsZWRfaW5kZXhdID0gKDEwLCAxMCwgMTApDQogICAgICAgICAgICBuZW9waXhlbHJpbmcud3JpdGUoKQ0KICAgICAgICAgICAgDQogICAgICAgICAgICANCiAgICAgICAgICAgIA0KICAgICAgICBlbGlmIHN5c3RlbV9zdGF0ZSA9PSBTWVNURU1TVEFURV9VUERBVEVfTU9ERV9RUl9TVEFSVDoNCiAgICAgICAgICAgIGlmIGNvbmZpZy5DRkdfRElTUExBWV9VU0VSX1FSX0NPREU6DQogICAgICAgICAgICAgICAgdXNlcl9wb3J0YWxfdXJsOiBzdHIgPSByZWNpcGUuY2hlY2tfdXBkYXRlX3VybCgpDQogICAgICAgICAgICAgICAgaWYgdXNlcl9wb3J0YWxfdXJsICE9ICIiOg0KICAgICAgICAgICAgICAgICAgICBndWkuc2hvd19kZXZpY2VfcXJfY29kZSh1c2VyX3BvcnRhbF91cmwpDQogICAgICAgICAgICAgICAgICAgIHN5c3RlbV9zdGF0ZSA9IFNZU1RFTVNUQVRFX1VQREFURV9NT0RFX1FSX1JVTk5JTkcNCiAgICAgICAgICAgICAgICBlbHNlOg0KICAgICAgICAgICAgICAgICAgICBzeXN0ZW1fc3RhdGUgPSBTWVNURU1TVEFURV9VUERBVEVfTU9ERQ0KICAgICAgICAgICAgZWxzZToNCiAgICAgICAgICAgICAgICBzeXN0ZW1fc3RhdGUgPSBTWVNURU1TVEFURV9VUERBVEVfTU9ERQ0KICAgICAgICAgICAgDQogICAgICAgICAgICANCiAgICAgICAgZWxpZiBzeXN0ZW1fc3RhdGUgPT0gU1lTVEVNU1RBVEVfVVBEQVRFX01PREVfUVJfUlVOTklORzoNCiAgICAgICAgICAgIGd1aS5zaG93X21zZygiTE9BRElORyBVUERBVEUgTUFOQUdFUiIpDQogICAgICAgICAgICBpZiBidXR0b25fcHJlc3NlZCA9PSBVQl9ET1dOIG9yIGJ1dHRvbl9wcmVzc2VkID09IFVCX1VQOg0KICAgICAgICAgICAgICAgIGJ1dHRvbl9wcmVzc2VkID0gVUJfTk9ORQ0KICAgICAgICAgICAgICAgIHN5c3RlbV9zdGF0ZSA9IFNZU1RFTVNUQVRFX1VQREFURV9NT0RFDQogICAgICAgICAgICAgICAgDQogICAgICAgIGVsaWYgc3lzdGVtX3N0YXRlID09IFNZU1RFTVNUQVRFX1VQREFURV9NT0RFOg0KICAgICAgICAgICAgZ3VpLnNob3dfbXNnKCJVUERBVElORyBSRUNJUEVTIikNCiAgICAgICAgICAgIA0KICAgICAgICANCiAgICAgICAgICAgIHJlY2lwZS51bmxvYWRfcmVjaXBlKCkNCiAgICAgICAgICAgIGlmIHJlY2lwZS51cGRhdGVfcmVjaXBlcyhndWkpOg0KICAgICAgICAgICAgICAgIGhlbHBlci5zZXRfbmVvcGl4ZWxfZnVsbChuZW9waXhlbHJpbmcsIDAsIDAsIDEwMCkNCiAgICAgICAgICAgICAgICBndWkuc2hvd19tc2coIlJFQ0lQRSBVUERBVEUgU1VDQ0VTUyIpDQogICAgICAgICAgICBlbHNlOg0KICAgICAgICAgICAgICAgIGhlbHBlci5zZXRfbmVvcGl4ZWxfZnVsbChuZW9waXhlbHJpbmcsIDEwMCwgMCwgMCkNCiAgICAgICAgICAgICAgICBndWkuc2hvd19tc2coIlJFQ0lQRSBVUERBVEUgRkFJTEVEIikNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgaWYgYnV0dG9uX3ByZXNzZWQgPT0gVUJfVVAgb3IgYnV0dG9uX3ByZXNzZWQgPT0gVUJfVVBMT05HIG9yIGJ1dHRvbl9wcmVzc2VkID09IFVCX0RPV046DQogICAgICAgICAgICAgICAgYnV0dG9uX3ByZXNzZWQgPSBVQl9OT05FDQogICAgICAgICAgICAgICAgbGFzdF9zeXN0YXRlX3VwZGF0ZSA9IGhlbHBlci5taWxsaXMoKQ0KICAgICAgICAgICAgICAgIHN5c3RlbV9zdGF0ZSA9IFNZU1RBVEVfSURMRQ0KICAgICAgICAgICAgDQogICAgICAgIA0KICAgICAgICANCiAgICAgICAgZWxpZiBzeXN0ZW1fc3RhdGUgPT0gU1lTVEFURV9SRUNJUEVfU1RBUlQ6ICMgU1RBUlQgUkVDSVBFDQogICAgICAgICAgICBpZiAgYWJzKGxhc3Rfc3lzdGF0ZV91cGRhdGUgLSBoZWxwZXIubWlsbGlzKCkpID4gMTAwMDoNCiAgICAgICAgICAgICAgICBsYXN0X3N5c3RhdGVfdXBkYXRlID0gaGVscGVyLm1pbGxpcygpDQogICAgICAgICAgICAgICAgbGFzdF9yZWNpcGVfaW5nX3VwZGF0ZSA9IGhlbHBlci5taWxsaXMoKQ0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIGhlbHBlci5zZXRfbmVvcGl4ZWxfZnVsbChuZW9waXhlbHJpbmcsIDEwMCwgMTAwLCAwKQ0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICMgRU5URVIgU0hPVyBJTkdSRURJRU5UUyBJRiBUSEVSRSBBUkUgU09NRSBQUkVTRU5UIEVMU0UgU0tJUCBUSElTIFNURVANCiAgICAgICAgICAgICAgICBpbmdyZWRpZW50X2NvdW50ZXIgPSAtMQ0KICAgICAgICAgICAgICAgIGlmIGxlbihyZWNpcGUuZ2V0X2luZ3JlZGllbnRfbGlzdCgpKSA+IDA6DQogICAgICAgICAgICAgICAgICAgIGluZ3JlZGllbnRfY291bnRlciA9IDANCiAgICAgICAgICAgICAgICAgICAgZ3VpLnNob3dfcmVjaXBlX2luZ3JlZGllbnRzKFtyZWNpcGUuZ2V0X2luZ3JlZGllbnRfbGlzdCgpW2luZ3JlZGllbnRfY291bnRlcl1dKQ0KICAgICAgICAgICAgICAgICAgICBzeXN0ZW1fc3RhdGUgPSBTWVNUQVRFX1JFQ0lQRV9TSE9XX0lOR1JFRElFTlRTDQogICAgICAgICAgICAgICAgZWxzZToNCiAgICAgICAgICAgICAgICAgICAgc3lzdGVtX3N0YXRlID0gU1lTVEFURV9SRUNJUEVfUExBQ0VHTEFTUw0KICAgICAgICAgICAgICAgIA0KICAgICAgICBlbGlmIHN5c3RlbV9zdGF0ZSA9PSBTWVNUQVRFX1JFQ0lQRV9TSE9XX0lOR1JFRElFTlRTOg0KICAgICAgICAgICAgaWYgYnV0dG9uX3ByZXNzZWQgPT0gVUJfRE9XTjoNCiAgICAgICAgICAgICAgICBidXR0b25fcHJlc3NlZCA9IFVCX05PTkUNCiAgICAgICAgICAgICAgICBpbmdyZWRpZW50X2NvdW50ZXIgPSBpbmdyZWRpZW50X2NvdW50ZXIgKyAxDQogICAgICAgICAgICAgICAgaWYgaW5ncmVkaWVudF9jb3VudGVyID49IGxlbihyZWNpcGUuZ2V0X2luZ3JlZGllbnRfbGlzdCgpKToNCiAgICAgICAgICAgICAgICAgICAgaW5ncmVkaWVudF9jb3VudGVyID0gMA0KICAgICAgICAgICAgICAgICAgICANCg0KICAgICAgICAgICAgICAgIGd1aS5zaG93X3JlY2lwZV9pbmdyZWRpZW50cyhbcmVjaXBlLmdldF9pbmdyZWRpZW50X2xpc3QoKVtpbmdyZWRpZW50X2NvdW50ZXJdXSkNCiAgICAgICAgICAgIA0KDQoNCiAgICAgICAgICAgIGlmICBhYnMobGFzdF9zeXN0YXRlX3VwZGF0ZSAtIGhlbHBlci5taWxsaXMoKSkgPiAyMDAwMCBvciBidXR0b25fcHJlc3NlZCA9PSBVQl9VUDoNCiAgICAgICAgICAgICAgICBidXR0b25fcHJlc3NlZCA9IFVCX05PTkUNCiAgICAgICAgICAgICAgICBzY2FsZV92YWx1ZV9iZWZvcmVfZ2xhc3NfYWRkZWQgPSBzY2FsZV92YWx1ZV9nDQogICAgICAgICAgICAgICAgbGFzdF9zeXN0YXRlX3VwZGF0ZSA9IGhlbHBlci5taWxsaXMoKQ0KICAgICAgICAgICAgICAgIHN5c3RlbV9zdGF0ZSA9IFNZU1RBVEVfUkVDSVBFX1BMQUNFR0xBU1MNCiAgICAgICAgICAgIA0KICAgICAgICBlbGlmIHN5c3RlbV9zdGF0ZSA9PSBTWVNUQVRFX1JFQ0lQRV9QTEFDRUdMQVNTOg0KICAgICAgICAgICAgZ3VpLnNob3dfbXNnKCJQTEFDRSBHTEFTUyIpDQogICAgICAgICAgICAjcHJpbnQoc2NhbGVfdmFsdWVfZykNCiAgICAgICAgICAgIGlmICBhYnMobGFzdF9zeXN0YXRlX3VwZGF0ZSAtIGhlbHBlci5taWxsaXMoKSkgPiAxMDAwMCBvciBzY2FsZV92YWx1ZV9nID4gKHNjYWxlX3ZhbHVlX2JlZm9yZV9nbGFzc19hZGRlZCArIGNvbmZpZy5DRkdfU0NBTEVfR0xBU1NfQURESVRJT05fTkVYVF9TVEVQX1dFSUdIVCk6DQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgZ3VpLnNob3dfbXNnKCJDQUxJQlJBVElORyIpDQogICAgICAgICAgICAgICAgdGFyZV92YWx1ZSA9IHNjYWxlcy5nZXRfdW5pdChUcnVlKQ0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIHN5c3RlbV9zdGF0ZSA9IFNZU1RBVEVfUkVDSVBFX1JVTk5JTkcNCiAgICAgICAgICAgICAgICBsYXN0X3N5c3RhdGVfdXBkYXRlID0gaGVscGVyLm1pbGxpcygpDQogICAgICAgICAgICAgICAgbGFzdF9yZWNpcGVfc3RlcF91cGRhdGUgPSBoZWxwZXIubWlsbGlzKCkNCiAgICAgICAgDQogICAgICAgIGVsaWYgc3lzdGVtX3N0YXRlID09IFNZU1RBVEVfUkVDSVBFX0ZJTklTSEVEOg0KICAgICAgICAgICAgaGVscGVyLnNldF9uZW9waXhlbF9yYW5kb20obmVvcGl4ZWxyaW5nLCBGYWxzZSwgVHJ1ZSwgRmFsc2UpDQogICAgICAgICAgICBndWkuc2hvd19tc2coIkRSSU5LIFJFQURZIFRPIFNFUlZFIikNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgaWYgYnV0dG9uX3ByZXNzZWQgPT0gVUJfVVAgb3IgYWJzKGxhc3Rfc3lzdGF0ZV91cGRhdGUgLSBoZWxwZXIubWlsbGlzKCkpID4gNzAwMDoNCiAgICAgICAgICAgICAgICBsYXN0X3N5c3RhdGVfdXBkYXRlID0gaGVscGVyLm1pbGxpcygpDQogICAgICAgICAgICAgICAgc3lzdGVtX3N0YXRlID0gU1lTVEFURV9JRExFDQogICAgICAgICAgICAgICAgDQogICAgICAgIGVsaWYgc3lzdGVtX3N0YXRlID09IFNZU1RBVEVfUkVDSVBFX1JVTk5JTkc6DQogICAgICAgICAgICANCiAgICAgICAgICAgICMgR0VUIFJFQ0lQRSBTVEVQDQogICAgICAgICAgICByc3IgPSByZWNpcGUuZ2V0X2N1cnJlbnRfcmVjaXBlX3N0ZXAoKSAjIChhY3Rpb24sIGluZ3JlZGllbnQsIGN1cnJlbnRfc3RlcCwgbWF4X3N0ZXBzLCB0YXJnZXRfd2VpZ2h0LCBmaW5pc2hlZCkNCiAgICAgICAgICAgIHVzZXJfbW92ZSA9IHJzclswXQ0KICAgICAgICAgICAgYWN0aW9uICA9IHJzclsxXQ0KICAgICAgICAgICAgaW5ncmVkaWVudCA9IHJzclsyXQ0KICAgICAgICAgICAgY3VycmVudF9zdGVwID0gcnNyWzNdDQogICAgICAgICAgICBtYXhfc3RlcHMgPSByc3JbNF0NCiAgICAgICAgICAgIGFtb3VudCA9IHJzcls1XQ0KICAgICAgICAgICAgZmluaXNoZWQgPSByc3JbNl0NCiAgICAgICAgICAgIHByaW50KHJzcikNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgDQogICAgICAgICAgICAjIFVQREFURSBWQVJJQUJMRVMNCiAgICAgICAgICAgIGlmIHVzZXJfbW92ZSA9PSByZWNpcGVfbG9hZGVyLlVTRVJfSU5URVJBQ1RJT05fTU9ERS5TQ0FMRToNCiAgICAgICAgICAgICAgICB0YXJnZXRfdmFsdWUgPSBhbW91bnQNCiAgICAgICAgICAgICAgICBkZWxheV92YWx1ZSA9IE5vbmUNCiAgICAgICAgICAgIGVsaWYgdXNlcl9tb3ZlID09IHJlY2lwZV9sb2FkZXIuVVNFUl9JTlRFUkFDVElPTl9NT0RFLldBSVQ6DQogICAgICAgICAgICAgICAgZGVsYXlfdmFsdWUgPSBhbW91bnQNCiAgICAgICAgICAgICAgICB0YXJnZXRfdmFsdWUgPSBOb25lDQogICAgICAgICAgICAgICAgdGltZV9lbGFwc2VkID0gKChoZWxwZXIubWlsbGlzKCkgLSBsYXN0X3JlY2lwZV9zdGVwX3VwZGF0ZSkpLzEwMDANCiAgICAgICAgICAgICAgICBwcmludCh0aW1lX2VsYXBzZWQpDQogICAgICAgICAgICBlbHNlOg0KICAgICAgICAgICAgICAgIHRhcmdldF92YWx1ZSA9IE5vbmUNCiAgICAgICAgICAgICAgICBkZWxheV92YWx1ZSA9IE5vbmUNCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICMgQ0hFQ0sgT0sgQUNUSU9OIE9LDQogICAgICAgICAgICBpZiBmaW5pc2hlZDoNCiAgICAgICAgICAgICAgICBsYXN0X3N5c3RhdGVfdXBkYXRlID0gaGVscGVyLm1pbGxpcygpDQogICAgICAgICAgICAgICAgIyBHT1RPIE1BSU4gTUVOVSBJRiBHTEFTUyBJUyBSRU1PVkVEDQogICAgICAgICAgICAgICAgaWYgc2NhbGVfdmFsdWVfZyA8IHNjYWxlX3ZhbHVlX2JlZm9yZV9nbGFzc19hZGRlZDoNCiAgICAgICAgICAgICAgICAgICAgZ3VpLnNob3dfbXNnKCJSRU1PVkUgR0xBU1MiKQ0KICAgICAgICAgICAgICAgICAgICBzeXN0ZW1fc3RhdGUgPSBTWVNUQVRFX1JFQ0lQRV9GSU5JU0hFRA0KICAgICAgICAgICAgICAgICAgICAjIFJFU1RPUkUgSU5JVElBTCBUQVJFIFZBTFVFDQogICAgICAgICAgICAgICAgICAgIHRhcmVfdmFsdWUgPSB0YXJlX3ZhbHVlX2luaXRpYWwNCiAgICAgICAgICAgICAgICAgICAgY29udGludWUNCiAgICAgICAgICAgIGVsaWYgdXNlcl9tb3ZlID09IHJlY2lwZV9sb2FkZXIuVVNFUl9JTlRFUkFDVElPTl9NT0RFLlNDQUxFIGFuZCBzY2FsZV92YWx1ZV9nID4gdGFyZ2V0X3ZhbHVlOg0KICAgICAgICAgICAgICAgIGxvYWRfbmV4dF9zdGVwID0gVHJ1ZQ0KICAgICAgICAgICAgZWxpZiB1c2VyX21vdmUgPT0gcmVjaXBlX2xvYWRlci5VU0VSX0lOVEVSQUNUSU9OX01PREUuV0FJVCBhbmQgdGltZV9lbGFwc2VkID4gZGVsYXlfdmFsdWU6DQogICAgICAgICAgICAgICAgbG9hZF9uZXh0X3N0ZXAgPSBUcnVlDQogICAgICAgICAgICBlbGlmIHVzZXJfbW92ZSA9PSByZWNpcGVfbG9hZGVyLlVTRVJfSU5URVJBQ1RJT05fTU9ERS5DT05GSVJNIGFuZCAoYnV0dG9uX3ByZXNzZWQgPT0gVUJfVVAgb3IgYnV0dG9uX3ByZXNzZWQgPT0gVUJfRE9XTik6DQogICAgICAgICAgICAgICAgYnV0dG9uX3ByZXNzZWQgPT0gVUJfTk9ORQ0KICAgICAgICAgICAgICAgIGxvYWRfbmV4dF9zdGVwID0gVHJ1ZQ0KICAgICAgICAgICAgZWxzZToNCiAgICAgICAgICAgICAgICBsb2FkX25leHRfc3RlcCA9IEZhbHNlDQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICBpZiBsb2FkX25leHRfc3RlcDoNCiAgICAgICAgICAgICAgICBsb2FkX25leHRfc3RlcCA9IEZhbHNlDQogICAgICAgICAgICAgICAgcmVjaXBlLnN3aXRjaF9uZXh0X3N0ZXAoKQ0KICAgICAgICAgICAgICAgIGd1aS5zZXRfZnVsbF9yZWZyZXNoKCkNCiAgICAgICAgICAgICAgICBsYXN0X3JlY2lwZV9zdGVwX3VwZGF0ZSA9IGhlbHBlci5taWxsaXMoKQ0KICAgICAgICAgICAgICAgICMgSVMgVEhFIE5FVyBTVEVQIFRIRSBGSU5JU0ggU1RFUCA9PiBTS0lQIFRBUkUgUFJPQ0VTUw0KICAgICAgICAgICAgICAgIGlmIG5vdCByZWNpcGUuZ2V0X2N1cnJlbnRfcmVjaXBlX3N0ZXAoKVs2XToNCiAgICAgICAgICAgICAgICAgICAgZ3VpLnNob3dfbXNnKCJDQUxJQlJBVElORyIpDQogICAgICAgICAgICAgICAgICAgIHRhcmVfdmFsdWUgPSBzY2FsZXMuZ2V0X3VuaXQoVHJ1ZSkNCiAgICAgICAgICAgICAgICAgICAgc2NhbGVfdmFsdWVfYmVmb3JlX2dsYXNzX2FkZGVkID0gdGFyZV92YWx1ZQ0KICAgICAgICAgICAgICAgIGNvbnRpbnVlDQogICAgICAgICAgICANCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICMgVVBEQVRFIFVJDQogICAgICAgICAgICBpZiAgYWJzKGxhc3RfZGlzcGxheV91cGRhdGUgLSBoZWxwZXIubWlsbGlzKCkpID4gMTAwMDoNCiAgICAgICAgICAgICAgICBsYXN0X2Rpc3BsYXlfdXBkYXRlID0gaGVscGVyLm1pbGxpcygpDQogICAgICAgICAgICAgICAgZ3VpLnNob3dfcmVjaXBlX3N0ZXAoYWN0aW9uLCBpbmdyZWRpZW50LCBjdXJyZW50X3N0ZXAsIG1heF9zdGVwcykNCiAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgDQogICAgICAgICAgICAjIFVQREFURSBORU9QSVhFTCAgDQogICAgICAgICAgICBpZiB1c2VyX21vdmUgPT0gcmVjaXBlX2xvYWRlci5VU0VSX0lOVEVSQUNUSU9OX01PREUuU0NBTEUgYW5kIHNjYWxlX3ZhbHVlX2cgaXMgbm90IE5vbmUgYW5kIHRhcmdldF92YWx1ZSBpcyBub3QgTm9uZToNCiAgICAgICAgICAgICAgICBkaXNwX3ZhbHVlID0gbWluKFtoZWxwZXIuaW1hcChzY2FsZV92YWx1ZV9nLCAwLCB0YXJnZXRfdmFsdWUsIDAgLCBjb25maWcuQ0ZHX05FT1BJWEVMX0xFRF9DT1VOVCksIGNvbmZpZy5DRkdfTkVPUElYRUxfTEVEX0NPVU5UXSkNCiAgICAgICAgICAgICAgICBmb3IgaSBpbiByYW5nZShjb25maWcuQ0ZHX05FT1BJWEVMX0xFRF9DT1VOVCk6DQogICAgICAgICAgICAgICAgICAgIGNvbG9yX3ZhbHVlID0gaGVscGVyLmltYXAoaSwgMCwgY29uZmlnLkNGR19ORU9QSVhFTF9MRURfQ09VTlQsIDAgLCAxLjApDQogICAgICAgICAgICAgICAgICAgICMgQVBQTFkgU1RBUlQgaW5kRVggT0ZGU0VUDQogICAgICAgICAgICAgICAgICAgIGxlZF9pbmRleCA9IGludCgoaStjb25maWcuQ0ZHX05FT1BJWEVMX0xFRF9TVEFSVF9PRkZTRVQpICUgY29uZmlnLkNGR19ORU9QSVhFTF9MRURfQ09VTlQpDQoNCiAgICAgICAgICAgICAgICAgICAgaWYgdGFyZ2V0X3ZhbHVlIDwgMDoNCiAgICAgICAgICAgICAgICAgICAgICAgIG5lb3BpeGVscmluZ1tsZWRfaW5kZXhdID0gKDAsIDAsIDEyOCkNCiAgICAgICAgICAgICAgICAgICAgZWxpZiBzY2FsZV92YWx1ZV9nID49IHRhcmdldF92YWx1ZToNCiAgICAgICAgICAgICAgICAgICAgICAgIG5lb3BpeGVscmluZ1tsZWRfaW5kZXhdID0gKDAsIDI1NSwgMCkNCiAgICAgICAgICAgICAgICAgICAgZWxpZiBpIDwgZGlzcF92YWx1ZToNCiAgICAgICAgICAgICAgICAgICAgICAgICMgICAgICAgUiAgRyAgQg0KICAgICAgICAgICAgICAgICAgICAgICAgbmVvcGl4ZWxyaW5nW2xlZF9pbmRleF0gPSAoaW50KCgxLjAgLSBjb2xvcl92YWx1ZSkgKiAyNTUpLCBpbnQoY29sb3JfdmFsdWUqMjU1KSwgMCkNCiAgICAgICAgICAgICAgICAgICAgZWxzZToNCiAgICAgICAgICAgICAgICAgICAgICAgIG5lb3BpeGVscmluZ1tsZWRfaW5kZXhdID0gKDEwLCAwLCAwKQ0KICAgICAgICAgICAgICAgIG5lb3BpeGVscmluZy53cml0ZSgpDQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICBlbGlmIHVzZXJfbW92ZSA9PSByZWNpcGVfbG9hZGVyLlVTRVJfSU5URVJBQ1RJT05fTU9ERS5DT05GSVJNOg0KICAgICAgICAgICAgICAgIGhlbHBlci5zZXRfbmVvcGl4ZWxfZnVsbChuZW9waXhlbHJpbmcsIDEwMCwgMTAwLCAwKQ0KICAgICAgICAgICAgDQogICAgICAgICAgICBlbGlmIHVzZXJfbW92ZSA9PSByZWNpcGVfbG9hZGVyLlVTRVJfSU5URVJBQ1RJT05fTU9ERS5XQUlUIGFuZCBkZWxheV92YWx1ZSBpcyBub3QgTm9uZSBhbmQgdGltZV9lbGFwc2VkIGlzIG5vdCBOb25lOg0KICAgICAgICAgICAgICAgIGxpZ2h0dXAgPSBtaW4oW2hlbHBlci5pbWFwKHRpbWVfZWxhcHNlZCwgMCwgZGVsYXlfdmFsdWUsIDAgLCBjb25maWcuQ0ZHX05FT1BJWEVMX0xFRF9DT1VOVCksIGNvbmZpZy5DRkdfTkVPUElYRUxfTEVEX0NPVU5UXSkNCiAgICAgICAgICAgICAgICAjcHJpbnQoImxpZ2h0dXAge30ge30ge30iLmZvcm1hdChsaWdodHVwLCB0aW1lX2VsYXBzZWQsIGRlbGF5X3ZhbHVlKQ0KICAgICAgICAgICAgICAgIGZvciBpIGluIHJhbmdlKGNvbmZpZy5DRkdfTkVPUElYRUxfTEVEX0NPVU5UKToNCiAgICAgICAgICAgICAgICAgICAgbGVkX2luZGV4ID0gaW50KChpK2NvbmZpZy5DRkdfTkVPUElYRUxfTEVEX1NUQVJUX09GRlNFVCkgJSBjb25maWcuQ0ZHX05FT1BJWEVMX0xFRF9DT1VOVCkNCiAgICAgICAgICAgICAgICAgICAgaWYgaSA8IGxpZ2h0dXA6DQogICAgICAgICAgICAgICAgICAgICAgICBuZW9waXhlbHJpbmdbbGVkX2luZGV4XSA9ICgxMCwgMTAsIDEwKQ0KICAgICAgICAgICAgICAgICAgICBlbGlmIGkgPT0gbGlnaHR1cDoNCiAgICAgICAgICAgICAgICAgICAgICAgIG5lb3BpeGVscmluZ1tsZWRfaW5kZXhdID0gKDEwMCwgMTAwLCAxMDApDQogICAgICAgICAgICAgICAgICAgIGVsc2U6DQogICAgICAgICAgICAgICAgICAgICAgICBuZW9waXhlbHJpbmdbbGVkX2luZGV4XSA9ICgxMCwgMTAsIDEwKQ0KICAgICAgICAgICAgICAgIG5lb3BpeGVscmluZy53cml0ZSgpDQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICBlbHNlOg0KICAgICAgICAgICAgICAgIGhlbHBlci5zZXRfbmVvcGl4ZWxfcmFuZG9tKG5lb3BpeGVscmluZywgVHJ1ZSwgRmFsc2UsIEZhbHNlKQ0KICAgICAgICAgICAgDQogICAgICAgIGVsc2U6DQogICAgICAgICAgICBoZWxwZXIuc2V0X25lb3BpeGVsX2Z1bGwobmVvcGl4ZWxyaW5nLCAwLCAwLCAxMDApDQoNCg0K", "ui.py": "aW1wb3J0IGNvbmZpZw0KaW1wb3J0IG1tYl9kaXNwbGF5DQppbXBvcnQgdVFSDQppbXBvcnQgaGVscGVyDQpjbGFzcyB1aToNCiAgICANCiAgICBkaXNwbGF5OiBtbWJfZGlzcGxheQ0KDQoNCg0KICAgIGRlZiBwaXhlbChzZWxmLCB4LCB5LCB2YWx1ZSk6DQogICAgICAgIHNlbGYuZGlzcGxheS5waXhlbCh4LCB5LCB2YWx1ZSkNCiAgICAgICAgDQogICAgZGVmIHNob3coc2VsZik6DQogICAgICAgICAgICBzZWxmLmRpc3BsYXkuc2hvdygpDQogICAgICAgIA0KICAgIGRlZiBkaXNwbGF5X3JlY3Qoc2VsZiwgX3Bvc194X3BlcmNlbnRhZ2U6aW50LCBfcG9zX3lfcGVyY2VudGFnZTppbnQsIF9wb3NfeF9lbmRfcGVyYzppbnQsIF9wb3NfeV9lbmRfcGVyYyk6DQogICAgICAgIHg6IGludCA9IGludCgoY29uZmlnLlNDUl9XSURUSCAvIDEwMC4wKSAqIF9wb3NfeF9wZXJjZW50YWdlKQ0KICAgICAgICB5OiBpbnQgPSBpbnQoKGNvbmZpZy5TQ1JfSEVJR0hUIC8gMTAwLjApICogX3Bvc195X3BlcmNlbnRhZ2UpDQogICAgICAgIA0KICAgICAgICB4ZTogaW50ID0gaW50KChjb25maWcuU0NSX1dJRFRIIC8gMTAwLjApICogX3Bvc194X2VuZF9wZXJjKQ0KICAgICAgICB5ZTogaW50ID0gaW50KChjb25maWcuU0NSX0hFSUdIVCAvIDEwMC4wKSAqIF9wb3NfeV9lbmRfcGVyYykNCiAgICAgICAgDQoNCiAgICAgICAgc2VsZi5kaXNwbGF5LmZpbGxfcmVjdCh4LCB5LCBhYnMoeC14ZSksIGFicyh5LXllKSwgMCkgIyAwID0gQkcgQ09MT1INCiAgICAgICAgc2VsZi5kaXNwbGF5LnNob3coKQ0KICAgICAgICANCiAgICAgICAgDQogICAgZGVmIGRpc3BsYXlfdGV4dChzZWxmLCBfc3RyOnN0ciwgX3dyYXA6Ym9vbCA9IEZhbHNlLCBfcG9zX3hfcGVyY2VudGFnZTppbnQgPSAwLCBfcG9zX3lfcGVyY2VudGFnZTppbnQgPSAwKToNCiAgICAgICAgX3N0ciA9IF9zdHIucmVwbGFjZSgiw58iLCAic3MiKS5yZXBsYWNlKCLDtiIsICJvZSIpLnJlcGxhY2UoIsOkIiwgImFlIikucmVwbGFjZSgiw7wiLCAidWUiKQ0KDQogICAgICAgIHg6IGludCA9IGludCgoY29uZmlnLlNDUl9XSURUSCAvIDEwMC4wKSAqIF9wb3NfeF9wZXJjZW50YWdlKQ0KICAgICAgICB5OiBpbnQgPSBpbnQoKGNvbmZpZy5TQ1JfSEVJR0hUIC8gMTAwLjApICogX3Bvc195X3BlcmNlbnRhZ2UpDQoNCiAgICAgICAgaWYgbm90IF93cmFwOg0KICAgICAgICAgICAgc2VsZi5kaXNwbGF5LnRleHQoX3N0ciwgeCwgeSkNCiAgICAgICAgICAgIHNlbGYuZGlzcGxheS5zaG93KCkNCiAgICAgICAgICAgIHJldHVybg0KICAgICAgICAgICAgDQoNCiAgICAgICAgIyBXUkFQIFRFWFQNCiAgICAgICAgd29yZHMgPSBbXQ0KICAgICAgICBuZXdfbGluZXMgPSBfc3RyLnNwbGl0KCJcbiIpDQogICAgICAgIGZvciBsIGluIG5ld19saW5lczoNCiAgICAgICAgICAgIGlmIG5vdCBsID09ICIgIjogDQogICAgICAgICAgICAgICAgZm9yIHcgaW4gc3RyKGwpLnNwbGl0KCIgIik6DQogICAgICAgICAgICAgICAgICAgIGlmIG5vdCB3ID09ICIgIjoNCiAgICAgICAgICAgICAgICAgICAgICAgIHdvcmRzLmFwcGVuZCh3KQ0KICAgICAgICANCiAgICAgICAgY2hhcnNfbGVmdCA9IDEgKyAoY29uZmlnLlNDUl9XSURUSCAtIHgpLyBpbnQoY29uZmlnLkNGR19ESVNQTEFZX0NIQVJfV0lEVEgpDQogICAgICAgICNwcmludCgiY2hhcnNfbGVmdDoge30iLmZvcm1hdChjaGFyc19sZWZ0KSkNCiAgICAgICAgd29yZHNfd3JpdHRlbiA9IDANCiAgICAgICAgbGluZV95ID0geQ0KICAgICAgICAjcHJpbnQod29yZHMpDQogICAgICAgIGZvciB3IGluIHdvcmRzOg0KICAgICAgICAgICAgd19zcGFjZSA9ICJ7fSAiLmZvcm1hdCh3KQ0KDQoNCiAgICAgICAgICAgIGlmICh3b3Jkc193cml0dGVuK2xlbih3X3NwYWNlKSkgPj0gY2hhcnNfbGVmdDoNCiAgICAgICAgICAgICAgICAjcHJpbnQoImxpbmVfeTp7fSIuZm9ybWF0KGxpbmVfeSkpDQogICAgICAgICAgICAgICAgd29yZHNfd3JpdHRlbiA9IDANCiAgICAgICAgICAgICAgICBsaW5lX3kgPSBsaW5lX3kgKyBpbnQoY29uZmlnLkNGR19ESVNQTEFZX0xJTkVfU1BBQ0lORykNCg0KDQogICAgICAgICAgICAjcHJpbnQoInc6IHt9Ii5mb3JtYXQod19zcGFjZSwgbGluZV95KSkgDQogICAgICAgICAgICB4cG9zID0geCArIHdvcmRzX3dyaXR0ZW4gKiBpbnQoY29uZmlnLkNGR19ESVNQTEFZX0NIQVJfV0lEVEgpDQogICAgICAgICAgICBzZWxmLmRpc3BsYXkudGV4dCh3X3NwYWNlLCB4cG9zLCBsaW5lX3kpDQoNCiAgICAgICAgICAgIHdvcmRzX3dyaXR0ZW4gPSB3b3Jkc193cml0dGVuICsgbGVuKHdfc3BhY2UpDQoNCiAgICAgICAgICAgIGlmIHdvcmRzX3dyaXR0ZW4gPj0gY2hhcnNfbGVmdDoNCiAgICAgICAgICAgICAgICAjcHJpbnQoImxpbmVfeTp7fSIuZm9ybWF0KGxpbmVfeSkpDQogICAgICAgICAgICAgICAgd29yZHNfd3JpdHRlbiA9IDANCiAgICAgICAgICAgICAgICBsaW5lX3kgPSBsaW5lX3kgKyBpbnQoY29uZmlnLkNGR19ESVNQTEFZX0xJTkVfU1BBQ0lORykNCiAgICAgICAgICAgIA0KICAgICAgICBzZWxmLmRpc3BsYXkuc2hvdygpDQogICAgICAgICAgIA0KDQoNCiAgICBkZWYgX19pbml0X18oc2VsZik6DQogICAgICAgICMgQ1JFQVRFIEEgRElTUExBWSBJTlNUQU5DRQ0KICAgICAgICBzZWxmLmRpc3BsYXkgPSBtbWJfZGlzcGxheS5tbWJfZGlzcGxheS5kaXNwbGF5X2luc3RhbmNlX2NyZWF0b3IoKQ0KDQogICAgICAgIGlmIHNlbGYuZGlzcGxheSBpcyBOb25lOg0KICAgICAgICAgICAgcHJpbnQoImludmFsaWQgZGlzcGxheSBjb25maWciKQ0KDQogICAgICAgICANCiAgICAgICAgc2VsZi5kaXNwbGF5LmVyYXNlKCkNCg0KICAgICAgICBzZWxmLmxhc3RfZGlzcGxheV9zb3VyY2U6IGludCA9IC0xDQogICAgICAgIHNlbGYubGFzdF9kaXNwbGF5X2NvbnRlbnQgPSAiLiINCiAgICANCiAgDQogICAgDQogICAgZGVmIHNob3dfbXNnKHNlbGYsIF9tZXNzYWdlOiBzdHIgPSAiIik6DQoNCiAgICAgICAgaWYgc2VsZi5sYXN0X2Rpc3BsYXlfc291cmNlICE9IDAgb3IgX21lc3NhZ2UgIT0gc2VsZi5sYXN0X2Rpc3BsYXlfY29udGVudDoNCiAgICAgICAgICAgIHNlbGYubGFzdF9kaXNwbGF5X2NvbnRlbnQgPSBfbWVzc2FnZQ0KDQogICAgICAgICAgICBzZWxmLmRpc3BsYXkuZXJhc2UoKQ0KICAgICAgICAgICAgc2VsZi5kaXNwbGF5X3RleHQoInt9Ii5mb3JtYXQoX21lc3NhZ2UpLCBUcnVlLCAwLCAwKQ0KDQogICAgICAgICAgICBzZWxmLmxhc3RfZGlzcGxheV9zb3VyY2UgPSAwDQogDQogICAgICAgIA0KICANCiAgICAgICAgDQogICAgZGVmIHNob3dfcmVjaXBlX2luZm9ybWF0aW9uKHNlbGYsIF9uYW1lOnN0ciwgX2Rlc2NyaXB0aW9uOiBzdHIgPSAiIik6DQogICAgICAgIGZ1bGxfcmVmcmVzaCA9IEZhbHNlDQogICAgICAgIGlmIHNlbGYubGFzdF9kaXNwbGF5X3NvdXJjZSAhPSAxOg0KICAgICAgICAgICAgZnVsbF9yZWZyZXNoID0gVHJ1ZQ0KICAgICAgICBzZWxmLmxhc3RfZGlzcGxheV9zb3VyY2UgPSAxDQogICAgICAgIA0KICAgICAgICBpZiBmdWxsX3JlZnJlc2g6DQogICAgICAgICAgICBzZWxmLmRpc3BsYXkuZXJhc2UoKQ0KDQogICAgICAgICAgICBzZWxmLmRpc3BsYXlfdGV4dCgie30iLmZvcm1hdChfbmFtZSksIFRydWUsIDAsIDcpDQogICAgICAgICAgICBzZWxmLmRpc3BsYXlfdGV4dCgie30iLmZvcm1hdChfZGVzY3JpcHRpb24pLCBUcnVlLCAwLCAzNSkNCiAgICAgICAgICANCiAgICANCiAgICANCiAgICBkZWYgc2V0X2Z1bGxfcmVmcmVzaChzZWxmKToNCiAgICAgICAgc2VsZi5sYXN0X2Rpc3BsYXlfc291cmNlID0gLTENCiAgICAgICAgDQogICAgIA0KICAgIGRlZiBzaG93X3JlY2lwZV9zdGVwKHNlbGYsIF9hY3Rpb246IHN0ciwgX2luZ3JlZGllbnQ6IHN0ciwgX2N1cnJlbnRfc3RlcDogaW50LCBfbWF4X3N0ZXBzOiBpbnQpOg0KICAgICAgICBmdWxsX3JlZnJlc2ggPSBGYWxzZQ0KICAgICAgICBpZiBzZWxmLmxhc3RfZGlzcGxheV9zb3VyY2UgIT0gMjoNCiAgICAgICAgICAgIGZ1bGxfcmVmcmVzaCA9IFRydWUNCiAgICAgICAgc2VsZi5sYXN0X2Rpc3BsYXlfc291cmNlID0gMg0KICAgICAgICBpZiBmdWxsX3JlZnJlc2g6DQogICAgICAgICAgICBzZWxmLmRpc3BsYXkuZXJhc2UoKQ0KDQogICAgICAgICAgICBzZWxmLmRpc3BsYXlfdGV4dCgie30iLmZvcm1hdChfYWN0aW9uKSwgVHJ1ZSwgMzEsIDcpDQogICAgICAgICAgIA0KICAgICAgICAgICAgc2VsZi5kaXNwbGF5X3RleHQoInt9Ii5mb3JtYXQoX2luZ3JlZGllbnQpLCBUcnVlLCAwLCAyNykgICAgDQogICAgICAgICAgICAjIFNIT1cgU1RFUFMNCiAgICAgICAgICAgIHNlbGYuZGlzcGxheV90ZXh0KCJ7fSAvIHt9Ii5mb3JtYXQoX2N1cnJlbnRfc3RlcCwgX21heF9zdGVwcyksIFRydWUsIDM3LCA5MCkNCg0KDQogICAgICAgICAgICAgDQogICAgICAgICANCiAgICAgICAgDQogICAgICAgICAgICAgIA0KICAgICAgICANCiAgICBkZWYgc2hvd190aXRsZXNjcmVlbihzZWxmKToNCiAgICAgICAgZnVsbF9yZWZyZXNoID0gRmFsc2UNCiAgICAgICAgaWYgc2VsZi5sYXN0X2Rpc3BsYXlfc291cmNlICE9IDM6DQogICAgICAgICAgICBmdWxsX3JlZnJlc2ggPSBUcnVlDQogICAgICAgIHNlbGYubGFzdF9kaXNwbGF5X3NvdXJjZSA9IDMNCiAgICAgICAgDQogICAgICAgIGlmIGZ1bGxfcmVmcmVzaDoNCiAgICAgICAgICAgIHNlbGYuZGlzcGxheS5lcmFzZSgpDQogICAgICAgICAgICBzZWxmLmRpc3BsYXlfdGV4dCgiTUlYIiwgVHJ1ZSwgMjUsIDEwKQ0KICAgICAgICAgICAgc2VsZi5kaXNwbGF5X3RleHQoIk1FQVNVUkUiLCBUcnVlLCAyNSwgMzApDQogICAgICAgICAgICBzZWxmLmRpc3BsYXlfdGV4dCgiQlVERFkiLCBUcnVlLCAyNSwgNTApDQogICAgICAgICAgICBzZWxmLmRpc3BsYXlfdGV4dCgie30iLmZvcm1hdChoZWxwZXIuZ2V0X3N5c3RlbV9pZCgpKSwgVHJ1ZSwgNywgNzApDQogICAgDQogICAgDQogICAgZGVmIHNob3dfcmVjaXBlX2luZ3JlZGllbnRzKHNlbGYsIF9pbmdyZWRpZW50czogW3N0cl0sIF9mb3JjZV9yZWZyZXNoOiBib29sID0gVHJ1ZSk6DQogICAgICAgIGZ1bGxfcmVmcmVzaCA9IEZhbHNlDQogICAgICAgIGlmIHNlbGYubGFzdF9kaXNwbGF5X3NvdXJjZSAhPSA0IG9yIF9mb3JjZV9yZWZyZXNoOg0KICAgICAgICAgICAgZnVsbF9yZWZyZXNoID0gVHJ1ZQ0KICAgICAgICBzZWxmLmxhc3RfZGlzcGxheV9zb3VyY2UgPSA0DQogICAgICAgIA0KICAgICAgICBpZiBmdWxsX3JlZnJlc2g6DQogICAgICAgICAgICBzZWxmLmRpc3BsYXkuZXJhc2UoKQ0KICAgICAgICAgICAgc2VsZi5kaXNwbGF5X3RleHQoIkluZ3JlZGllbnRzIiwgVHJ1ZSwgMCwgNykNCiANCiAgICAgICAgdGV4dCA9ICIiDQogICAgICAgIGZvciBpdGVtIGluIF9pbmdyZWRpZW50czoNCiAgICAgICAgICAgIHRleHQgPSB0ZXh0ICsgInt9XG4iLmZvcm1hdChpdGVtKQ0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgc2VsZi5kaXNwbGF5X3RleHQodGV4dCwgVHJ1ZSwgMCwgMzApDQoNCiAgICANCiAgICAgIA0KICAgIGRlZiBzaG93X3NjYWxlKHNlbGYsIF92YWx1ZTogaW50KToNCiAgICAgICAgZnVsbF9yZWZyZXNoID0gRmFsc2UNCiAgICAgICAgaWYgc2VsZi5sYXN0X2Rpc3BsYXlfc291cmNlICE9IDU6DQogICAgICAgICAgICBmdWxsX3JlZnJlc2ggPSBUcnVlDQogICAgICAgIHNlbGYubGFzdF9kaXNwbGF5X3NvdXJjZSA9IDUNCiAgICAgICAgDQogICAgICAgIGlmIGZ1bGxfcmVmcmVzaDoNCiAgICAgICAgICAgIHNlbGYuZGlzcGxheS5lcmFzZSgpDQogICAgICAgICAgICBzZWxmLmRpc3BsYXlfdGV4dCgiU0NBTEUgTU9ERSIsIFRydWUsIDAsIDcpDQogICAgICAgIA0KICAgICAgICBzZWxmLmRpc3BsYXlfcmVjdCgyNSw1MCwgMTAwLCA2MCkNCiAgICAgICAgc2VsZi5kaXNwbGF5X3RleHQoIns6MDRkfWciLmZvcm1hdChfdmFsdWUpLCBUcnVlLCAyNSwgNTApDQogICAgDQogICAgZGVmIHNob3dfZGV2aWNlX3FyX2NvZGUoc2VsZiwgX3VybDpzdHIgPSAiIiwgX29mZnNldF94OmludCA9IDAsIF9vZmZzZXRfeTppbnQgPSAwKToNCiAgICAgICAgZnVsbF9yZWZyZXNoID0gRmFsc2UNCiAgICAgICAgaWYgc2VsZi5sYXN0X2Rpc3BsYXlfc291cmNlICE9IDY6DQogICAgICAgICAgICBmdWxsX3JlZnJlc2ggPSBUcnVlDQogICAgICAgIHNlbGYubGFzdF9kaXNwbGF5X3NvdXJjZSA9IDYNCiAgICAgICAgDQogICAgICAgIGlmIGZ1bGxfcmVmcmVzaDoNCiAgICAgICAgICAgIHNlbGYuZGlzcGxheS5lcmFzZSgpDQogICAgICAgICAgICANCiAgICAgICAgICAgIHFyID0gdVFSLlFSQ29kZSgpDQogICAgICAgICAgICBpZiBfdXJsID09ICIiOg0KICAgICAgICAgICAgICAgIHFyLmFkZF9kYXRhKCJ7fSIuZm9ybWF0KGhlbHBlci5nZXRfc3lzdGVtX2lkKCkpKQ0KICAgICAgICAgICAgZWxzZToNCiAgICAgICAgICAgICAgICBxci5hZGRfZGF0YSgie30iLmZvcm1hdChfdXJsKSkNCiAgICAgICAgICAgIG1hdHJpeCA9IHFyLmdldF9tYXRyaXgoKQ0KICAgICAgICAgICAgZm9yIHkgaW4gcmFuZ2UobGVuKG1hdHJpeCkqMik6ICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIGZvciB4IGluIHJhbmdlKGxlbihtYXRyaXhbMF0pKjIpOiAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IG5vdCBtYXRyaXhbaW50KHkvMildW2ludCh4LzIpXSAgIA0KICAgICAgICAgICAgICAgICAgICBzZWxmLnBpeGVsKHggKyBfb2Zmc2V0X3gsIHkgKyBfb2Zmc2V0X3ksIHZhbHVlKQ0KICAgICAgICBzZWxmLnNob3coKSAgDQoNCg==", "helper.py": "aW1wb3J0IHRpbWUNCmltcG9ydCB1YmluYXNjaWkNCmltcG9ydCBtYWNoaW5lDQppbXBvcnQgY29uZmlnDQppbXBvcnQgbmVvcGl4ZWwNCmltcG9ydCByYW5kb20NCmltcG9ydCBzeXMNCg0KZGVmIG1pbGxpcygpOg0KICAgIHJldHVybiByb3VuZCh0aW1lLnRpbWUoKSAqIDEwMDApDQoNCmRlZiBmbWFwKHMsIGExLCBhMiwgYjEsIGIyKSAtPiBmbG9hdDoNCiAgICByZXR1cm4gYjEgKyAocyAtIGExKSAqIChiMiAtIGIxKSAvIChhMiAtIGExKQ0KDQpkZWYgaW1hcChzLCBhMSwgYTIsIGIxLCBiMikgLT4gaW50Og0KICAgIHJldHVybiBiMSArIChzIC0gYTEpICogKGIyIC0gYjEpIC8gKGEyIC0gYTEpDQoNCmRlZiBnZXRfc3lzdGVtX2lkKCk6DQogICAgcmV0dXJuIHViaW5hc2NpaS5oZXhsaWZ5KG1hY2hpbmUudW5pcXVlX2lkKCkpLmRlY29kZSgndXRmLTgnKQ0KDQpkZWYgc2V0X25lb3BpeGVsX2Z1bGwoX25lb3BpeGVscmluZywgX3IsIF9nLCBfYik6DQogICAgZm9yIGkgaW4gcmFuZ2UoY29uZmlnLkNGR19ORU9QSVhFTF9MRURfQ09VTlQpOg0KICAgICAgICBfbmVvcGl4ZWxyaW5nW2ldID0gKF9yLCBfZywgX2IpDQogICAgX25lb3BpeGVscmluZy53cml0ZSgpDQoNCmRlZiBzZXRfbmVvcGl4ZWxfcmFuZG9tKF9uZW9waXhlbHJpbmcsIF9lcjogYm9vbCA9IEZhbHNlLCBfZWc6IGJvb2wgPSBGYWxzZSwgX2ViOiBib29sID0gVHJ1ZSk6DQogICAgcjogaW50ID0gaW50KDEyOCogcmFuZG9tLnJhbmRvbSgpKSAqIF9lcg0KICAgIGc6IGludCA9IGludCgxMjgqIHJhbmRvbS5yYW5kb20oKSkgKiBfZWcNCiAgICBiOiBpbnQgPSBpbnQoMTI4KiByYW5kb20ucmFuZG9tKCkpICogX2ViDQogICAgc2V0X25lb3BpeGVsX2Z1bGwoX25lb3BpeGVscmluZywgciwgZywgYikNCg0KZGVmIGhhc193aWZpKCk6DQogICAgaWYgJ1Jhc3BiZXJyeSBQaSBQaWNvIFcnIGluIHN0cihzeXMuaW1wbGVtZW50YXRpb24pOg0KICAgICAgICByZXR1cm4gVHJ1ZQ0KICAgIHJldHVybiBGYWxzZQ0K", "config.py": "IyBIQVJEV0FSRSBDT05GSUcgU1RBUlRTIEhFUkUKCgojIHNzZDEzMDYgPSAxMjh4NjQgb2xkZWQgd2l0aCBzc2QxMzA2IGNvbnRyb2xsZXIKIyBzaDExMDYgPSAxMjh4NjQgb2xkZWQgd2l0aCBzc2gxMTA2IGNvbnRyb2xsZXIKQ0ZHX0RJU1BMQVlfVFlQRSA9ICJzaDExMDYiICMgc2gxMTA2IHNoMTEwNiBzc2QxMzA2IGlsaTkzNApDRkdfQ0FMSUJSQVRJT05fV0VJR0hUX1dFSUdIVCA9IDUwCkNGR19TQ0FMRV9HTEFTU19BRERJVElPTl9ORVhUX1NURVBfV0VJR0hUID0gNTAgIyBYZyBtb3JlIG9uIHNjYWxlIHRvIHRyaWdnZXIgbmV4dCBzdGVwIGluIHJlY2lwZSA9PiAxLzMgd2VpZ2h0IG9mIGEgdHlwaWNhbCBnbGFzcwpDRkdfVVNFUl9MT05HX0JVVFRPTl9QUkVTU19USU1FID0gMTAwMCAjIHRpbWUgdG8gcmVnc2l0ZXIgYSBsb25nIGJ1dHRvbiBwcmVzcyBpbiBtcwpDRkdfTkVUV09SS19IT1NUTkFNRSA9ICJtaXhhbmRtZWFzdXJlYmVycnkiICMgeFh4WC5sb2NhbApDRkdfTkVUV09SS19XSUZJQ09VTlRSWSA9ICJERSIgIyBERSBVUwpDRkdfRElTUExBWV9VU0VSX1FSX0NPREUgPSBUcnVlICMgVHJ1ZSBGYWxzZQpDRkdfTkVPUElYRUxfTEVEX0NPVU5UID0gMjYgIzYwCkNGR19ORU9QSVhFTF9MRURfU1RBUlRfT0ZGU0VUID0gKENGR19ORU9QSVhFTF9MRURfQ09VTlQvMikgIyBNQVggQ0ZHX05FT1BJWEVMX0xFRF9DT1VOVCBUTyBST1RBVEUgVEhFIFNUQVJUUE9JTlQKCgoKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwojIyMjIyMjIyBQSU4gQ09ORklHICMjIyMjIyMjCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIyBORU9QSVhFTCBSSU5HCkNGR19ORU9QSVhFTF9QSU4gPSAyOAojIEJVVFRPTlMKQ0ZHX0JVVFRPTl9VUF9QSU4gPSAxMgpDRkdfQlVUVE9OX0RPV05fUElOID0gMTMKIyBIWDcxMSBNT0RVTEUKQ0ZHX0hYNzExX0RPVVRfUElOID0gNQpDRkdfSFg3MTFfU0NLX1BJTiA9IDEyCiMgW09QVElPTkFMXSBTRCBDQVJECkNGR19TRENBUkRfU1BJSU5TVEFOQ0UgPSAxCkNGR19TRENBUkRfU0NLX1BJTiA9IDEwCkNGR19TRENBUkRfTU9TSV9QSU4gPSAxMQpDRkdfU0RDQVJEX01JU09fUElOID0gOApDRkdfU0RDQVJEX0NTX1BJTiA9IDkKIyBbT1BUSU9OQUxdIFNTRDEzMDYgb3IgU0gxMTA2CkNGR19PTEVEX0kyQ0lOU1RBTkNFID0gMApDRkdfT0xFRF9TQ0xfUElOID0gMjEKQ0ZHX09MRURfU0RBX1BJTiA9IDIwCkNGR19PTEVEX0FERFIgPSAweDNjCkNGR19ESVNQTEFZX0xJTkVfU1BBQ0lORyA9IDkgIyBwaXhlbCBmb250IHdpZHRoCkNGR19ESVNQTEFZX0NIQVJfV0lEVEggPSA4CgpTQ1JfV0lEVEggPSAxMjgKU0NSX0hFSUdIVCA9IDY0CgoKICAgIAo=", "recipe_loader.py": "aW1wb3J0IG1hY2hpbmUNCmltcG9ydCBzZGNhcmQNCmltcG9ydCB1b3MNCmltcG9ydCBvcw0KaW1wb3J0IHRpbWUNCmltcG9ydCBqc29uDQoNCmZyb20gdWkgaW1wb3J0IHVpDQppbXBvcnQgY29uZmlnDQppbXBvcnQgaGVscGVyDQppbXBvcnQgZXhhbXBsZV9yZWNpcGVzDQoNCmlmIGhlbHBlci5oYXNfd2lmaSgpOg0KICAgIGltcG9ydCBuZXR3b3JrDQogICAgaW1wb3J0IHNvY2tldA0KICAgIGltcG9ydCB1cmVxdWVzdHMNCg0KDQoNCmNsYXNzIFVTRVJfSU5URVJBQ1RJT05fTU9ERSgpOg0KICAgIFNDQUxFID0gMA0KICAgIENPTkZJUk0gPSAxDQogICAgV0FJVCA9IDINCiAgICANCmNsYXNzIHJlY2lwZV9sb2FkZXI6DQogICAgDQogICAgSU5JVElBTF9TRVRUSU5HU19EQVRBOiBkaWN0ID0geyJjYWxpYnJhdGlvbiI6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsic2NfbWluIjoiMCIsICJzY19mdWxsIjoiNTAiLCAic2Nfd2VpZ2h0IjogY29uZmlnLkNGR19DQUxJQlJBVElPTl9XRUlHSFRfV0VJR0hUfSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIndpZmljcmVkZW50aWFscyI6IFsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsic3NpZCI6Ik1ha2Vyc3BhY2UiLCAicHNrIjogIk1TOGNDdnBFIn0sDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7InNzaWQiOiJQcm9EZXZNbyIsICJwc2siOiAiNjIyNjA1NDUyNzE5Mjg1NiJ9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBdLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiYXBpX2VuZHBvaW50IjogWyJtaXhtZWFzdXJlYnVkZHkuY29tL2FwaS9tbWIiLCAibWl4bWVhc3VyZWJ1ZGR5LmxvY2FsL2FwaS9tbWIiXQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgIA0KICAgIFJFQ0lQRV9CQVNFX0RJUiA9ICIvZGF0YSINCiAgICBsb2FkZWRfcmVjaXBlID0gTm9uZQ0KICAgIGN1cnJlbnRfcmVjaXBlX3N0ZXAgPSBOb25lDQogICAgc2QgPSBOb25lICMgc2RjYXJkIGNsYXNzIGluc3RhbmNlDQoNCg0KICAgIGRlZiBfX2luaXRfXyhzZWxmLCBfc3BpID0gTm9uZSwgY3NfcGluID0gY29uZmlnLkNGR19TRENBUkRfQ1NfUElOKToNCiAgICAgICAgcHJpbnQoInJlY2lwZV9sb2FkZXI6IF9faW5pdF9fIikNCiAgICAgICAgaWYgX3NwaSBpcyBOb25lOg0KICAgICAgICAgICAgX3NwaSA9IG1hY2hpbmUuU1BJKGNvbmZpZy5DRkdfU0RDQVJEX1NQSUlOU1RBTkNFLCBiYXVkcmF0ZT0xMDAwMDAwLCBwb2xhcml0eT0wLCBwaGFzZT0wLCBiaXRzPTgsIGZpcnN0Yml0PW1hY2hpbmUuU1BJLk1TQiwgc2NrPW1hY2hpbmUuUGluKGNvbmZpZy5DRkdfU0RDQVJEX1NDS19QSU4pLCBtb3NpPW1hY2hpbmUuUGluKGNvbmZpZy5DRkdfU0RDQVJEX01PU0lfUElOKSwgbWlzbz1tYWNoaW5lLlBpbihjb25maWcuQ0ZHX1NEQ0FSRF9NSVNPX1BJTikpDQogICAgICAgICMgQXNzaWduIGNoaXAgc2VsZWN0IChDUykgcGluIChhbmQgc3RhcnQgaXQgaGlnaCkNCiAgICAgICAgc2VsZi5jcyA9IG1hY2hpbmUuUGluKGNzX3BpbiwgbWFjaGluZS5QaW4uT1VUKQ0KDQogICAgICAgIHNlbGYuc2QgPSBOb25lDQogICAgICAgIHRyeToNCiAgICAgICAgICAgIHNlbGYuc2QgPSBzZGNhcmQuU0RDYXJkKF9zcGksIHNlbGYuY3MpDQoNCiAgICAgICAgICMgTW91bnQgZmlsZXN5c3RlbQ0KICAgICAgICAgICAgc2VsZi52ZnMgPSB1b3MuVmZzRmF0KHNlbGYuc2QpDQogICAgICAgICAgICB1b3MubW91bnQoc2VsZi52ZnMsIHNlbGYuUkVDSVBFX0JBU0VfRElSKQ0KICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6DQogICAgICAgICAgICBwcmludCgic2RjYXJkIGluaXQgZmFpbGVkIHVzaW5nIGxvY2FsIGZpbGVzeXN0ZW0gb24gL2RhdGEiLCBzdHIoZSkpDQoNCg0KICAgICAgICBpZiBzZWxmLnNkIGlzIE5vbmU6DQogICAgICAgICAgICB0cnk6IA0KICAgICAgICAgICAgICAgIG9zLm1rZGlyKHNlbGYuUkVDSVBFX0JBU0VfRElSKSANCiAgICAgICAgICAgICAgICBwcmludCgiRGlyZWN0b3J5ICclcycgY3JlYXRlZCBzdWNjZXNzZnVsbHkiICUgc2VsZi5SRUNJUEVfQkFTRV9ESVIpIA0KICAgICAgICAgICAgZXhjZXB0IE9TRXJyb3IgYXMgZXJyb3I6IA0KICAgICAgICAgICAgICAgIHByaW50KCJEaXJlY3RvcnkgJyVzJyBjYW4gbm90IGJlIGNyZWF0ZWQiICUgc2VsZi5SRUNJUEVfQkFTRV9ESVIpIA0KICAgICAgICANCiAgICAgICAgDQogICAgICAgIHByaW50KG9zLmxpc3RkaXIoc2VsZi5SRUNJUEVfQkFTRV9ESVIpKQ0KICAgICAgICANCiAgICAgICAgc2VsZi53cml0ZV9pbml0aWFsX3NldHRpbmdzKCkNCiAgICAgICAgc2VsZi51bmxvYWRfcmVjaXBlKCkNCiAgICAgICAgc2VsZi5jcmVhdGVfaW5pdGlhbF9yZWNpcGUoKQ0KICAgICAgICANCiAgICBkZWYgZ2V0X3JlY2lwZV9pbmZvcm1hdGlvbihzZWxmKSAtPiAoc3RyLCBzdHIpOg0KICAgICAgICBpZiBzZWxmLmxvYWRlZF9yZWNpcGUgaXMgTm9uZToNCiAgICAgICAgICAgIHJldHVybiAoImludmFsaWQiLCAiLS0tIikNCiAgICAgICAgDQogICAgICAgIHJldHVybiAoc2VsZi5sb2FkZWRfcmVjaXBlWyduYW1lJ10sIHNlbGYubG9hZGVkX3JlY2lwZVsnZGVzY3JpcHRpb24nXSkNCiAgICANCiAgICBkZWYgc3dpdGNoX25leHRfc3RlcChzZWxmKToNCiAgICAgICAgaWYgc2VsZi5sb2FkZWRfcmVjaXBlIGlzIE5vbmU6DQogICAgICAgICAgICByZXR1cm4NCiAgICAgICAgaWYgc2VsZi5jdXJyZW50X3JlY2lwZV9zdGVwIGlzIE5vbmU6DQogICAgICAgICAgICBzZWxmLmN1cnJlbnRfcmVjaXBlX3N0ZXAgPSAwDQogICAgICAgIHN0ZXBzID0gc2VsZi5sb2FkZWRfcmVjaXBlWydzdGVwcyddDQogICAgICAgIG5fc3RlcHMgPSBsZW4oc3RlcHMpDQogICAgICAgIGlmIHNlbGYuY3VycmVudF9yZWNpcGVfc3RlcCA8IG5fc3RlcHM6DQogICAgICAgICAgICBzZWxmLmN1cnJlbnRfcmVjaXBlX3N0ZXAgPSBzZWxmLmN1cnJlbnRfcmVjaXBlX3N0ZXAgKyAxDQogICAgICAgICAgICAgICAgICANCiAgICBkZWYgc3dpdGNoX3ByZXZfc3RlcChzZWxmKToNCiAgICAgICAgcGFzcw0KICAgIA0KICAgIGRlZiBpc19yZWNpcGVfbG9hZGVkKHNlbGYpOg0KICAgICAgICBpZiBzZWxmLmxvYWRlZF9yZWNpcGUgaXMgbm90IE5vbmU6DQogICAgICAgICAgICByZXR1cm4gVHJ1ZQ0KICAgICAgICByZXR1cm4gRmFsc2UNCiAgICAgICAgDQogICAgZGVmIGdldF9jdXJyZW50X3JlY2lwZV9zdGVwKHNlbGYpIC0+IChVU0VSX0lOVEVSQUNUSU9OX01PREUsIHN0ciwgc3RyLCBpbnQsIGludCwgaW50LCBib29sKTogIyAoYWN0aW9uLCBpbmdyZWRpZW50LCBjdXJyZW50X3N0ZXAsIG1heF9zdGVwcywgdGFyZ2V0X3dlaWdodCwgZmluaXNoZWQpDQogICAgICAgIGlmIHNlbGYubG9hZGVkX3JlY2lwZSBpcyBOb25lOg0KICAgICAgICAgICAgcmV0dXJuIChOb25lLCBOb25lLCBOb25lLCBOb25lLCBOb25lLCBOb25lLCBUcnVlKQ0KICAgICAgICBzdGVwcyA9IHNlbGYubG9hZGVkX3JlY2lwZVsnc3RlcHMnXQ0KICAgICAgICBuX3N0ZXBzID0gbGVuKHN0ZXBzKQ0KICAgICAgICBpZiBzZWxmLmN1cnJlbnRfcmVjaXBlX3N0ZXAgaXMgTm9uZToNCiAgICAgICAgICAgIHNlbGYuY3VycmVudF9yZWNpcGVfc3RlcCA9IDANCiAgICAgICAgDQogICAgICAgIGlmIHNlbGYuY3VycmVudF9yZWNpcGVfc3RlcCA+PSBuX3N0ZXBzOg0KICAgICAgICAgICAgIHJldHVybiAoTm9uZSwgTm9uZSwgTm9uZSwgTm9uZSwgTm9uZSwgTm9uZSwgVHJ1ZSkNCiAgICAgICAgICAgIA0KICAgICAgICBzdGVwID0gc3RlcHNbc2VsZi5jdXJyZW50X3JlY2lwZV9zdGVwXQ0KICAgICAgICBpZiBzdGVwWydhY3Rpb24nXSA9PSAnc2NhbGUnOg0KICAgICAgICAgICAgaW5ncmVkaWVudF9uYW1lID0gc2VsZi5sb2FkZWRfcmVjaXBlWydpbmdyZWRpZW50cyddW3N0ZXBbJ2luZ3JlZGllbnQnXV0NCiAgICAgICAgICAgIHJldHVybiAoVVNFUl9JTlRFUkFDVElPTl9NT0RFLlNDQUxFLCBzdGVwWydhY3Rpb24nXSwgaW5ncmVkaWVudF9uYW1lLCBzZWxmLmN1cnJlbnRfcmVjaXBlX3N0ZXArMSwgbl9zdGVwcywgc3RlcFsnYW1vdW50J10sIEZhbHNlKQ0KICAgICAgICBlbGlmIHN0ZXBbJ2FjdGlvbiddID09ICdjb25maXJtJzogICAgIA0KICAgICAgICAgICAgcmV0dXJuIChVU0VSX0lOVEVSQUNUSU9OX01PREUuQ09ORklSTSwgc3RlcFsnYWN0aW9uJ10sIHN0ZXBbJ3RleHQnXSwgc2VsZi5jdXJyZW50X3JlY2lwZV9zdGVwKzEsIG5fc3RlcHMsIDAsIEZhbHNlKQ0KICAgICAgICBlbGlmIHN0ZXBbJ2FjdGlvbiddID09ICd3YWl0JzogICAgIA0KICAgICAgICAgICAgcmV0dXJuIChVU0VSX0lOVEVSQUNUSU9OX01PREUuV0FJVCwgc3RlcFsnYWN0aW9uJ10sIHN0ZXBbJ3RleHQnXSwgc2VsZi5jdXJyZW50X3JlY2lwZV9zdGVwKzEsIG5fc3RlcHMsIHN0ZXBbJ2Ftb3VudCddLCBGYWxzZSkNCiAgICAgICAgZWxzZToNCiAgICAgICAgICAgIHJldHVybiAoTm9uZSwgTm9uZSwgTm9uZSwgTm9uZSwgTm9uZSwgTm9uZSwgVHJ1ZSkNCiAgICAgICAgICAgICAgICAgICAgDQogICAgZGVmIHVubG9hZF9yZWNpcGUoc2VsZik6DQogICAgICAgIHNlbGYubG9hZGVkX3JlY2lwZSA9IE5vbmUNCiAgICAgICAgDQogICAgZGVmIGdldF9pbmdyZWRpZW50X2xpc3Qoc2VsZikgLT4gW3N0cl06DQogICAgICAgIGlmIHNlbGYubG9hZGVkX3JlY2lwZSBpcyBOb25lOg0KICAgICAgICAgICAgcmV0dXJuIFtdDQogICAgICAgIHJ0ID0gW10NCiAgICAgICAgaW5nID0gc2VsZi5sb2FkZWRfcmVjaXBlWydpbmdyZWRpZW50cyddDQogICAgICAgIGlmIGluZyBpcyBOb25lOg0KICAgICAgICAgICAgcmV0dXJuIFtdDQogICAgICAgIGZvciBrIGluIGluZzoNCiAgICAgICAgICAgIHJ0LmFwcGVuZChpbmdba10pDQogICAgICAgIHJldHVybiBydA0KICAgIA0KICAgIGRlZiBnZXRfaW5ncmVkaWVudF9zdHIoc2VsZikgLT4gc3RyOg0KICAgICAgICBydCA9ICIiDQogICAgICAgIGZvciBpdGVtIGluIHNlbGYuZ2V0X2luZ3JlZGllbnRfbGlzdCgpOg0KICAgICAgICAgICAgcnQgPSBydCArIGl0ZW0gKyAiXG4iDQogICAgICAgIHJldHVybiBydA0KICAgICAgICANCiAgICBkZWYgY3JlYXRlX2luaXRpYWxfcmVjaXBlKHNlbGYpOg0KICAgICAgICBmb3IgayBpbiBleGFtcGxlX3JlY2lwZXMuRVhBTVBMRV9SRUNJUEVTX0NPTExFQ1RJT046DQogICAgICAgICAgICB3aXRoIG9wZW4oc2VsZi5SRUNJUEVfQkFTRV9ESVIgKyAiLyIgKyBrLCAidyIpIGFzIGZpbGU6DQogICAgICAgICAgICAgICAgZmlsZS53cml0ZShqc29uLmR1bXBzKGV4YW1wbGVfcmVjaXBlcy5FWEFNUExFX1JFQ0lQRVNfQ09MTEVDVElPTltrXSkpDQogICAgICAgICAgICANCiAgICAgICAgDQoNCiAgICANCiAgICBkZWYgc2F2ZV9jYWxpYnJhdGlvbl92YWx1ZXMoc2VsZiwgX3NjYWxlX2NhbGlicmF0aW9uXzBnOiBmbG9hdCwgX3NjYWxlX2NhbGlicmF0aW9uXzUwZzogZmxvYXQpOg0KICAgICAgICBjcmVkID0ge30NCiAgICAgICAgd2l0aCBvcGVuKHNlbGYuUkVDSVBFX0JBU0VfRElSICsgIi8iICsgIlNFVFRJTkdTLmpzb24iLCAiciIpIGFzIGZpbGU6DQogICAgICAgICAgICBjcmVkID0ganNvbi5sb2FkcyhmaWxlLnJlYWQoKSkNCiAgICAgICAgDQogICAgICAgIGlmICdjYWxpYnJhdGlvbicgbm90IGluIGNyZWQ6DQogICAgICAgICAgICBzZWxmLndyaXRlX2luaXRpYWxfc2V0dGluZ3MoKQ0KDQogICAgICAgIGNyZWRbJ2NhbGlicmF0aW9uJ11bJ3NjX21pbiddID0gc3RyKF9zY2FsZV9jYWxpYnJhdGlvbl8wZykNCiAgICAgICAgY3JlZFsnY2FsaWJyYXRpb24nXVsnc2NfZnVsbCddID0gc3RyKF9zY2FsZV9jYWxpYnJhdGlvbl81MGcpDQogICAgICAgIGNyZWRbJ2NhbGlicmF0aW9uJ11bJ3NjX3dlaWdodCddID0gc3RyKGNvbmZpZy5DRkdfQ0FMSUJSQVRJT05fV0VJR0hUX1dFSUdIVCkNCiAgICAgICAgcHJpbnQoY3JlZFsnY2FsaWJyYXRpb24nXSkNCiAgICANCiAgICAgICAgd2l0aCBvcGVuKHNlbGYuUkVDSVBFX0JBU0VfRElSICsgIi8iICsgIlNFVFRJTkdTLmpzb24iLCAidyIpIGFzIGZpbGU6DQogICAgICAgICAgICBmaWxlLndyaXRlKGpzb24uZHVtcHMoY3JlZCkpDQoNCiAgICBkZWYgZ2V0X2NhbGlicmF0aW9uX2ZhY3RvcihzZWxmKToNCiAgICAgICAgY3JlZCA9IHt9DQogICAgICAgIHdpdGggb3BlbihzZWxmLlJFQ0lQRV9CQVNFX0RJUiArICIvIiArICJTRVRUSU5HUy5qc29uIiwgInIiKSBhcyBmaWxlOg0KICAgICAgICAgICAgY3JlZCA9IGpzb24ubG9hZHMoZmlsZS5yZWFkKCkpDQogICAgICAgIA0KICAgICAgICBpZiAnY2FsaWJyYXRpb24nIG5vdCBpbiBjcmVkOg0KICAgICAgICAgICAgc2VsZi53cml0ZV9pbml0aWFsX3NldHRpbmdzKCkNCiAgICAgICAgDQogICAgICAgIGNhbGlicmF0aW9uX3ZhbHVlcyA9IGNyZWRbJ2NhbGlicmF0aW9uJ10NCiAgICAgICAgcHJpbnQoY2FsaWJyYXRpb25fdmFsdWVzKQ0KICAgICAgICBzY19taW4gPSBmbG9hdChjcmVkWydjYWxpYnJhdGlvbiddWydzY19taW4nXSkNCiAgICAgICAgc2NfZnVsbCA9IGZsb2F0KGNyZWRbJ2NhbGlicmF0aW9uJ11bJ3NjX2Z1bGwnXSkNCiAgICAgICAgc2Nfd2VpZ2h0ID0gZmxvYXQoY3JlZFsnY2FsaWJyYXRpb24nXVsnc2Nfd2VpZ2h0J10pDQogICAgICAgIA0KICAgICAgICBjYWxpYnJhdGlvbl9mYWN0b3IgPSAgKHNjX21pbi1zY19mdWxsKSAvIHNjX3dlaWdodA0KICAgICAgICBwcmludCgiZ2V0X2NhbGlicmF0aW9uX2ZhY3RvciB1c2luZyAoe30te30pIC8ge30gPSB7fSIuZm9ybWF0KHNjX21pbiwgc2NfZnVsbCwgc2Nfd2VpZ2h0LCBjYWxpYnJhdGlvbl9mYWN0b3IpKQ0KICAgICAgICByZXR1cm4gY2FsaWJyYXRpb25fZmFjdG9yDQoNCiAgICBkZWYgd3JpdGVfaW5pdGlhbF9zZXR0aW5ncyhzZWxmKToNCiAgICAgICAgaWYgIlNFVFRJTkdTLmpzb24iIGluIG9zLmxpc3RkaXIoc2VsZi5SRUNJUEVfQkFTRV9ESVIpOg0KICAgICAgICAgICAgcmV0dXJuDQogICAgICAgIHdpdGggb3BlbihzZWxmLlJFQ0lQRV9CQVNFX0RJUiArICIvIiArICJTRVRUSU5HUy5qc29uIiwgInciKSBhcyBmaWxlOg0KICAgICAgICAgICAgZmlsZS53cml0ZShqc29uLmR1bXBzKHNlbGYuSU5JVElBTF9TRVRUSU5HU19EQVRBKSkNCiAgICANCiAgICBkZWYgbGlzdF9yZWNwaWVzKHNlbGYpIC0+IChzdHIsIHN0cik6DQogICAgICAgIHJlcyA9IFtdDQogICAgICAgIGZvciBmIGluIG9zLmxpc3RkaXIoc2VsZi5SRUNJUEVfQkFTRV9ESVIpOg0KICAgICAgICAgICAgaWYgZi5lbmRzd2l0aCgnLnJlY2lwZScpOg0KICAgICAgICAgICAgICAgICMgZiA9IHRlcXVpbGFfc3VucmlzZS5yZWNpcGUNCiAgICAgICAgICAgICAgICBuYW1lID0gZi5yZXBsYWNlKCcucmVjaXBlJywgJycpLnJlcGxhY2UoJ18nLCAnICcpDQogICAgICAgICAgICAgICAgcmVzLmFwcGVuZCgoZixuYW1lKSkNCiAgICAgICAgcmV0dXJuIHJlcw0KICAgIA0KICAgIGRlZiBsb2FkX3JlY2lwZShzZWxmLCBfZmlsZW5hbWU6IHN0cikgLT4gYm9vbDoNCiAgICAgICAgIA0KICAgICAgICBpZiAnLnJlY2lwZScgbm90IGluIF9maWxlbmFtZToNCiAgICAgICAgICAgIF9maWxlbmFtZSA9IF9maWxlbmFtZSArICIucmVjaXBlIg0KICAgICAgICAgICAgDQogICAgICAgIGlmIF9maWxlbmFtZSBub3QgaW4gb3MubGlzdGRpcihzZWxmLlJFQ0lQRV9CQVNFX0RJUik6DQogICAgICAgICAgICByZXR1cm4gRmFsc2UNCiAgICAgICAgDQogICAgICAgIGpzb25fcmVjaXBlID0gTm9uZQ0KICAgICAgICB3aXRoIG9wZW4oc2VsZi5SRUNJUEVfQkFTRV9ESVIgKyAiLyIgKyBfZmlsZW5hbWUsICJyIikgYXMgZmlsZToNCiAgICAgICAgICAgIGpzb25fcmVjaXBlID0ganNvbi5sb2FkcyhmaWxlLnJlYWQoKSkNCiAgICAgICAgDQogICAgICAgIGlmIGpzb25fcmVjaXBlOg0KICAgICAgICAgICAgc2VsZi5sb2FkZWRfcmVjaXBlID0ganNvbl9yZWNpcGUNCiAgICAgICAgICAgIHJldHVybiBUcnVlDQogICAgDQoNCiAgICBkZWYgZGlzYWJsZV93aWZpKHNlbGYpOg0KICAgICAgICBpZiBub3QgaGVscGVyLmhhc193aWZpKCk6DQogICAgICAgICAgICByZXR1cm4gRmFsc2UNCiAgICAgICAgd2xhbiA9IG5ldHdvcmsuV0xBTihuZXR3b3JrLlNUQV9JRikNCiAgICAgICAgd2xhbi5hY3RpdmUoRmFsc2UpDQogICAgICAgIA0KICAgIGRlZiBjb25uZWN0X3dpZmkoc2VsZikgLT4gYm9vbDoNCiAgICAgICAgaWYgbm90IGhlbHBlci5oYXNfd2lmaSgpOg0KICAgICAgICAgICAgcmV0dXJuIEZhbHNlDQoNCiAgICAgICAgbmV0d29yay5jb3VudHJ5KGNvbmZpZy5DRkdfTkVUV09SS19XSUZJQ09VTlRSWSkNCiAgICAgICAgbmV0d29yay5ob3N0bmFtZShjb25maWcuQ0ZHX05FVFdPUktfSE9TVE5BTUUpDQoNCiAgICAgICAgY3JlZCA9IHt9DQogICAgICAgIHdpdGggb3BlbihzZWxmLlJFQ0lQRV9CQVNFX0RJUiArICIvIiArICJTRVRUSU5HUy5qc29uIiwgInIiKSBhcyBmaWxlOg0KICAgICAgICAgICAgY3JlZCA9IGpzb24ubG9hZHMoZmlsZS5yZWFkKCkpDQogICAgICAgIA0KICAgICAgICBpZiAid2lmaWNyZWRlbnRpYWxzIiBub3QgaW4gY3JlZCBvciBsZW4oY3JlZFsid2lmaWNyZWRlbnRpYWxzIl0pIDw9IDA6DQogICAgICAgICAgICByZXR1cm4gRmFsc2UNCiAgICAgICAgDQogICAgICAgIHdsYW4gPSBuZXR3b3JrLldMQU4obmV0d29yay5TVEFfSUYpDQogICAgICAgIHdsYW4uYWN0aXZlKFRydWUpDQogICAgICAgIA0KICAgICAgICBmb3Igd2lmaSBpbiBjcmVkWyJ3aWZpY3JlZGVudGlhbHMiXToNCiAgICAgICAgICAgIHByaW50KHdpZmkpDQogICAgICAgICAgICBzc2lkID0gd2lmaVsic3NpZCJdDQogICAgICAgICAgICBwc2sgPSB3aWZpWyJwc2siXQ0KICAgICAgICAgICAgDQogICAgICAgICAgICBwcmludCgiQ09OTkVDVElORyBUTzoge30iLmZvcm1hdChzc2lkKSkNCiAgICAgICAgICAgIHdsYW4uY29ubmVjdChzc2lkLCBwc2spDQogICAgICAgICAgICB0aW1lciA9IDANCiAgICAgICAgICAgIHdoaWxlIHdsYW4uaXNjb25uZWN0ZWQoKSA9PSBGYWxzZToNCiAgICAgICAgICAgICAgICBwcmludCgnV2FpdGluZyBmb3IgY29ubmVjdGlvbi4uLicpDQogICAgICAgICAgICAgICAgdGltZS5zbGVlcCgxKQ0KICAgICAgICAgICAgICAgIHRpbWVyID0gdGltZXIgKyAxDQoNCiAgICAgICAgICAgICAgICBpZiB0aW1lciA+IDEwOg0KICAgICAgICAgICAgICAgICAgICB3bGFuLmFjdGl2ZShGYWxzZSkNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIEZhbHNlDQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICBpZiB3bGFuLmlzY29ubmVjdGVkKCk6DQogICAgICAgICAgICAgICAgYnJlYWsNCiAgICAgICAgcmV0dXJuIFRydWUNCiAgICANCiAgICANCg0KICAgICAgICANCiAgICBkZWYgY2hlY2tfdXBkYXRlX3VybChzZWxmKSAtPiBzdHI6DQogICAgICAgIGlmIG5vdCBzZWxmLmNvbm5lY3Rfd2lmaSgpOg0KICAgICAgICAgICAgcmV0dXJuICIiDQogICAgICAgIG9rX3VybDpzdHIgPSAiIg0KICAgICAgICANCiAgICAgICAgY3JlZCA9IHt9DQogICAgICAgIHdpdGggb3BlbihzZWxmLlJFQ0lQRV9CQVNFX0RJUiArICIvIiArICJTRVRUSU5HUy5qc29uIiwgInIiKSBhcyBmaWxlOg0KICAgICAgICAgICAgY3JlZCA9IGpzb24ubG9hZHMoZmlsZS5yZWFkKCkpDQogICAgICAgIHByaW50KGNyZWRbImFwaV9lbmRwb2ludCJdKQ0KICAgICAgICBmb3IgdXJsIGluIGNyZWRbImFwaV9lbmRwb2ludCJdOg0KICAgICAgICAgICAgaWYgJ2h0dHA6Ly8nIG5vdCBpbiB1cmw6DQogICAgICAgICAgICAgICAgdXJsID0gJ2h0dHA6Ly8nICsgdXJsDQogICAgICAgICAgICBwcmludCh1cmwpDQogICAgICAgICAgICANCiAgICAgICAgICAgIHRyeToNCiAgICAgICAgICAgICAgICAjIEdFVCBMSVNUIE9GIFJFQ0lQRVMNCiAgICAgICAgICAgICAgICBmaW5hbCA9ICJ7fS97fSIuZm9ybWF0KHVybCwgc3RyKGhlbHBlci5nZXRfc3lzdGVtX2lkKCkpKQ0KICAgICAgICAgICAgICAgIHIgPSB1cmVxdWVzdHMuZ2V0KGZpbmFsKQ0KICAgICAgICAgICAgICAgIHIuY2xvc2UoKQ0KICAgICAgICAgICAgICAgIG9rX3VybCA9IGZpbmFsDQogICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOg0KICAgICAgICAgICAgICAgIHByaW50KHN0cihlKSkNCiAgICAgICAgICAgICAgICANCiAgICAgICAgcmV0dXJuIG9rX3VybA0KICAgICAgICANCiAgICBkZWYgdXBkYXRlX3JlY2lwZXMoc2VsZiwgX2d1aTogdWkudWkpIC0+IGJvb2w6DQogICAgICAgIGlmIG5vdCBzZWxmLmNvbm5lY3Rfd2lmaSgpOg0KICAgICAgICAgICAgcmV0dXJuIEZhbHNlDQogICAgICAgIA0KICAgICAgICB0aW1lLnNsZWVwKDIpDQogICAgICAgIA0KICAgICAgICBjcmVkID0ge30NCiAgICAgICAgd2l0aCBvcGVuKHNlbGYuUkVDSVBFX0JBU0VfRElSICsgIi8iICsgIlNFVFRJTkdTLmpzb24iLCAiciIpIGFzIGZpbGU6DQogICAgICAgICAgICBjcmVkID0ganNvbi5sb2FkcyhmaWxlLnJlYWQoKSkNCiAgICAgICAgaGVhZGVycz17fQ0KICAgICAgICBwcmludChjcmVkWyJhcGlfZW5kcG9pbnQiXSkNCiAgICAgICAgZm9yIHVybCBpbiBjcmVkWyJhcGlfZW5kcG9pbnQiXToNCiAgICAgICAgICAgIGlmICdodHRwOi8vJyBub3QgaW4gdXJsOg0KICAgICAgICAgICAgICAgIHVybCA9ICdodHRwOi8vJyArIHVybA0KICAgICAgICAgICAgcHJpbnQodXJsKQ0KICAgICAgICAgICAgX2d1aS5zaG93X21zZygiQVBJOiB7fSIuZm9ybWF0KHVybCkpDQogICAgICAgICAgICB0aW1lLnNsZWVwKDIpDQogICAgICAgICAgICB0cnk6DQogICAgICAgICAgICAgICAgIyBHRVQgTElTVCBPRiBSRUNJUEVTDQogICAgICAgICAgICAgICAgciA9IHVyZXF1ZXN0cy5nZXQoInt9L3t9L3JlY2lwZXMiLmZvcm1hdCh1cmwsIHN0cihoZWxwZXIuZ2V0X3N5c3RlbV9pZCgpKSksICBoZWFkZXJzPWhlYWRlcnMpDQogICAgICAgICAgICAgICAgcmVjaXBlX2xpc3QgPSByLmpzb24oKSAjIFsicmVzaXBlX2ZpbGVfdXJpX3JlbGF0aXZlIl0NCiAgICAgICAgICAgICAgICByLmNsb3NlKCkNCiAgICAgICAgICAgICAgICBpZiByZWNpcGVfbGlzdCBpcyBub3QgTm9uZToNCiAgICAgICAgICAgICAgICAgICAgIyBET05XTE9BRCBFQUNIIFJFQ0lQRQ0KICAgICAgICAgICAgICAgICAgICBmb3IgcmVjaXBlIGluIHJlY2lwZV9saXN0Og0KICAgICAgICAgICAgICAgICAgICAgICAgX2d1aS5zaG93X21zZygicmVjaXBlIHVwZGF0ZToge30iLmZvcm1hdChyZWNpcGUpKQ0KICAgICAgICAgICAgICAgICAgICAgICAgciA9IHVyZXF1ZXN0cy5nZXQoInt9L3t9L3JlY2lwZS97fSIuZm9ybWF0KHVybCwgc3RyKGhlbHBlci5nZXRfc3lzdGVtX2lkKCkpLCByZWNpcGUpLCAgaGVhZGVycz1oZWFkZXJzKQ0KICAgICAgICAgICAgICAgICAgICAgICAgZGxfcmVjaXBlID0gci5qc29uKCkgIyBbe2ZpbGVuYW1lX3dpdGhvdXRfZW5kaW5nLCByZWNpcGV9XQ0KICAgICAgICAgICAgICAgICAgICAgICAgci5jbG9zZSgpDQogICAgICAgICAgICAgICAgICAgICAgICB3aXRoIG9wZW4oc2VsZi5SRUNJUEVfQkFTRV9ESVIgKyAiLyIgKyBkbF9yZWNpcGVbJ25hbWUnXSArICIucmVjaXBlIiwgInciKSBhcyBmaWxlOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGUud3JpdGUoanNvbi5kdW1wcyggZGxfcmVjaXBlWydyZWNpcGUnXSkpDQogICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOg0KICAgICAgICAgICAgICAgIF9ndWkuc2hvd19tc2coc3RyKGUpKQ0KICAgICAgICAgICAgICAgIHByaW50KHN0cihlKSkNCiAgDQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICANCiAgICAgICAgc2VsZi5kaXNhYmxlX3dpZmkoKQ0KICAgICAgICByZXR1cm4gVHJ1ZQ0KICAgIA0KDQogICAgDQogICAgDQogICAgDQo=", "sdcard.py": "IiIiCk1pY3JvUHl0aG9uIGRyaXZlciBmb3IgU0QgY2FyZHMgdXNpbmcgU1BJIGJ1cy4KClJlcXVpcmVzIGFuIFNQSSBidXMgYW5kIGEgQ1MgcGluLiAgUHJvdmlkZXMgcmVhZGJsb2NrcyBhbmQgd3JpdGVibG9ja3MKbWV0aG9kcyBzbyB0aGUgZGV2aWNlIGNhbiBiZSBtb3VudGVkIGFzIGEgZmlsZXN5c3RlbS4KCkV4YW1wbGUgdXNhZ2Ugb24gcHlib2FyZDoKCiAgICBpbXBvcnQgcHliLCBzZGNhcmQsIG9zCiAgICBzZCA9IHNkY2FyZC5TRENhcmQocHliLlNQSSgxKSwgcHliLlBpbi5ib2FyZC5YNSkKICAgIHB5Yi5tb3VudChzZCwgJy9zZDInKQogICAgb3MubGlzdGRpcignLycpCgpFeGFtcGxlIHVzYWdlIG9uIEVTUDgyNjY6CgogICAgaW1wb3J0IG1hY2hpbmUsIHNkY2FyZCwgb3MKICAgIHNkID0gc2RjYXJkLlNEQ2FyZChtYWNoaW5lLlNQSSgxKSwgbWFjaGluZS5QaW4oMTUpKQogICAgb3MubW91bnQoc2QsICcvc2QnKQogICAgb3MubGlzdGRpcignLycpCgoiIiIKCmZyb20gbWljcm9weXRob24gaW1wb3J0IGNvbnN0CmltcG9ydCB0aW1lCgoKX0NNRF9USU1FT1VUID0gY29uc3QoMTAwKQoKX1IxX0lETEVfU1RBVEUgPSBjb25zdCgxIDw8IDApCiMgUjFfRVJBU0VfUkVTRVQgPSBjb25zdCgxIDw8IDEpCl9SMV9JTExFR0FMX0NPTU1BTkQgPSBjb25zdCgxIDw8IDIpCiMgUjFfQ09NX0NSQ19FUlJPUiA9IGNvbnN0KDEgPDwgMykKIyBSMV9FUkFTRV9TRVFVRU5DRV9FUlJPUiA9IGNvbnN0KDEgPDwgNCkKIyBSMV9BRERSRVNTX0VSUk9SID0gY29uc3QoMSA8PCA1KQojIFIxX1BBUkFNRVRFUl9FUlJPUiA9IGNvbnN0KDEgPDwgNikKX1RPS0VOX0NNRDI1ID0gY29uc3QoMHhGQykKX1RPS0VOX1NUT1BfVFJBTiA9IGNvbnN0KDB4RkQpCl9UT0tFTl9EQVRBID0gY29uc3QoMHhGRSkKCgpjbGFzcyBTRENhcmQ6CiAgICBkZWYgX19pbml0X18oc2VsZiwgc3BpLCBjcywgYmF1ZHJhdGU9MTMyMDAwMCk6CiAgICAgICAgc2VsZi5zcGkgPSBzcGkKICAgICAgICBzZWxmLmNzID0gY3MKCiAgICAgICAgc2VsZi5jbWRidWYgPSBieXRlYXJyYXkoNikKICAgICAgICBzZWxmLmR1bW15YnVmID0gYnl0ZWFycmF5KDUxMikKICAgICAgICBzZWxmLnRva2VuYnVmID0gYnl0ZWFycmF5KDEpCiAgICAgICAgZm9yIGkgaW4gcmFuZ2UoNTEyKToKICAgICAgICAgICAgc2VsZi5kdW1teWJ1ZltpXSA9IDB4RkYKICAgICAgICBzZWxmLmR1bW15YnVmX21lbW9yeXZpZXcgPSBtZW1vcnl2aWV3KHNlbGYuZHVtbXlidWYpCgogICAgICAgICMgaW5pdGlhbGlzZSB0aGUgY2FyZAogICAgICAgIHNlbGYuaW5pdF9jYXJkKGJhdWRyYXRlKQoKICAgIGRlZiBpbml0X3NwaShzZWxmLCBiYXVkcmF0ZSk6CiAgICAgICAgdHJ5OgogICAgICAgICAgICBtYXN0ZXIgPSBzZWxmLnNwaS5NQVNURVIKICAgICAgICBleGNlcHQgQXR0cmlidXRlRXJyb3I6CiAgICAgICAgICAgICMgb24gRVNQODI2NgogICAgICAgICAgICBzZWxmLnNwaS5pbml0KGJhdWRyYXRlPWJhdWRyYXRlLCBwaGFzZT0wLCBwb2xhcml0eT0wKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgICMgb24gcHlib2FyZAogICAgICAgICAgICBzZWxmLnNwaS5pbml0KG1hc3RlciwgYmF1ZHJhdGU9YmF1ZHJhdGUsIHBoYXNlPTAsIHBvbGFyaXR5PTApCgogICAgZGVmIGluaXRfY2FyZChzZWxmLCBiYXVkcmF0ZSk6CiAgICAgICAgIyBpbml0IENTIHBpbgogICAgICAgIHNlbGYuY3MuaW5pdChzZWxmLmNzLk9VVCwgdmFsdWU9MSkKCiAgICAgICAgIyBpbml0IFNQSSBidXM7IHVzZSBsb3cgZGF0YSByYXRlIGZvciBpbml0aWFsaXNhdGlvbgogICAgICAgIHNlbGYuaW5pdF9zcGkoMTAwMDAwKQoKICAgICAgICAjIGNsb2NrIGNhcmQgYXQgbGVhc3QgMTAwIGN5Y2xlcyB3aXRoIGNzIGhpZ2gKICAgICAgICBmb3IgaSBpbiByYW5nZSgxNik6CiAgICAgICAgICAgIHNlbGYuc3BpLndyaXRlKGIiXHhmZiIpCgogICAgICAgICMgQ01EMDogaW5pdCBjYXJkOyBzaG91bGQgcmV0dXJuIF9SMV9JRExFX1NUQVRFIChhbGxvdyA1IGF0dGVtcHRzKQogICAgICAgIGZvciBfIGluIHJhbmdlKDUpOgogICAgICAgICAgICBpZiBzZWxmLmNtZCgwLCAwLCAweDk1KSA9PSBfUjFfSURMRV9TVEFURToKICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmFpc2UgT1NFcnJvcigibm8gU0QgY2FyZCIpCgogICAgICAgICMgQ01EODogZGV0ZXJtaW5lIGNhcmQgdmVyc2lvbgogICAgICAgIHIgPSBzZWxmLmNtZCg4LCAweDAxQUEsIDB4ODcsIDQpCiAgICAgICAgaWYgciA9PSBfUjFfSURMRV9TVEFURToKICAgICAgICAgICAgc2VsZi5pbml0X2NhcmRfdjIoKQogICAgICAgIGVsaWYgciA9PSAoX1IxX0lETEVfU1RBVEUgfCBfUjFfSUxMRUdBTF9DT01NQU5EKToKICAgICAgICAgICAgc2VsZi5pbml0X2NhcmRfdjEoKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJhaXNlIE9TRXJyb3IoImNvdWxkbid0IGRldGVybWluZSBTRCBjYXJkIHZlcnNpb24iKQoKICAgICAgICAjIGdldCB0aGUgbnVtYmVyIG9mIHNlY3RvcnMKICAgICAgICAjIENNRDk6IHJlc3BvbnNlIFIyIChSMSBieXRlICsgMTYtYnl0ZSBibG9jayByZWFkKQogICAgICAgIGlmIHNlbGYuY21kKDksIDAsIDAsIDAsIEZhbHNlKSAhPSAwOgogICAgICAgICAgICByYWlzZSBPU0Vycm9yKCJubyByZXNwb25zZSBmcm9tIFNEIGNhcmQiKQogICAgICAgIGNzZCA9IGJ5dGVhcnJheSgxNikKICAgICAgICBzZWxmLnJlYWRpbnRvKGNzZCkKICAgICAgICBpZiBjc2RbMF0gJiAweEMwID09IDB4NDA6ICAjIENTRCB2ZXJzaW9uIDIuMAogICAgICAgICAgICBzZWxmLnNlY3RvcnMgPSAoKGNzZFs4XSA8PCA4IHwgY3NkWzldKSArIDEpICogMTAyNAogICAgICAgIGVsaWYgY3NkWzBdICYgMHhDMCA9PSAweDAwOiAgIyBDU0QgdmVyc2lvbiAxLjAgKG9sZCwgPD0yR0IpCiAgICAgICAgICAgIGNfc2l6ZSA9IChjc2RbNl0gJiAwYjExKSA8PCAxMCB8IGNzZFs3XSA8PCAyIHwgY3NkWzhdID4+IDYKICAgICAgICAgICAgY19zaXplX211bHQgPSAoY3NkWzldICYgMGIxMSkgPDwgMSB8IGNzZFsxMF0gPj4gNwogICAgICAgICAgICByZWFkX2JsX2xlbiA9IGNzZFs1XSAmIDBiMTExMQogICAgICAgICAgICBjYXBhY2l0eSA9IChjX3NpemUgKyAxKSAqICgyICoqIChjX3NpemVfbXVsdCArIDIpKSAqICgyKipyZWFkX2JsX2xlbikKICAgICAgICAgICAgc2VsZi5zZWN0b3JzID0gY2FwYWNpdHkgLy8gNTEyCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmFpc2UgT1NFcnJvcigiU0QgY2FyZCBDU0QgZm9ybWF0IG5vdCBzdXBwb3J0ZWQiKQogICAgICAgICMgcHJpbnQoJ3NlY3RvcnMnLCBzZWxmLnNlY3RvcnMpCgogICAgICAgICMgQ01EMTY6IHNldCBibG9jayBsZW5ndGggdG8gNTEyIGJ5dGVzCiAgICAgICAgaWYgc2VsZi5jbWQoMTYsIDUxMiwgMCkgIT0gMDoKICAgICAgICAgICAgcmFpc2UgT1NFcnJvcigiY2FuJ3Qgc2V0IDUxMiBibG9jayBzaXplIikKCiAgICAgICAgIyBzZXQgdG8gaGlnaCBkYXRhIHJhdGUgbm93IHRoYXQgaXQncyBpbml0aWFsaXNlZAogICAgICAgIHNlbGYuaW5pdF9zcGkoYmF1ZHJhdGUpCgogICAgZGVmIGluaXRfY2FyZF92MShzZWxmKToKICAgICAgICBmb3IgaSBpbiByYW5nZShfQ01EX1RJTUVPVVQpOgogICAgICAgICAgICB0aW1lLnNsZWVwX21zKDUwKQogICAgICAgICAgICBzZWxmLmNtZCg1NSwgMCwgMCkKICAgICAgICAgICAgaWYgc2VsZi5jbWQoNDEsIDAsIDApID09IDA6CiAgICAgICAgICAgICAgICAjIFNEU0MgY2FyZCwgdXNlcyBieXRlIGFkZHJlc3NpbmcgaW4gcmVhZC93cml0ZS9lcmFzZSBjb21tYW5kcwogICAgICAgICAgICAgICAgc2VsZi5jZHYgPSA1MTIKICAgICAgICAgICAgICAgICMgcHJpbnQoIltTRENhcmRdIHYxIGNhcmQiKQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgcmFpc2UgT1NFcnJvcigidGltZW91dCB3YWl0aW5nIGZvciB2MSBjYXJkIikKCiAgICBkZWYgaW5pdF9jYXJkX3YyKHNlbGYpOgogICAgICAgIGZvciBpIGluIHJhbmdlKF9DTURfVElNRU9VVCk6CiAgICAgICAgICAgIHRpbWUuc2xlZXBfbXMoNTApCiAgICAgICAgICAgIHNlbGYuY21kKDU4LCAwLCAwLCA0KQogICAgICAgICAgICBzZWxmLmNtZCg1NSwgMCwgMCkKICAgICAgICAgICAgaWYgc2VsZi5jbWQoNDEsIDB4NDAwMDAwMDAsIDApID09IDA6CiAgICAgICAgICAgICAgICBzZWxmLmNtZCg1OCwgMCwgMCwgLTQpICAjIDQtYnl0ZSByZXNwb25zZSwgbmVnYXRpdmUgbWVhbnMga2VlcCB0aGUgZmlyc3QgYnl0ZQogICAgICAgICAgICAgICAgb2NyID0gc2VsZi50b2tlbmJ1ZlswXSAgIyBnZXQgZmlyc3QgYnl0ZSBvZiByZXNwb25zZSwgd2hpY2ggaXMgT0NSCiAgICAgICAgICAgICAgICBpZiBub3Qgb2NyICYgMHg0MDoKICAgICAgICAgICAgICAgICAgICAjIFNEU0MgY2FyZCwgdXNlcyBieXRlIGFkZHJlc3NpbmcgaW4gcmVhZC93cml0ZS9lcmFzZSBjb21tYW5kcwogICAgICAgICAgICAgICAgICAgIHNlbGYuY2R2ID0gNTEyCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICMgU0RIQy9TRFhDIGNhcmQsIHVzZXMgYmxvY2sgYWRkcmVzc2luZyBpbiByZWFkL3dyaXRlL2VyYXNlIGNvbW1hbmRzCiAgICAgICAgICAgICAgICAgICAgc2VsZi5jZHYgPSAxCiAgICAgICAgICAgICAgICAjIHByaW50KCJbU0RDYXJkXSB2MiBjYXJkIikKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgIHJhaXNlIE9TRXJyb3IoInRpbWVvdXQgd2FpdGluZyBmb3IgdjIgY2FyZCIpCgogICAgZGVmIGNtZChzZWxmLCBjbWQsIGFyZywgY3JjLCBmaW5hbD0wLCByZWxlYXNlPVRydWUsIHNraXAxPUZhbHNlKToKICAgICAgICBzZWxmLmNzKDApCgogICAgICAgICMgY3JlYXRlIGFuZCBzZW5kIHRoZSBjb21tYW5kCiAgICAgICAgYnVmID0gc2VsZi5jbWRidWYKICAgICAgICBidWZbMF0gPSAweDQwIHwgY21kCiAgICAgICAgYnVmWzFdID0gYXJnID4+IDI0CiAgICAgICAgYnVmWzJdID0gYXJnID4+IDE2CiAgICAgICAgYnVmWzNdID0gYXJnID4+IDgKICAgICAgICBidWZbNF0gPSBhcmcKICAgICAgICBidWZbNV0gPSBjcmMKICAgICAgICBzZWxmLnNwaS53cml0ZShidWYpCgogICAgICAgIGlmIHNraXAxOgogICAgICAgICAgICBzZWxmLnNwaS5yZWFkaW50byhzZWxmLnRva2VuYnVmLCAweEZGKQoKICAgICAgICAjIHdhaXQgZm9yIHRoZSByZXNwb25zZSAocmVzcG9uc2VbN10gPT0gMCkKICAgICAgICBmb3IgaSBpbiByYW5nZShfQ01EX1RJTUVPVVQpOgogICAgICAgICAgICBzZWxmLnNwaS5yZWFkaW50byhzZWxmLnRva2VuYnVmLCAweEZGKQogICAgICAgICAgICByZXNwb25zZSA9IHNlbGYudG9rZW5idWZbMF0KICAgICAgICAgICAgaWYgbm90IChyZXNwb25zZSAmIDB4ODApOgogICAgICAgICAgICAgICAgIyB0aGlzIGNvdWxkIGJlIGEgYmlnLWVuZGlhbiBpbnRlZ2VyIHRoYXQgd2UgYXJlIGdldHRpbmcgaGVyZQogICAgICAgICAgICAgICAgIyBpZiBmaW5hbDwwIHRoZW4gc3RvcmUgdGhlIGZpcnN0IGJ5dGUgdG8gdG9rZW5idWYgYW5kIGRpc2NhcmQgdGhlIHJlc3QKICAgICAgICAgICAgICAgIGlmIGZpbmFsIDwgMDoKICAgICAgICAgICAgICAgICAgICBzZWxmLnNwaS5yZWFkaW50byhzZWxmLnRva2VuYnVmLCAweEZGKQogICAgICAgICAgICAgICAgICAgIGZpbmFsID0gLTEgLSBmaW5hbAogICAgICAgICAgICAgICAgZm9yIGogaW4gcmFuZ2UoZmluYWwpOgogICAgICAgICAgICAgICAgICAgIHNlbGYuc3BpLndyaXRlKGIiXHhmZiIpCiAgICAgICAgICAgICAgICBpZiByZWxlYXNlOgogICAgICAgICAgICAgICAgICAgIHNlbGYuY3MoMSkKICAgICAgICAgICAgICAgICAgICBzZWxmLnNwaS53cml0ZShiIlx4ZmYiKQogICAgICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlCgogICAgICAgICMgdGltZW91dAogICAgICAgIHNlbGYuY3MoMSkKICAgICAgICBzZWxmLnNwaS53cml0ZShiIlx4ZmYiKQogICAgICAgIHJldHVybiAtMQoKICAgIGRlZiByZWFkaW50byhzZWxmLCBidWYpOgogICAgICAgIHNlbGYuY3MoMCkKCiAgICAgICAgIyByZWFkIHVudGlsIHN0YXJ0IGJ5dGUgKDB4ZmYpCiAgICAgICAgZm9yIGkgaW4gcmFuZ2UoX0NNRF9USU1FT1VUKToKICAgICAgICAgICAgc2VsZi5zcGkucmVhZGludG8oc2VsZi50b2tlbmJ1ZiwgMHhGRikKICAgICAgICAgICAgaWYgc2VsZi50b2tlbmJ1ZlswXSA9PSBfVE9LRU5fREFUQToKICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgIHRpbWUuc2xlZXBfbXMoMSkKICAgICAgICBlbHNlOgogICAgICAgICAgICBzZWxmLmNzKDEpCiAgICAgICAgICAgIHJhaXNlIE9TRXJyb3IoInRpbWVvdXQgd2FpdGluZyBmb3IgcmVzcG9uc2UiKQoKICAgICAgICAjIHJlYWQgZGF0YQogICAgICAgIG12ID0gc2VsZi5kdW1teWJ1Zl9tZW1vcnl2aWV3CiAgICAgICAgaWYgbGVuKGJ1ZikgIT0gbGVuKG12KToKICAgICAgICAgICAgbXYgPSBtdls6IGxlbihidWYpXQogICAgICAgIHNlbGYuc3BpLndyaXRlX3JlYWRpbnRvKG12LCBidWYpCgogICAgICAgICMgcmVhZCBjaGVja3N1bQogICAgICAgIHNlbGYuc3BpLndyaXRlKGIiXHhmZiIpCiAgICAgICAgc2VsZi5zcGkud3JpdGUoYiJceGZmIikKCiAgICAgICAgc2VsZi5jcygxKQogICAgICAgIHNlbGYuc3BpLndyaXRlKGIiXHhmZiIpCgogICAgZGVmIHdyaXRlKHNlbGYsIHRva2VuLCBidWYpOgogICAgICAgIHNlbGYuY3MoMCkKCiAgICAgICAgIyBzZW5kOiBzdGFydCBvZiBibG9jaywgZGF0YSwgY2hlY2tzdW0KICAgICAgICBzZWxmLnNwaS5yZWFkKDEsIHRva2VuKQogICAgICAgIHNlbGYuc3BpLndyaXRlKGJ1ZikKICAgICAgICBzZWxmLnNwaS53cml0ZShiIlx4ZmYiKQogICAgICAgIHNlbGYuc3BpLndyaXRlKGIiXHhmZiIpCgogICAgICAgICMgY2hlY2sgdGhlIHJlc3BvbnNlCiAgICAgICAgaWYgKHNlbGYuc3BpLnJlYWQoMSwgMHhGRilbMF0gJiAweDFGKSAhPSAweDA1OgogICAgICAgICAgICBzZWxmLmNzKDEpCiAgICAgICAgICAgIHNlbGYuc3BpLndyaXRlKGIiXHhmZiIpCiAgICAgICAgICAgIHJldHVybgoKICAgICAgICAjIHdhaXQgZm9yIHdyaXRlIHRvIGZpbmlzaAogICAgICAgIHdoaWxlIHNlbGYuc3BpLnJlYWQoMSwgMHhGRilbMF0gPT0gMDoKICAgICAgICAgICAgcGFzcwoKICAgICAgICBzZWxmLmNzKDEpCiAgICAgICAgc2VsZi5zcGkud3JpdGUoYiJceGZmIikKCiAgICBkZWYgd3JpdGVfdG9rZW4oc2VsZiwgdG9rZW4pOgogICAgICAgIHNlbGYuY3MoMCkKICAgICAgICBzZWxmLnNwaS5yZWFkKDEsIHRva2VuKQogICAgICAgIHNlbGYuc3BpLndyaXRlKGIiXHhmZiIpCiAgICAgICAgIyB3YWl0IGZvciB3cml0ZSB0byBmaW5pc2gKICAgICAgICB3aGlsZSBzZWxmLnNwaS5yZWFkKDEsIDB4RkYpWzBdID09IDB4MDA6CiAgICAgICAgICAgIHBhc3MKCiAgICAgICAgc2VsZi5jcygxKQogICAgICAgIHNlbGYuc3BpLndyaXRlKGIiXHhmZiIpCgogICAgZGVmIHJlYWRibG9ja3Moc2VsZiwgYmxvY2tfbnVtLCBidWYpOgogICAgICAgICMgd29ya2Fyb3VuZCBmb3Igc2hhcmVkIGJ1cywgcmVxdWlyZWQgZm9yIChhdCBsZWFzdCkgc29tZSBLaW5nc3RvbgogICAgICAgICMgZGV2aWNlcywgZW5zdXJlIE1PU0kgaXMgaGlnaCBiZWZvcmUgc3RhcnRpbmcgdHJhbnNhY3Rpb24KICAgICAgICBzZWxmLnNwaS53cml0ZShiIlx4ZmYiKQoKICAgICAgICBuYmxvY2tzID0gbGVuKGJ1ZikgLy8gNTEyCiAgICAgICAgYXNzZXJ0IG5ibG9ja3MgYW5kIG5vdCBsZW4oYnVmKSAlIDUxMiwgIkJ1ZmZlciBsZW5ndGggaXMgaW52YWxpZCIKICAgICAgICBpZiBuYmxvY2tzID09IDE6CiAgICAgICAgICAgICMgQ01EMTc6IHNldCByZWFkIGFkZHJlc3MgZm9yIHNpbmdsZSBibG9jawogICAgICAgICAgICBpZiBzZWxmLmNtZCgxNywgYmxvY2tfbnVtICogc2VsZi5jZHYsIDAsIHJlbGVhc2U9RmFsc2UpICE9IDA6CiAgICAgICAgICAgICAgICAjIHJlbGVhc2UgdGhlIGNhcmQKICAgICAgICAgICAgICAgIHNlbGYuY3MoMSkKICAgICAgICAgICAgICAgIHJhaXNlIE9TRXJyb3IoNSkgICMgRUlPCiAgICAgICAgICAgICMgcmVjZWl2ZSB0aGUgZGF0YSBhbmQgcmVsZWFzZSBjYXJkCiAgICAgICAgICAgIHNlbGYucmVhZGludG8oYnVmKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgICMgQ01EMTg6IHNldCByZWFkIGFkZHJlc3MgZm9yIG11bHRpcGxlIGJsb2NrcwogICAgICAgICAgICBpZiBzZWxmLmNtZCgxOCwgYmxvY2tfbnVtICogc2VsZi5jZHYsIDAsIHJlbGVhc2U9RmFsc2UpICE9IDA6CiAgICAgICAgICAgICAgICAjIHJlbGVhc2UgdGhlIGNhcmQKICAgICAgICAgICAgICAgIHNlbGYuY3MoMSkKICAgICAgICAgICAgICAgIHJhaXNlIE9TRXJyb3IoNSkgICMgRUlPCiAgICAgICAgICAgIG9mZnNldCA9IDAKICAgICAgICAgICAgbXYgPSBtZW1vcnl2aWV3KGJ1ZikKICAgICAgICAgICAgd2hpbGUgbmJsb2NrczoKICAgICAgICAgICAgICAgICMgcmVjZWl2ZSB0aGUgZGF0YSBhbmQgcmVsZWFzZSBjYXJkCiAgICAgICAgICAgICAgICBzZWxmLnJlYWRpbnRvKG12W29mZnNldCA6IG9mZnNldCArIDUxMl0pCiAgICAgICAgICAgICAgICBvZmZzZXQgKz0gNTEyCiAgICAgICAgICAgICAgICBuYmxvY2tzIC09IDEKICAgICAgICAgICAgaWYgc2VsZi5jbWQoMTIsIDAsIDB4RkYsIHNraXAxPVRydWUpOgogICAgICAgICAgICAgICAgcmFpc2UgT1NFcnJvcig1KSAgIyBFSU8KCiAgICBkZWYgd3JpdGVibG9ja3Moc2VsZiwgYmxvY2tfbnVtLCBidWYpOgogICAgICAgICMgd29ya2Fyb3VuZCBmb3Igc2hhcmVkIGJ1cywgcmVxdWlyZWQgZm9yIChhdCBsZWFzdCkgc29tZSBLaW5nc3RvbgogICAgICAgICMgZGV2aWNlcywgZW5zdXJlIE1PU0kgaXMgaGlnaCBiZWZvcmUgc3RhcnRpbmcgdHJhbnNhY3Rpb24KICAgICAgICBzZWxmLnNwaS53cml0ZShiIlx4ZmYiKQoKICAgICAgICBuYmxvY2tzLCBlcnIgPSBkaXZtb2QobGVuKGJ1ZiksIDUxMikKICAgICAgICBhc3NlcnQgbmJsb2NrcyBhbmQgbm90IGVyciwgIkJ1ZmZlciBsZW5ndGggaXMgaW52YWxpZCIKICAgICAgICBpZiBuYmxvY2tzID09IDE6CiAgICAgICAgICAgICMgQ01EMjQ6IHNldCB3cml0ZSBhZGRyZXNzIGZvciBzaW5nbGUgYmxvY2sKICAgICAgICAgICAgaWYgc2VsZi5jbWQoMjQsIGJsb2NrX251bSAqIHNlbGYuY2R2LCAwKSAhPSAwOgogICAgICAgICAgICAgICAgcmFpc2UgT1NFcnJvcig1KSAgIyBFSU8KCiAgICAgICAgICAgICMgc2VuZCB0aGUgZGF0YQogICAgICAgICAgICBzZWxmLndyaXRlKF9UT0tFTl9EQVRBLCBidWYpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgIyBDTUQyNTogc2V0IHdyaXRlIGFkZHJlc3MgZm9yIGZpcnN0IGJsb2NrCiAgICAgICAgICAgIGlmIHNlbGYuY21kKDI1LCBibG9ja19udW0gKiBzZWxmLmNkdiwgMCkgIT0gMDoKICAgICAgICAgICAgICAgIHJhaXNlIE9TRXJyb3IoNSkgICMgRUlPCiAgICAgICAgICAgICMgc2VuZCB0aGUgZGF0YQogICAgICAgICAgICBvZmZzZXQgPSAwCiAgICAgICAgICAgIG12ID0gbWVtb3J5dmlldyhidWYpCiAgICAgICAgICAgIHdoaWxlIG5ibG9ja3M6CiAgICAgICAgICAgICAgICBzZWxmLndyaXRlKF9UT0tFTl9DTUQyNSwgbXZbb2Zmc2V0IDogb2Zmc2V0ICsgNTEyXSkKICAgICAgICAgICAgICAgIG9mZnNldCArPSA1MTIKICAgICAgICAgICAgICAgIG5ibG9ja3MgLT0gMQogICAgICAgICAgICBzZWxmLndyaXRlX3Rva2VuKF9UT0tFTl9TVE9QX1RSQU4pCgogICAgZGVmIGlvY3RsKHNlbGYsIG9wLCBhcmcpOgogICAgICAgIGlmIG9wID09IDQ6ICAjIGdldCBudW1iZXIgb2YgYmxvY2tzCiAgICAgICAgICAgIHJldHVybiBzZWxmLnNlY3RvcnMKICAgICAgICBpZiBvcCA9PSA1OiAgIyBnZXQgYmxvY2sgc2l6ZSBpbiBieXRlcwogICAgICAgICAgICByZXR1cm4gNTEy", "mmb_display.py": "aW1wb3J0IGNvbmZpZwppbXBvcnQgbWFjaGluZQoKCmNsYXNzIG1tYl9kaXNwbGF5KCk6CgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGRpc3BsYXlfaW5zdGFuY2VfY3JlYXRvcigpOgogICAgICAgICAgICAgICAgICAgCiAgICAgICAgaWYgY29uZmlnLkNGR19ESVNQTEFZX1RZUEUgPT0gInNoMTEwNiI6CiAgICAgICAgICAgIGltcG9ydCBzaDExMDYKICAgICAgICAgICAgaTJjID0gbWFjaGluZS5JMkMoY29uZmlnLkNGR19PTEVEX0kyQ0lOU1RBTkNFLCBzY2w9bWFjaGluZS5QaW4oY29uZmlnLkNGR19PTEVEX1NDTF9QSU4pLCBzZGE9bWFjaGluZS5QaW4oY29uZmlnLkNGR19PTEVEX1NEQV9QSU4pLCBmcmVxPTQwMDAwMCkKICAgICAgICAgICAgZGlzcCA9IHNoMTEwNi5TSDExMDZfSTJDKGNvbmZpZy5TQ1JfV0lEVEgsIGNvbmZpZy5TQ1JfSEVJR0hULCBpMmMsIE5vbmUsIGNvbmZpZy5DRkdfT0xFRF9BRERSKQogICAgICAgICAgICBkaXNwLnNsZWVwKEZhbHNlKQogICAgICAgICAgICByZXR1cm4gZGlzcAoKICAgICAgICBlbGlmIGNvbmZpZy5DRkdfRElTUExBWV9UWVBFID09ICJzc2QxMzA2IjoKICAgICAgICAgICAgaW1wb3J0IHNzZDEzMDYKICAgICAgICAgICAgaTJjID0gbWFjaGluZS5JMkMoY29uZmlnLkNGR19PTEVEX0kyQ0lOU1RBTkNFLCBzY2w9bWFjaGluZS5QaW4oY29uZmlnLkNGR19PTEVEX1NDTF9QSU4pLCBzZGE9bWFjaGluZS5QaW4oY29uZmlnLkNGR19PTEVEX1NEQV9QSU4pLCBmcmVxPTQwMDAwMCkKICAgICAgICAgICAgZGlzcCA9IHNzZDEzMDYuU1NEMTMwNl9JMkMoY29uZmlnLlNDUl9XSURUSCwgY29uZmlnLlNDUl9IRUlHSFQsIGkyYywgY29uZmlnLkNGR19PTEVEX0FERFIpCiAgICAgICAgICAgIHJldHVybiBkaXNwCiAgICAgICAgcmV0dXJuIE5vbmUKCiAgICAKCiAgICAKICAgIGRlZiBfX2luaXRfXyhzZWxmKSAtPiBOb25lOgogICAgICAgIHBhc3MKCiAgICBkZWYgcGl4ZWwoc2VsZiwgeCwgeSwgdmFsdWUpOgogICAgICAgIHBhc3MKIAogICAgZGVmIHNob3coKToKICAgICAgICBwYXNzCiAgICAgIAogICAgZGVmIGZpbGxfcmVjdChzZWxmLCB4LCB5LCB3LCBoLCB2KToKICAgICAgICBwYXNzCiAgICAKICAgIGRlZiBwcmludChzZWxmLCBfc3RyKToKICAgICAgICBwYXNzCgogICAgZGVmIHdyaXRlKHNlbGYsIF9zdHIpOgogICAgICAgIHBhc3MKICAgIAogICAgZGVmIGVyYXNlKHNlbGYpOgogICAgICAgIHBhc3MKCiAgICBkZWYgdGV4dChzZWxmLCB0ZXh0LCB4LCB5LCBjb2xvcj0xKToKICAgICAgICBwYXNz", "Scales.py": "aW1wb3J0IHN0YXRpY19tb2R1bGVzLmh4NzExIGFzIGh4NzExDQppbXBvcnQgdGltZQ0KaW1wb3J0IG1hdGgNCg0KY2xhc3MgU2NhbGVzKGh4NzExLkhYNzExKToNCiAgICBkZWYgX19pbml0X18oc2VsZiwgZF9vdXQgPSA1LCBwZF9zY2sgPSAxMik6DQogICAgICAgIHN1cGVyKFNjYWxlcywgc2VsZikuX19pbml0X18oZF9vdXQsIHBkX3NjaykNCiAgICAgICAgc2VsZi5vZmZzZXQgPSAwDQoNCiAgICBkZWYgcmVzZXQoc2VsZik6DQogICAgICAgIHNlbGYucG93ZXJfb2ZmKCkNCiAgICAgICAgc2VsZi5wb3dlcl9vbigpDQoNCiAgICBkZWYgdGFyZShzZWxmKToNCiAgICAgICAgc2VsZi5vZmZzZXQgPSBzZWxmLnJlYWQoKQ0KDQogICAgZGVmIHJhd192YWx1ZShzZWxmKToNCiAgICAgICAgcmV0dXJuIHNlbGYucmVhZCgpIC0gc2VsZi5vZmZzZXQNCg0KICAgIGRlZiBzdGFibGVfcmF3X3ZhbHVlKHNlbGYsIHdpdGhvdXRfb2Zmc2V0OiBib29sID0gRmFsc2UsIHJlYWRzPTEwLCBkZWxheV91cz0xMCk6ICAgICANCiAgICAgICAgc3RhYmxlX3ZhbHVlcyA9IFtdDQogICAgICAgIGZvciBpIGluIHJhbmdlKHJlYWRzKToNCiAgICAgICAgICAgIGlmIHdpdGhvdXRfb2Zmc2V0Og0KICAgICAgICAgICAgICAgIHN0YWJsZV92YWx1ZXMuYXBwZW5kKHNlbGYucmVhZCgpKQ0KICAgICAgICAgICAgZWxzZTogICANCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICBzdGFibGVfdmFsdWVzLmFwcGVuZChzZWxmLnJhd192YWx1ZSgpKQ0KICAgICAgICAgICAgdGltZS5zbGVlcF9tcygxMCkNCiAgICAgICAgDQogICAgICAgIHRhcmVfdmFsdWUgPSAwLjANCiAgICAgICAgZm9yIHYgaW4gc3RhYmxlX3ZhbHVlczoNCiAgICAgICAgICAgIHRhcmVfdmFsdWUgPSB0YXJlX3ZhbHVlICsgdg0KICAgICAgICANCiAgICAgICAgcmV0dXJuIHRhcmVfdmFsdWUgLyByZWFkcw0KICAgIA0KIA0KICAgIGRlZiBzZXRfc2NhbGUoc2VsZiwgX3NjYWxlX2ZhY3RvcjogZmxvYXQpOg0KICAgICAgICBpZiBfc2NhbGVfZmFjdG9yIGlzIE5vbmUgb3IgX3NjYWxlX2ZhY3RvciA9PSAwLjA6DQogICAgICAgICAgICBfc2NhbGVfZmFjdG9yID0gMS4wDQogICAgICAgICAgICBwcmludCgic2V0IF9zY2FsZV9mYWN0b3IgdG8gMS4wIGR1ZSBwYXJhbWV0ZXIgX3NjYWxlX2ZhY3RvciBpcyBOb25lIG9yIFplcm8iKQ0KICAgICAgICBzZWxmLlNDQUxFX0ZBQ1RPUiA9IF9zY2FsZV9mYWN0b3INCiAgICAgICAgDQogICAgZGVmIGdldF91bml0KHNlbGYsIF9zdGFibGU6IGJvb2wgPSBGYWxzZSkgLT4gZmxvYXQ6DQogICAgICAgIGlmIHNlbGYuU0NBTEVfRkFDVE9SID09IDAuMDoNCiAgICAgICAgICAgIHNlbGYuU0NBTEVfRkFDVE9SID0gMS4wDQogICAgICAgICAgICANCiAgICAgICAgaWYgX3N0YWJsZToNCiAgICAgICAgICAgIHJldHVybiBzZWxmLnJhd192YWx1ZSgpIC8gc2VsZi5TQ0FMRV9GQUNUT1INCiAgICAgICAgDQogICAgICAgIHJldHVybiBzZWxmLnN0YWJsZV9yYXdfdmFsdWUoKSAvIHNlbGYuU0NBTEVfRkFDVE9SDQogICAgICAgIA0KICAgICAgICANCiAgICAgICAgDQogDQo="}

def restore_filesystem(_basepath: str = "/", _override: bool = False, _erase: bool = False):
    import ubinascii
    import os

    if _erase:
        print("erase enabled")
        for f in os.listdir():
            if f in __file__:
                print("skipping {} to vaoid installer override".format(f))
                continue 
            os.remove(f)

    for k in FILE_DATA:

        if k in os.listdir() and not _override:
            continue
        
        print(k)
        d = FILE_DATA[k]
        ubinascii.a2b_base64(d)

        with open(_basepath + "/" + k, "w") as file:
            file.write(ubinascii.a2b_base64(d))

    # CLEANUP
    del ubinascii
    del os


if __name__ == "__main__":

    import machine
    push_button_restore = machine.Pin(14, machine.Pin.IN, machine.Pin.PULL_UP)
    if push_button_restore:
        restore_filesystem(_override=True, _erase=True)


