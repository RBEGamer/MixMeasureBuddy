FILE_DATA = {"menu_entry_scale.py": "ZnJvbSBhYmMgaW1wb3J0IGFic3RyYWN0bWV0aG9kCmltcG9ydCBtZW51X2VudHJ5CmltcG9ydCBzeXN0ZW1fY29tbWFuZApmcm9tIHVpIGltcG9ydCB1aQpmcm9tIGxlZHJpbmcgaW1wb3J0IGxlZHJpbmcKZnJvbSBTY2FsZXMgaW1wb3J0IFNjYWxlSW50ZXJmYWNlCgpjbGFzcyBtZW51X2VudHJ5X3NjYWxlKG1lbnVfZW50cnkubWVudV9lbnRyeSk6CgoKICAgIFdJR0hUX0NIQU5HRV9ESVNQTEFZX1VQREFURTogZmxvYXQgPSAxLjAgIyBVUERBVCBESVNQTEFZIEFGVEVSTEVBU1QgWGcgQ0hBTkdFUwogICAgbGFzdF9zY2FsZV92YWx1ZTogZmxvYXQgPSAwLjAKICAgIG1heF9zY2FsZV92YWx1ZTogZmxvYXQgPSAwLjAKCiAgICBkZWYgX19pbml0X18oc2VsZik6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXygiU0NBTEUiLCAiQSBub3JtYWwga2l0Y2hlbiBzY2FsZSIpCgogICAgZGVmIHByZXZpZXcoc2VsZik6CiAgICAgICAgcHJpbnQoInByZXZpZXcge30iLmZvcm1hdChzZWxmLm5hbWUpKQogICAgICAgIHVpKCkuc2hvd19yZWNpcGVfaW5mb3JtYXRpb24oc2VsZi5uYW1lLCBzZWxmLmRlc2NyaXB0aW9uKQoKCiAgICBkZWYgYWN0aXZhdGUoc2VsZik6CiAgICAgICAgcHJpbnQoImFjdGl2YXRlIHt9Ii5mb3JtYXQoc2VsZi5uYW1lKSkKICAgICAgICBTY2FsZUludGVyZmFjZSgpLnRhcmUoKQogICAgICAgIHVpKCkuc2hvd19zY2FsZShTY2FsZUludGVyZmFjZSgpLmdldF9jdXJyZW50X3dlaWdodCgpKQogICAgICAgIHNlbGYubGFzdF9zY2FsZV92YWx1ZSA9IDAuMAogICAgICAgIHNlbGYubWF4X3NjYWxlX3ZhbHVlID0gMTAuMAogICAgICAgIGxlZHJpbmcoKS5zZXRfbmVvcGl4ZWxfZnVsbCgxMCwgMTAsIDEwKQoKCgogICAgZGVmIHRlYXJkb3duKHNlbGYpOgogICAgICAgIHByaW50KCJ0ZWFyZG93biB7fSIuZm9ybWF0KHNlbGYubmFtZSkpCgoKICAgIGRlZiB1cGRhdGUoc2VsZiwgX3N5c3RlbV9jb21tYW5kOiBzeXN0ZW1fY29tbWFuZC5zeXN0ZW1fY29tbWFuZCk6CgogICAgICAgICMgVVBEQVRFIFNDQUxFIFZBTFVFCiAgICAgICAgaWYgX3N5c3RlbV9jb21tYW5kLnR5cGUgPT0gc3lzdGVtX2NvbW1hbmQuc3lzdGVtX2NvbW1hbmQuQ09NTUFORF9UWVBFX1NDQUxFX1ZBTFVFOgogICAgICAgICAgICBpZiBhYnMoX3N5c3RlbV9jb21tYW5kLnZhbHVlIC0gc2VsZi5sYXN0X3NjYWxlX3ZhbHVlKToKICAgICAgICAgICAgICAgIHNlbGYubGFzdF9zY2FsZV92YWx1ZSA9IF9zeXN0ZW1fY29tbWFuZC52YWx1ZQogICAgICAgICAgICAgICAgdWkoKS5zaG93X3NjYWxlKHNlbGYubGFzdF9zY2FsZV92YWx1ZSkgCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICMgQUREIFNPTUUgTkVPUElYRUwgTElHSFROSU5HCiAgICAgICAgICAgICAgICBsZWRyaW5nKCkuc2V0X25lb3BpeGVsX3BlcmNlbnRhZ2UobWluKDEuMCwgYWJzKHNlbGYubWF4X3NjYWxlX3ZhbHVlIC8gc2VsZi5sYXN0X3NjYWxlX3ZhbHVlKSkpCgogICAgICAgICMgVEFSRSBTQ0FMRSBPTiBPSyBCVVRUT04KICAgICAgICBlbGlmIF9zeXN0ZW1fY29tbWFuZC50eXBlID09IHN5c3RlbV9jb21tYW5kLnN5c3RlbV9jb21tYW5kLkNPTU1BTkRfVFlQRV9OQVZJR0FUSU9OOgogICAgICAgICAgICBpZiBfc3lzdGVtX2NvbW1hbmQuYWN0aW9uID09IHN5c3RlbV9jb21tYW5kLnN5c3RlbV9jb21tYW5kLk5BVklHQVRJT05fRU5URVI6CiAgICAgICAgICAgICAgICBTY2FsZUludGVyZmFjZSgpLnRhcmUoKQogICAgICAgICAgICAgICAgc2VsZi5tYXhfc2NhbGVfdmFsdWUgPSAxMC4w", "recipe_loader.py": "aW1wb3J0IG1hY2hpbmUNCmltcG9ydCBvcw0KaW1wb3J0IHRpbWUNCmltcG9ydCBqc29uDQoNCmZyb20gdWkgaW1wb3J0IHVpDQppbXBvcnQgY29uZmlnDQppbXBvcnQgaGVscGVyDQppbXBvcnQgZXhhbXBsZV9yZWNpcGVzDQppbXBvcnQgc2V0dGluZ3MNCmltcG9ydCByZWNpcGUNCmZyb20gc2luZ2xldG9uIGltcG9ydCBzaW5nbGV0b24NCg0KDQoNCkBzaW5nbGV0b24NCmNsYXNzIHJlY2lwZV9sb2FkZXI6DQogICAgDQogIA0KICAgDQogICAgZGVmIF9faW5pdF9fKHNlbGYpOg0KICAgICAgICBwcmludCgicmVjaXBlX2xvYWRlcjogX19pbml0X18iKQ0KDQogICAgICAgIHNlbGYuY3JlYXRlX2luaXRpYWxfcmVjaXBlKCkNCiAgICAgICAgDQogICANCiAgICAgDQogICAgZGVmIGNyZWF0ZV9pbml0aWFsX3JlY2lwZShzZWxmKToNCiAgICAgICAgcjogcmVjaXBlLnJlY2lwZQ0KICAgICAgICBmb3IgciBpbiBleGFtcGxlX3JlY2lwZXMuR0VUX0VYQU1QTEVfUkVDSVBFU19DT0xMRUNUSU9OKCk6DQogICAgICAgICAgICBzZXR0aW5ncy5zZXR0aW5ncygpLndyaXRlX2pzb25fZmlsZShyLmZpbGVuYW1lLCByLnRvX2RpY3QoKSkNCiAgICAgICAgICAgIA0KDQogICAgZGVmIGxpc3RfcmVjcGllcyhzZWxmLCBfaW5jbHVkZV9kZXNjcmlwdGlvbjogYm9vbCA9IEZhbHNlKSAtPiB0dXBsZVtzdHIsIHN0ciwgc3RyXToNCiAgICAgICAgcmVzID0gW10NCiAgICAgICAgZm9yIGYgaW4gc2V0dGluZ3Muc2V0dGluZ3MoKS5saXN0X2ZpbGVzKCk6DQogICAgICAgICAgICBpZiBmLmVuZHN3aXRoKCcucmVjaXBlJyk6DQogICAgICAgICAgICAgICAgIyBmID0gdGVxdWlsYV9zdW5yaXNlLnJlY2lwZQ0KICAgICAgICAgICAgICAgIG5hbWU6IHN0ciA9IGYucmVwbGFjZSgnLnJlY2lwZScsICcnKS5yZXBsYWNlKCdfJywgJyAnKQ0KDQogICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IHN0ciA9ICIiDQoNCiAgICAgICAgICAgICAgICBpZiBfaW5jbHVkZV9kZXNjcmlwdGlvbjoNCiAgICAgICAgICAgICAgICAgICAgcjogcmVjaXBlLnJlY2lwZSA9IHNlbGYuZ2V0X3JlY2lwZV9ieV9maWxlbmFtZShmKQ0KICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbiA9IHIuZ2V0X2Rlc2NyaXB0aW9uKCkNCiAgICAgICAgICAgICAgICAgICAgZGVsIHINCg0KICAgICAgICAgICAgICAgIHJlcy5hcHBlbmQoKGYsbmFtZSwgZGVzY3JpcHRpb24pKQ0KICAgICAgICByZXR1cm4gcmVzDQogICAgDQoNCiAgICBkZWYgZ2V0X3JlY2lwZV9maWxlX2NvbnRlbnQoc2VsZiwgX2ZpbGVuYW1lOiBzdHIpIC0+IGRpY3Q6DQogICAgICAgICMgQ0hFQ0sgRk9SIEVYVEVOVElPTg0KICAgICAgICBpZiBub3QgX2ZpbGVuYW1lLmVuZHN3aXRoKCcucmVjaXBlJyk6DQogICAgICAgICAgICBfZmlsZW5hbWUgPSBfZmlsZW5hbWUgKyAiLnJlY2lwZSINCiAgICAgICAgIyBDSEVDSyBGSUxFIEVYSVNUUw0KICAgICAgICBpZiBfZmlsZW5hbWUgbm90IGluIHNldHRpbmdzLnNldHRpbmdzKCkubGlzdF9maWxlcygpOg0KICAgICAgICAgICAgcmV0dXJuIHJlY2lwZS5yZWNpcGUoKQ0KICAgICAgICAjIExPQUQgQ09OVEVOVCBBUyBKU09ODQogICAgICAgIGpzb25fcmVjaXBlID0gc2V0dGluZ3Muc2V0dGluZ3MoKS5sb2FkX2pzb25fZmlsZShfZmlsZW5hbWUpDQogICAgICAgIHJldHVybiBqc29uX3JlY2lwZQ0KICAgIA0KDQogICAgZGVmIGdldF9yZWNpcGVfYnlfZmlsZW5hbWUoc2VsZiwgX2ZpbGVuYW1lOiBzdHIpIC0+IHJlY2lwZS5yZWNpcGU6DQogICAgICAgICMgTE9BRCBKU09OIENPTlRFTlQgT0YgUkVDSVBFIEZJTEUgDQogICAgICAgIGpzb25fcmVjaXBlOiBkaWN0ID0gc2VsZi5nZXRfcmVjaXBlX2ZpbGVfY29udGVudChfZmlsZW5hbWUpDQoNCiAgICAgICAgIyBDUkVBVEUgUkVDSVBFDQogICAgICAgIHI6IHJlY2lwZS5yZWNpcGUgPSByZWNpcGUucmVjaXBlKCkNCg0KICAgICAgICBpZiBqc29uX3JlY2lwZSBpcyBOb25lIG9yIG5vdCBqc29uX3JlY2lwZTogICAgICAgIA0KICAgICAgICAgICAgcmV0dXJuIHINCiAgICAgICAgDQogICAgICAgICMgUEFSU0UgSlNPTiBUTyBSRUNJUEUNCiAgICAgICAgci5mcm9tX2RpY3QoanNvbl9yZWNpcGUpDQogICAgICAgIHJldHVybiByDQogICAgICAgIA0KDQogICAgDQogICAgDQo=", "config.py": "Q0ZHX0RFQlVHOiBib29sID0gRmFsc2UKIyBIQVJEV0FSRSBDT05GSUcgU1RBUlRTIEhFUkUKIyBzc2QxMzA2ID0gMTI4eDY0IG9sZGVkIHdpdGggc3NkMTMwNiBjb250cm9sbGVyCiMgc2gxMTA2ID0gMTI4eDY0IG9sZGVkIHdpdGggc3NoMTEwNiBjb250cm9sbGVyCkNGR19ESVNQTEFZX1RZUEU6IHN0ciA9ICJzaDExMDYiICMgc2gxMTA2IHNzZDEzMDYKQ0ZHX0NBTElCUkFUSU9OX1dFSUdIVF9XRUlHSFQ6ZmxvYXQgPSAzOTAuMApDRkdfU0NBTEVfSU5WRVJUX1dFSUdIVF9NRUFTVVJFRF9WQUxVRTogZmxvYXQgPSAtMS4wICMgaWYgdGhlIHNjYWxlIG1lYXN1cmVtZW50IGlzIG5lZ2F0aXZlIHNldCB0aGlzIHRvIDEuMCBvciAtMS4wCkNGR19TQ0FMRV9HTEFTU19BRERJVElPTl9ORVhUX1NURVBfV0VJR0hUOmZsb2F0ID0gNTAuMCAjIFhnIG1vcmUgb24gc2NhbGUgdG8gdHJpZ2dlciBuZXh0IHN0ZXAgaW4gcmVjaXBlID0+IDEvMyB3ZWlnaHQgb2YgYSB0eXBpY2FsIGdsYXNzCkNGR19VU0VSX0xPTkdfQlVUVE9OX1BSRVNTX1RJTUU6IGludCA9IDcwMCAjIHRpbWUgdG8gcmVnc2l0ZXIgYSBsb25nIGJ1dHRvbiBwcmVzcyBpbiBtcwoKQ0ZHX05FT1BJWEVMX0xFRF9DT1VOVDogaW50ID0gMjYgIzMyICM2MCBob3cgbWFueSBsZWRzIGZvciB0aGUgcmluZyBhcmUgdXNlZApDRkdfTkVPUElYRUxfTEVEX1NUQVJUX09GRlNFVDogaW50ID0gKENGR19ORU9QSVhFTF9MRURfQ09VTlQvMikgIyBNQVggQ0ZHX05FT1BJWEVMX0xFRF9DT1VOVCBUTyBST1RBVEUgVEhFIFNUQVJUUE9JTlQKQ0ZHX05FT1BJWEVMX01BWF9CUklHSFRORVNTOiBmbG9hdCA9IDAuOCAjIG1heCBsZWQgYnJpZ2huZXNzIG1vZGlmaWVyIDAuMCAtIDEuMAoKIyBERUZBVUxUIFdJRkkgU0VUVElOR1MKIyBDQU4gTEFURVIgQkUgQ0FOR0VEIElOIFRIRSBTRENBUkQvU0VUVElOR1MuSlNPTiBGSUxFCkNGR19ORVRXT1JLX0hPU1ROQU1FOiBzdHIgPSAibWl4YW5kbWVhc3VyZWJ1ZGR5IiAjIHhYeFgubG9jYWwKQ0ZHX05FVFdPUktfV0lGSUNPVU5UUlk6IHN0ciA9ICJERSIgIyBERSBVUwpDRkdfTkVUV09SS19XSUZJX1NTSUQ6IHN0ciA9ICJNYWtlcnNwYWNlIgpDRkdfTkVUV09SS19XSUZJX1BTSzogc3RyID0gIk1TOGNDdnBFIgpDRkdfTkVUV09SS19BUElfRU5EUE9JTlQ6IHN0ciA9ICJtaXhtZWFzdXJlYnVkZHkuY29tL2FwaS9tbWIiCgoKIyBTRVRUSU5HUyBGT1IgQUNDRVNTIFBPSU5UICsgTE9DQUwgV0VCRURJVE9SCkNGR19FRElUT1JfV0lGSV9TVEFfSE9TVE5BTUU6IHN0ciA9ICJtaXhhbmRtZWFzdXJlYnVkZHkiCkNGR19FRElUT1JfV0lGSV9TVEFfU1NJRDogc3RyID0gIm1peGFuZG1lYXN1cmVidWRkeSIKQ0ZHX0VESVRPUl9XSUZJX1NUQV9QU0s6IHN0ciA9ICJ7fSIgICMKQ0ZHX0VESVRPUl9IVFRQX1BPUlQ6IGludCA9IDgwICMgV0VCU0VSVkVSIFBPUlQgRk9SIFRIRSBPTkxJTkUgRURJVE9SCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIyMjIyMjIyMgUElOIENPTkZJRyAjIyMjIyMjIwojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiMgTkVPUElYRUwgUklORwpDRkdfTkVPUElYRUxfUElOOiBpbnQgPSAyOAojIEJVVFRPTlMKQ0ZHX0JVVFRPTl9MRUZUX1BJTjogaW50ID0gMyAjMjIKQ0ZHX0JVVFRPTl9SSUdIVF9QSU46IGludCA9IDIKCiNFTkNPREVSCkNGR19FTkNPREVSX0lOVkVSVDogYm9vbCA9IEZhbHNlCkNGR19FTkNPREVSX0NMS19QSU46IGludCA9IDIwCkNGR19FTkNPREVSX0RUX1BJTjogaW50ID0gMTkKQ0ZHX0VOQ09ERVJfU1dfUElOOiBpbnQgPSAxOAojIEhYNzExIE1PRFVMRQpDRkdfSFg3MTFfRE9VVF9QSU46IGludCA9IDUKQ0ZHX0hYNzExX1NDS19QSU46IGludCA9IDQKIyBbT1BUSU9OQUxdIFNEIENBUkQKQ0ZHX1NEQ0FSRF9TUElJTlNUQU5DRTogaW50ID0gMSAjIE9OIFJQMjA0MCAwIG9yIDEgREVQRU5ESU5HIFRIRSBGT0xMT1dJTkcgVVNFRCBTUEkgUElOUwpDRkdfU0RDQVJEX1NDS19QSU46IGludCA9IDEwCkNGR19TRENBUkRfTU9TSV9QSU46IGludCA9IDExCkNGR19TRENBUkRfTUlTT19QSU46IGludCA9IDgKQ0ZHX1NEQ0FSRF9DU19QSU46IGludCA9IDkKIyBbT1BUSU9OQUxdIFNTRDEzMDYgb3IgU0gxMTA2CkNGR19PTEVEX0kyQ0lOU1RBTkNFOiBpbnQgPSAwICMgT04gUlAyMDQwIDAgb3IgMSBERVBFTkRJTkcgVEhFIEZPTExPV0lORyBVU0VEIEkyQyBQSU5TCkNGR19PTEVEX1NDTF9QSU46IGludCA9IDE3CkNGR19PTEVEX1NEQV9QSU46IGludCA9IDE2CkNGR19PTEVEX0FERFI6IGludCA9IDB4M2MKQ0ZHX0RJU1BMQVlfQ0hBUl9XSURUSDogaW50ID0gOCAjIGNoYXIgd2lkdGggaW4gcGl4ZWxzIHNlZSB2Z2EyeDh4IGFzIHVzZWQgZm9udGZpbGUKQ0ZHX0RJU1BMQVlfTElORV9TUEFDSU5HOiBpbnQgPSAoQ0ZHX0RJU1BMQVlfQ0hBUl9XSURUSCArIDEpICMgcGl4ZWwgZm9udCBoZWlnaHQgKyAgYSBiaXQgZXh0cmEgc3BhY2UgdG8gbWFrZSBsYXJnZSB0ZXh0IG1vcmUgcmVhZGFibGUKCiMgRElTUExBWSBSRVNPTFVUSU9OClNDUl9XSURUSDogaW50ID0gMTI4ClNDUl9IRUlHSFQ6IGludCA9IDY0CgoKICAgIAo=", "menu_entry_submenu.py": "ZnJvbSBhYmMgaW1wb3J0IGFic3RyYWN0bWV0aG9kCmltcG9ydCBtZW51X2VudHJ5CmltcG9ydCBzeXN0ZW1fY29tbWFuZApmcm9tIHVpIGltcG9ydCB1aQpmcm9tIGxlZHJpbmcgaW1wb3J0IGxlZHJpbmcKZnJvbSByZWNpcGVfdXBkYXRlciBpbXBvcnQgcmVjaXBlX3VwZGF0ZXIKZnJvbSBzdGF0aWNfbW9kdWxlcy5tZW51X21hbmFnZXIgaW1wb3J0IG1lbnVfbWFuYWdlcgpjbGFzcyBtZW51X2VudHJ5X3N1Ym1lbnUobWVudV9lbnRyeS5tZW51X2VudHJ5KToKCgogICAgTUVOVV9TVEFURV9JTkFDVElWRSA9IDAKICAgIE1FTlVfU1RBVEVfQUNUSVZFID0gMQoKICAgIG1lbnVfZW50aXJlczogW21lbnVfZW50cnkubWVudV9lbnRyeV0gPSBbXQogICAgY3VycmVudF9hY3RpdmVfZW50cnlfaW5kZXg6IGludCA9IC0xCiAgICBjdXJyZW50X21lbnVfc3RhdGU6IGludCA9IE1FTlVfU1RBVEVfSU5BQ1RJVkUKCiAgICBkZWYgX19pbml0X18oc2VsZiwgX3N1Ym1lbnVfbmFtZTogc3RyLCBfc3VibWVudV9kZXNjcmlwdGlvbjogc3RyID0gIiIpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oX3N1Ym1lbnVfbmFtZSxfc3VibWVudV9kZXNjcmlwdGlvbikKCiAgICBkZWYgYWRkX3N1YmVudHJpZXMoc2VsZiwgX2VudHJ5OiBtZW51X2VudHJ5Lm1lbnVfZW50cnkpOgogICAgICAgIHNlbGYubWVudV9lbnRpcmVzLmFwcGVuZChfZW50cnkpCgogICAgICAgIAoKICAgIGRlZiBwcmV2aWV3KHNlbGYpOgogICAgICAgIHByaW50KCJwcmV2aWV3IHt9Ii5mb3JtYXQoc2VsZi5uYW1lKSkKICAgICAgICB1aSgpLnNob3dfcmVjaXBlX2luZm9ybWF0aW9uKHNlbGYubmFtZSwgc2VsZi5kZXNjcmlwdGlvbikKCiAgICBkZWYgZGlzcGxheV9wcmV2aWV3KHNlbGYpOgogICAgICAgIHNlbGYuZ2V0X21lbnVfZW50cnkoKS5wcmV2aWV3KCkKICAgICAgICAjIE9QVElPTkFMIERJU1BMQVkgTEVEIFNUQVRFCiAgICAgICAgbGVkcmluZy5sZWRyaW5nKCkuc2V0X25lb3BpeGVsX3NwaW5uZXIoc2VsZi5jdXJyZW50X2FjdGl2ZV9lbnRyeV9pbmRleCwgbGVuKHNlbGYubWVudV9lbnRpcmVzKSwgbGVkcmluZy5sZWRyaW5nKCkuQ09MT1JfUFJFU0VUX0hTVl9IX19QSU5LLCBsZWRyaW5nLmxlZHJpbmcoKS5DT0xPUl9QUkVTRVRfSFNWX0hfX0JMVUUpCiAgICAKCgogICAgZGVmIGFjdGl2YXRlKHNlbGYpOgogICAgICAgIHByaW50KCJhY3RpdmF0ZSB7fSIuZm9ybWF0KHNlbGYubmFtZSkpCgogICAgICAgIGlmIGxlbihzZWxmLm1lbnVfZW50aXJlcyk6CiAgICAgICAgICAgIHNlbGYudGVhcmRvd24oKQogICAgICAgICAgICBtZW51X21hbmFnZXIuZXhpdF9jdXJyZW50X21lbnUoKQoKICAgICAgICBpZiBzZWxmLmN1cnJlbnRfYWN0aXZlX2VudHJ5X2luZGV4IDwgMDoKICAgICAgICAgICAgc2VsZi5jdXJyZW50X2FjdGl2ZV9lbnRyeV9pbmRleCA9IDAKICAgICAgICAgICAgc2VsZi5kaXNwbGF5X3ByZXZpZXcoKQoKICAgICAgICBzZWxmLmN1cnJlbnRfbWVudV9zdGF0ZTogaW50ID0gc2VsZi5NRU5VX1NUQVRFX0lOQUNUSVZFCgogICAgZGVmIHRlYXJkb3duKHNlbGYpOgogICAgICAgIHByaW50KCJ0ZWFyZG93biB7fSIuZm9ybWF0KHNlbGYubmFtZSkpCiAgICAgICAgaWYgc2VsZi5nZXRfbWVudV9lbnRyeSgpIGlzIG5vdCBOb25lOgogICAgICAgICAgICBzZWxmLmdldF9tZW51X2VudHJ5KCkudGVhcmRvd24oKQoKICAgICAgICAgICAgCgoKICAgIGRlZiB1cGRhdGUoc2VsZiwgX3N5c3RlbV9jb21tYW5kOiBzeXN0ZW1fY29tbWFuZC5zeXN0ZW1fY29tbWFuZCk6CiAgICAgICAgaWYgc2VsZi5nZXRfbWVudV9lbnRyeSgpIGlzIE5vbmU6CiAgICAgICAgICAgIG1lbnVfbWFuYWdlcigpLmV4aXRfY3VycmVudF9tZW51KCkKICAgICAgICAKICAgICAgICAKICAgICAgICBpZiBzZWxmLmN1cnJlbnRfbWVudV9zdGF0ZSA9PSBzZWxmLk1FTlVfU1RBVEVfSU5BQ1RJVkU6CiAgICAgICAgICAgIGlmIF9zeXN0ZW1fY29tbWFuZC50eXBlID09IHN5c3RlbV9jb21tYW5kLnN5c3RlbV9jb21tYW5kLkNPTU1BTkRfVFlQRV9OQVZJR0FUSU9OOgoKICAgICAgICAgICAgICAgICMgU0NST0wgVEhPVUdIIE1FTlVTCiAgICAgICAgICAgICAgICBpZiBfc3lzdGVtX2NvbW1hbmQuYWN0aW9uID09IHN5c3RlbV9jb21tYW5kLnN5c3RlbV9jb21tYW5kLk5BVklHQVRJT05fTEVGVDoKICAgICAgICAgICAgICAgICAgICBzZWxmLmN1cnJlbnRfYWN0aXZlX2VudHJ5X2luZGV4ID0gKHNlbGYuY3VycmVudF9hY3RpdmVfZW50cnlfaW5kZXggKyAxKSAlIGxlbihzZWxmLm1lbnVfZW50aXJlcykKICAgICAgICAgICAgICAgICAgICBwcmludChzZWxmLmN1cnJlbnRfYWN0aXZlX2VudHJ5X2luZGV4KQogICAgICAgICAgICAgICAgICAgIHNlbGYuZGlzcGxheV9wcmV2aWV3KCkKICAgICAgICAgICAgICAgIGVsaWYgX3N5c3RlbV9jb21tYW5kLmFjdGlvbiA9PSBzeXN0ZW1fY29tbWFuZC5zeXN0ZW1fY29tbWFuZC5OQVZJR0FUSU9OX1JJR0hUOgogICAgICAgICAgICAgICAgICAgIHNlbGYuY3VycmVudF9hY3RpdmVfZW50cnlfaW5kZXggPSAoc2VsZi5jdXJyZW50X2FjdGl2ZV9lbnRyeV9pbmRleCAtIDEpICUgbGVuKHNlbGYubWVudV9lbnRpcmVzKQogICAgICAgICAgICAgICAgICAgIHNlbGYuZGlzcGxheV9wcmV2aWV3KCkKICAgICAgICAgICAgICAgICMgRU5URVIgTUVOVQogICAgICAgICAgICAgICAgZWxpZiBfc3lzdGVtX2NvbW1hbmQuYWN0aW9uID09IHN5c3RlbV9jb21tYW5kLnN5c3RlbV9jb21tYW5kLk5BVklHQVRJT05fRU5URVI6CiAgICAgICAgICAgICAgICAgICAgc2VsZi5nZXRfbWVudV9lbnRyeSgpLmFjdGl2YXRlKCkKICAgICAgICAgICAgICAgICAgICBzZWxmLmN1cnJlbnRfbWVudV9zdGF0ZSA9IHNlbGYuTUVOVV9TVEFURV9BQ1RJVkUKCiAgICAgICAgZWxpZiBzZWxmLmN1cnJlbnRfbWVudV9zdGF0ZSA9PSBzZWxmLk1FTlVfU1RBVEVfQUNUSVZFOgogICAgICAgICAgICAgICAgc2VsZi5nZXRfbWVudV9lbnRyeSgpLnVwZGF0ZShfc3lzdGVtX2NvbW1hbmQpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgbWVudV9tYW5hZ2VyKCkuZXhpdF9jdXJyZW50X21lbnUoKQoKCiAgICBkZWYgcHJvY2Vzc19zeXN0ZW1fY29tbWFuZHMoc2VsZiwgX3N5c3RlbV9jb21tYW5kOiBzeXN0ZW1fY29tbWFuZCk6CiAgICAgICAgaWYgc2VsZi5jdXJyZW50X21lbnVfc3RhdGUgPT0gc2VsZi5NRU5VX1NUQVRFX0FDVElWRToKICAgICAgICAgICAgc2VsZi5nZXRfbWVudV9lbnRyeSgpLnVwZGF0ZShfc3lzdGVtX2NvbW1hbmQpCiAgICAgICAgICAg", "ui.py": "ZnJvbSBzaW5nbGV0b24gaW1wb3J0IHNpbmdsZXRvbg0KaW1wb3J0IGNvbmZpZw0KaW1wb3J0IG1tYl9kaXNwbGF5DQppbXBvcnQgdVFSDQppbXBvcnQgaGVscGVyDQoNCkBzaW5nbGV0b24NCmNsYXNzIHVpOg0KICAgIA0KICANCiAgICANCg0KICAgIGRpc3BsYXk6IG1tYl9kaXNwbGF5DQoNCg0KDQogICAgZGVmIHBpeGVsKHNlbGYsIHgsIHksIHZhbHVlKToNCiAgICAgICAgc2VsZi5kaXNwbGF5LnBpeGVsKHgsIHksIHZhbHVlKQ0KICAgICAgICANCiAgICBkZWYgc2hvdyhzZWxmKToNCiAgICAgICAgICAgIHNlbGYuZGlzcGxheS5zaG93KCkNCiAgICAgICAgDQogICAgZGVmIGRpc3BsYXlfcmVjdChzZWxmLCBfcG9zX3hfcGVyY2VudGFnZTppbnQsIF9wb3NfeV9wZXJjZW50YWdlOmludCwgX3Bvc194X2VuZF9wZXJjOmludCwgX3Bvc195X2VuZF9wZXJjKToNCiAgICAgICAgeDogaW50ID0gaW50KChjb25maWcuU0NSX1dJRFRIIC8gMTAwLjApICogX3Bvc194X3BlcmNlbnRhZ2UpDQogICAgICAgIHk6IGludCA9IGludCgoY29uZmlnLlNDUl9IRUlHSFQgLyAxMDAuMCkgKiBfcG9zX3lfcGVyY2VudGFnZSkNCiAgICAgICAgDQogICAgICAgIHhlOiBpbnQgPSBpbnQoKGNvbmZpZy5TQ1JfV0lEVEggLyAxMDAuMCkgKiBfcG9zX3hfZW5kX3BlcmMpDQogICAgICAgIHllOiBpbnQgPSBpbnQoKGNvbmZpZy5TQ1JfSEVJR0hUIC8gMTAwLjApICogX3Bvc195X2VuZF9wZXJjKQ0KICAgICAgICANCg0KICAgICAgICBzZWxmLmRpc3BsYXkuZmlsbF9yZWN0KHgsIHksIGFicyh4LXhlKSwgYWJzKHkteWUpLCAwKSAjIDAgPSBCRyBDT0xPUg0KICAgICAgICBzZWxmLmRpc3BsYXkuc2hvdygpDQogICAgICAgIA0KICAgICAgICANCiAgICBkZWYgZGlzcGxheV90ZXh0KHNlbGYsIF9zdHI6c3RyLCBfd3JhcDpib29sID0gRmFsc2UsIF9wb3NfeF9wZXJjZW50YWdlOmludCA9IDAsIF9wb3NfeV9wZXJjZW50YWdlOmludCA9IDApOg0KICAgICAgICBfc3RyID0gX3N0ci5yZXBsYWNlKCLDnyIsICJzcyIpLnJlcGxhY2UoIsO2IiwgIm9lIikucmVwbGFjZSgiw6QiLCAiYWUiKS5yZXBsYWNlKCLDvCIsICJ1ZSIpDQoNCiAgICAgICAgeDogaW50ID0gaW50KChjb25maWcuU0NSX1dJRFRIIC8gMTAwLjApICogX3Bvc194X3BlcmNlbnRhZ2UpDQogICAgICAgIHk6IGludCA9IGludCgoY29uZmlnLlNDUl9IRUlHSFQgLyAxMDAuMCkgKiBfcG9zX3lfcGVyY2VudGFnZSkNCg0KICAgICAgICBpZiBub3QgX3dyYXA6DQogICAgICAgICAgICBzZWxmLmRpc3BsYXkudGV4dChfc3RyLCB4LCB5KQ0KICAgICAgICAgICAgc2VsZi5kaXNwbGF5LnNob3coKQ0KICAgICAgICAgICAgcmV0dXJuDQogICAgICAgICAgICANCg0KICAgICAgICAjIFdSQVAgVEVYVA0KICAgICAgICB3b3JkcyA9IFtdDQogICAgICAgIG5ld19saW5lcyA9IF9zdHIuc3BsaXQoIlxuIikNCiAgICAgICAgZm9yIGwgaW4gbmV3X2xpbmVzOg0KICAgICAgICAgICAgaWYgbm90IGwgPT0gIiAiOiANCiAgICAgICAgICAgICAgICBmb3IgdyBpbiBzdHIobCkuc3BsaXQoIiAiKToNCiAgICAgICAgICAgICAgICAgICAgaWYgbm90IHcgPT0gIiAiOg0KICAgICAgICAgICAgICAgICAgICAgICAgd29yZHMuYXBwZW5kKHcpDQogICAgICAgIA0KICAgICAgICBjaGFyc19sZWZ0ID0gMSArIChjb25maWcuU0NSX1dJRFRIIC0geCkvIGludChjb25maWcuQ0ZHX0RJU1BMQVlfQ0hBUl9XSURUSCkNCiAgICAgICAgI3ByaW50KCJjaGFyc19sZWZ0OiB7fSIuZm9ybWF0KGNoYXJzX2xlZnQpKQ0KICAgICAgICB3b3Jkc193cml0dGVuID0gMA0KICAgICAgICBsaW5lX3kgPSB5DQogICAgICAgICNwcmludCh3b3JkcykNCiAgICAgICAgZm9yIHcgaW4gd29yZHM6DQogICAgICAgICAgICB3X3NwYWNlID0gInt9ICIuZm9ybWF0KHcpDQoNCg0KICAgICAgICAgICAgaWYgKHdvcmRzX3dyaXR0ZW4rbGVuKHdfc3BhY2UpKSA+PSBjaGFyc19sZWZ0Og0KICAgICAgICAgICAgICAgICNwcmludCgibGluZV95Ont9Ii5mb3JtYXQobGluZV95KSkNCiAgICAgICAgICAgICAgICB3b3Jkc193cml0dGVuID0gMA0KICAgICAgICAgICAgICAgIGxpbmVfeSA9IGxpbmVfeSArIGludChjb25maWcuQ0ZHX0RJU1BMQVlfTElORV9TUEFDSU5HKQ0KDQoNCiAgICAgICAgICAgICNwcmludCgidzoge30iLmZvcm1hdCh3X3NwYWNlLCBsaW5lX3kpKSANCiAgICAgICAgICAgIHhwb3MgPSB4ICsgd29yZHNfd3JpdHRlbiAqIGludChjb25maWcuQ0ZHX0RJU1BMQVlfQ0hBUl9XSURUSCkNCiAgICAgICAgICAgIHNlbGYuZGlzcGxheS50ZXh0KHdfc3BhY2UsIHhwb3MsIGxpbmVfeSkNCg0KICAgICAgICAgICAgd29yZHNfd3JpdHRlbiA9IHdvcmRzX3dyaXR0ZW4gKyBsZW4od19zcGFjZSkNCg0KICAgICAgICAgICAgaWYgd29yZHNfd3JpdHRlbiA+PSBjaGFyc19sZWZ0Og0KICAgICAgICAgICAgICAgICNwcmludCgibGluZV95Ont9Ii5mb3JtYXQobGluZV95KSkNCiAgICAgICAgICAgICAgICB3b3Jkc193cml0dGVuID0gMA0KICAgICAgICAgICAgICAgIGxpbmVfeSA9IGxpbmVfeSArIGludChjb25maWcuQ0ZHX0RJU1BMQVlfTElORV9TUEFDSU5HKQ0KICAgICAgICAgICAgDQogICAgICAgIHNlbGYuZGlzcGxheS5zaG93KCkNCiAgICAgICAgICAgDQoNCg0KICAgIGRlZiBfX2luaXRfXyhzZWxmKToNCiAgICAgICAgIyBDUkVBVEUgQSBESVNQTEFZIElOU1RBTkNFDQogICAgICAgIHNlbGYuZGlzcGxheSA9IG1tYl9kaXNwbGF5Lm1tYl9kaXNwbGF5LmRpc3BsYXlfaW5zdGFuY2VfY3JlYXRvcigpDQoNCiAgICAgICAgaWYgc2VsZi5kaXNwbGF5IGlzIE5vbmU6DQogICAgICAgICAgICBwcmludCgiaW52YWxpZCBkaXNwbGF5IGNvbmZpZyIpDQoNCiAgICAgICAgIA0KICAgICAgICBzZWxmLmRpc3BsYXkuZXJhc2UoKQ0KDQogICAgICAgIHNlbGYubGFzdF9kaXNwbGF5X3NvdXJjZTogaW50ID0gLTENCiAgICAgICAgc2VsZi5sYXN0X2Rpc3BsYXlfY29udGVudCA9ICIuIg0KICAgIA0KICAgIA0KICAgIGRlZiBjbGVhcihzZWxmKToNCiAgICAgICAgc2VsZi5kaXNwbGF5LmVyYXNlKCkNCiAgICAgICAgc2VsZi5zZXRfZnVsbF9yZWZyZXNoKCkNCiAgICANCiAgICBkZWYgc2hvd19tc2coc2VsZiwgX21lc3NhZ2U6IHN0ciA9ICIiKToNCg0KICAgICAgICBpZiBzZWxmLmxhc3RfZGlzcGxheV9zb3VyY2UgIT0gMCBvciBfbWVzc2FnZSAhPSBzZWxmLmxhc3RfZGlzcGxheV9jb250ZW50Og0KICAgICAgICAgICAgc2VsZi5sYXN0X2Rpc3BsYXlfY29udGVudCA9IF9tZXNzYWdlDQoNCiAgICAgICAgICAgIHNlbGYuZGlzcGxheS5lcmFzZSgpDQogICAgICAgICAgICBzZWxmLmRpc3BsYXlfdGV4dCgie30iLmZvcm1hdChfbWVzc2FnZSksIFRydWUsIDAsIDApDQoNCiAgICAgICAgICAgIHNlbGYubGFzdF9kaXNwbGF5X3NvdXJjZSA9IDANCiANCg0KICAgIGRlZiBzaG93X3VybChzZWxmLCBfdXJsOiBzdHIgPSAiIik6DQogICAgICAgIA0KICAgICAgICBzcGxpdHRlZF91cmw6IHN0ciA9ICIiDQogICAgICAgIGluZGV4OiBpbnQgPSAwDQogICAgICAgIHNwbGl0X2FmdGVyX2NoYXJzID0gaW50KChjb25maWcuU0NSX1dJRFRIIC8gY29uZmlnLkNGR19ESVNQTEFZX0NIQVJfV0lEVEgpICogMC45NSkNCiAgICAgICAgZm9yIHcgaW4gX3VybDoNCiAgICAgICAgICAgIGluZGV4ID0gaW5kZXggKyAxDQoNCiAgICAgICAgICAgIHNwbGl0dGVkX3VybCA9IHNwbGl0dGVkX3VybCArIHcNCg0KICAgICAgICAgICAgaWYgaW5kZXggPj0gc3BsaXRfYWZ0ZXJfY2hhcnM6DQogICAgICAgICAgICAgICAgc3BsaXR0ZWRfdXJsID0gc3BsaXR0ZWRfdXJsICsgIiAiDQogICAgICAgICAgICAgICAgaW5kZXggPSAwDQogICAgICAgIA0KICAgICAgICBzZWxmLmRpc3BsYXkuZXJhc2UoKQ0KICAgICAgICBzZWxmLmRpc3BsYXlfdGV4dCgie30iLmZvcm1hdChzcGxpdHRlZF91cmwpLCBUcnVlLCAwLCAwKQ0KICAgICAgICANCiAgICAgICAgDQogICAgZGVmIHNob3dfcmVjaXBlX2luZm9ybWF0aW9uKHNlbGYsIF9uYW1lOnN0ciwgX2Rlc2NyaXB0aW9uOiBzdHIgPSAiIik6DQogICAgICAgIGZ1bGxfcmVmcmVzaCA9IEZhbHNlDQogICAgICAgIGlmIHNlbGYubGFzdF9kaXNwbGF5X3NvdXJjZSAhPSAxOg0KICAgICAgICAgICAgZnVsbF9yZWZyZXNoID0gVHJ1ZQ0KICAgICAgICBzZWxmLmxhc3RfZGlzcGxheV9zb3VyY2UgPSAxDQogICAgICAgIA0KICAgICAgICBmdWxsX3JlZnJlc2ggPSBUcnVlDQogICAgICAgIGlmIGZ1bGxfcmVmcmVzaDoNCiAgICAgICAgICAgIHNlbGYuZGlzcGxheS5lcmFzZSgpDQoNCiAgICAgICAgICAgIHNlbGYuZGlzcGxheV90ZXh0KCJ7fSIuZm9ybWF0KF9uYW1lKSwgVHJ1ZSwgMCwgNykNCiAgICAgICAgICAgIHNlbGYuZGlzcGxheV90ZXh0KCJ7fSIuZm9ybWF0KF9kZXNjcmlwdGlvbiksIFRydWUsIDAsIDM1KQ0KICAgICAgICAgIA0KICAgIA0KICAgIA0KICAgIGRlZiBzZXRfZnVsbF9yZWZyZXNoKHNlbGYpOg0KICAgICAgICBzZWxmLmxhc3RfZGlzcGxheV9zb3VyY2UgPSAtMQ0KICAgICAgICANCiAgICAgDQogICAgZGVmIHNob3dfcmVjaXBlX3N0ZXAoc2VsZiwgX2FjdGlvbjogc3RyLCBfaW5ncmVkaWVudDogc3RyKToNCiAgICAgICAgZnVsbF9yZWZyZXNoID0gRmFsc2UNCiAgICAgICAgaWYgc2VsZi5sYXN0X2Rpc3BsYXlfc291cmNlICE9IDI6DQogICAgICAgICAgICBmdWxsX3JlZnJlc2ggPSBUcnVlDQogICAgICAgIHNlbGYubGFzdF9kaXNwbGF5X3NvdXJjZSA9IDINCg0KICAgICAgICBmdWxsX3JlZnJlc2ggPSBUcnVlDQogICAgICAgIGlmIGZ1bGxfcmVmcmVzaDoNCiAgICAgICAgICAgIHNlbGYuZGlzcGxheS5lcmFzZSgpDQoNCiAgICAgICAgICAgIHNlbGYuZGlzcGxheV90ZXh0KCJ7fSIuZm9ybWF0KF9hY3Rpb24pLCBUcnVlLCAwLCA3KQ0KICAgICAgICAgICANCiAgICAgICAgICAgIHNlbGYuZGlzcGxheV90ZXh0KCJ7fSIuZm9ybWF0KF9pbmdyZWRpZW50KSwgVHJ1ZSwgMCwgMzUpICAgIA0KICAgICAgICAgICAgIyBTSE9XIFNURVBTDQogICAgICAgICAgICAjc2VsZi5kaXNwbGF5X3RleHQoInt9IC8ge30iLmZvcm1hdChfY3VycmVudF9zdGVwLCBfbWF4X3N0ZXBzKSwgVHJ1ZSwgMzcsIDkwKQ0KDQoNCiAgICAgICAgICAgICANCiAgICAgICAgIA0KICAgICAgICANCiAgICAgICAgICAgICAgDQogICAgICAgIA0KICAgIGRlZiBzaG93X3RpdGxlc2NyZWVuKHNlbGYpOg0KICAgICAgICBmdWxsX3JlZnJlc2ggPSBGYWxzZQ0KICAgICAgICBpZiBzZWxmLmxhc3RfZGlzcGxheV9zb3VyY2UgIT0gMzoNCiAgICAgICAgICAgIGZ1bGxfcmVmcmVzaCA9IFRydWUNCiAgICAgICAgc2VsZi5sYXN0X2Rpc3BsYXlfc291cmNlID0gMw0KICAgICAgICANCiAgICAgICAgZnVsbF9yZWZyZXNoID0gVHJ1ZQ0KICAgICAgICBpZiBmdWxsX3JlZnJlc2g6DQogICAgICAgICAgICBzZWxmLmRpc3BsYXkuZXJhc2UoKQ0KICAgICAgICAgICAgc2VsZi5kaXNwbGF5X3RleHQoIk1JWCIsIFRydWUsIDI1LCAxMCkNCiAgICAgICAgICAgIHNlbGYuZGlzcGxheV90ZXh0KCJNRUFTVVJFIiwgVHJ1ZSwgMjUsIDMwKQ0KICAgICAgICAgICAgc2VsZi5kaXNwbGF5X3RleHQoIkJVRERZIiwgVHJ1ZSwgMjUsIDUwKQ0KICAgICAgICAgICAgc2VsZi5kaXNwbGF5X3RleHQoInt9Ii5mb3JtYXQoaGVscGVyLmdldF9zeXN0ZW1faWQoKSksIFRydWUsIDcsIDcwKQ0KICAgIA0KICAgIA0KICAgIGRlZiBzaG93X3JlY2lwZV9pbmdyZWRpZW50cyhzZWxmLCBfaW5ncmVkaWVudHM6IGxpc3Rbc3RyXSwgX2ZvcmNlX3JlZnJlc2g6IGJvb2wgPSBUcnVlKToNCiAgICAgICAgZnVsbF9yZWZyZXNoID0gRmFsc2UNCiAgICAgICAgaWYgc2VsZi5sYXN0X2Rpc3BsYXlfc291cmNlICE9IDQgb3IgX2ZvcmNlX3JlZnJlc2g6DQogICAgICAgICAgICBmdWxsX3JlZnJlc2ggPSBUcnVlDQogICAgICAgIHNlbGYubGFzdF9kaXNwbGF5X3NvdXJjZSA9IDQNCiAgICAgICAgDQogICAgICAgIGZ1bGxfcmVmcmVzaCA9IFRydWUNCiAgICAgICAgaWYgZnVsbF9yZWZyZXNoOg0KICAgICAgICAgICAgc2VsZi5kaXNwbGF5LmVyYXNlKCkNCiAgICAgICAgICAgIHNlbGYuZGlzcGxheV90ZXh0KCJJbmdyZWRpZW50cyIsIFRydWUsIDAsIDcpDQogDQogICAgICAgIHRleHQgPSAiIg0KICAgICAgICBmb3IgaXRlbSBpbiBfaW5ncmVkaWVudHM6DQogICAgICAgICAgICB0ZXh0ID0gdGV4dCArICJ7fVxuIi5mb3JtYXQoaXRlbSkNCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgIHNlbGYuZGlzcGxheV90ZXh0KHRleHQsIFRydWUsIDAsIDMwKQ0KDQogICAgDQogICAgICANCiAgICBkZWYgc2hvd19zY2FsZShzZWxmLCBfdmFsdWU6IGludCk6DQogICAgICAgIF92YWx1ZSA9IGludChfdmFsdWUpDQogICAgICAgIGZ1bGxfcmVmcmVzaCA9IEZhbHNlDQogICAgICAgIGlmIHNlbGYubGFzdF9kaXNwbGF5X3NvdXJjZSAhPSA1Og0KICAgICAgICAgICAgZnVsbF9yZWZyZXNoID0gVHJ1ZQ0KICAgICAgICBzZWxmLmxhc3RfZGlzcGxheV9zb3VyY2UgPSA1DQogICAgICAgIA0KICAgICAgICBmdWxsX3JlZnJlc2ggPSBUcnVlDQogICAgICAgIGlmIGZ1bGxfcmVmcmVzaDoNCiAgICAgICAgICAgIHNlbGYuZGlzcGxheS5lcmFzZSgpDQogICAgICAgICAgICBzZWxmLmRpc3BsYXlfdGV4dCgiU0NBTEUgTU9ERSIsIFRydWUsIDAsIDcpDQogICAgICAgIA0KICAgICAgICBzZWxmLmRpc3BsYXlfcmVjdCgyNSw1MCwgMTAwLCA2MCkNCiAgICAgICAgc2VsZi5kaXNwbGF5X3RleHQoIns6MDRkfWciLmZvcm1hdChfdmFsdWUpLCBUcnVlLCAyNSwgNTApDQogICAgDQoNCiAgICBkZWYgc2hvd19kZXZpY2VfcXJfY29kZShzZWxmLCBfdXJsOnN0ciA9ICIiLCBfb2Zmc2V0X3g6aW50ID0gMCwgX29mZnNldF95OmludCA9IDApOg0KICAgICAgICBmdWxsX3JlZnJlc2ggPSBGYWxzZQ0KICAgICAgICBpZiBzZWxmLmxhc3RfZGlzcGxheV9zb3VyY2UgIT0gNjoNCiAgICAgICAgICAgIGZ1bGxfcmVmcmVzaCA9IFRydWUNCiAgICAgICAgc2VsZi5sYXN0X2Rpc3BsYXlfc291cmNlID0gNg0KICAgICAgICANCiAgICAgICAgZnVsbF9yZWZyZXNoID0gVHJ1ZQ0KICAgICAgICBpZiBmdWxsX3JlZnJlc2g6DQogICAgICAgICAgICBzZWxmLmRpc3BsYXkuZXJhc2UoKQ0KICAgICAgICAgICAgDQogICAgICAgICAgICBxciA9IHVRUi5RUkNvZGUoKQ0KICAgICAgICAgICAgaWYgX3VybCA9PSAiIjoNCiAgICAgICAgICAgICAgICBxci5hZGRfZGF0YSgie30iLmZvcm1hdChoZWxwZXIuZ2V0X3N5c3RlbV9pZCgpKSkNCiAgICAgICAgICAgIGVsc2U6DQogICAgICAgICAgICAgICAgcXIuYWRkX2RhdGEoInt9Ii5mb3JtYXQoX3VybCkpDQogICAgICAgICAgICBtYXRyaXggPSBxci5nZXRfbWF0cml4KCkNCiAgICAgICAgICAgIGZvciB5IGluIHJhbmdlKGxlbihtYXRyaXgpKjIpOiAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICBmb3IgeCBpbiByYW5nZShsZW4obWF0cml4WzBdKSoyKTogICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBub3QgbWF0cml4W2ludCh5LzIpXVtpbnQoeC8yKV0gICANCiAgICAgICAgICAgICAgICAgICAgc2VsZi5waXhlbCh4ICsgX29mZnNldF94LCB5ICsgX29mZnNldF95LCB2YWx1ZSkNCiAgICAgICAgc2VsZi5zaG93KCkgIA0KDQo=", "recipe_editor.py": "aW1wb3J0IGNvbmZpZwppbXBvcnQgc2V0dGluZ3MKaW1wb3J0IHRpbWUKaW1wb3J0IGhlbHBlcgppbXBvcnQganNvbgppbXBvcnQgcmVjaXBlX2xvYWRlcgoKCnRyeToKICAgIGltcG9ydCBuZXR3b3JrCiAgICBpbXBvcnQgbWljcm9weXNlcnZlcgoKICAgIGNsYXNzIHJlY2lwZV9lZGl0b3I6CiAgICAgICAgCgogICAgICAgIHNlcnZlcjogbWljcm9weXNlcnZlci5NaWNyb1B5U2VydmVyID0gbWljcm9weXNlcnZlci5NaWNyb1B5U2VydmVyKHBvcnQ9Y29uZmlnLkNGR19FRElUT1JfSFRUUF9QT1JUKQogICAgICAgIAogICAgICAgIGRlZiBzZXJ2ZV9pbmRleChzZWxmLCByZXF1ZXN0KToKICAgICAgICAgICAgc2VsZi5zZXJ2ZXIuc2VuZCgiVEhJUyBJUyBJTkRFWCBQQUdFISIpCgogICAgICAgIGRlZiBzZXJ2ZV9yZWNpcGUoc2VsZiwgcmVxdWVzdCk6CiAgICAgICAgICAgIHBhcmFtcyA9IG1pY3JvcHlzZXJ2ZXIuZ2V0X3JlcXVlc3RfcXVlcnlfcGFyYW1zKHJlcXVlc3QpCQogICAgICAgICAgICBqc29uX3JlcHNvbnNlOiBkaWN0ID0ge30KICAgICAgICAgICAgaWYgJ2ZpbGVuYW1lJyBpbiBwYXJhbXM6CiAgICAgICAgICAgICAgICBqc29uX3JlcHNvbnNlID0gcmVjaXBlX2xvYWRlci5yZWNpcGVfbG9hZGVyLmdldF9yZWNpcGVfZmlsZV9jb250ZW50KHBhcmFtc1snZmlsZW5hbWUnXSkKICAgICAgICAgICAgCiAgICAgICAgICAgIAogICAgICAgICAgICBzZWxmLnNlcnZlci5zZW5kKCJIVFRQLzEuMCAyMDAgT0tcclxuIikKICAgICAgICAgICAgc2VsZi5zZXJ2ZXIuc2VuZCgiQ29udGVudC1UeXBlOiBhcHBsaWNhdGlvbi9qc29uXHJcblxyXG4iKQogICAgICAgICAgICBzZWxmLnNlcnZlci5zZW5kKGpzb24uZHVtcHMoanNvbl9yZXBzb25zZSkpCgogICAgICAgIGRlZiBzZXJ2ZV9yZWNpcGVzKHNlbGYsIHJlcXVlc3QpOgogICAgICAgICAgICBqc29uX3JlcHNvbnNlOiBkaWN0ID0ge30KICAgICAgICAgICAgCgogICAgICAgICAgICBmb3IgciBpbiByZWNpcGVfbG9hZGVyLnJlY2lwZV9sb2FkZXIoKS5saXN0X3JlY3BpZXMoX2luY2x1ZGVfZGVzY3JpcHRpb249VHJ1ZSk6CiAgICAgICAgICAgICAgICBmaWxlbmFtZSwgbmFtZSwgZGVzY3JpcHRpb24gPSByCiAgICAgICAgICAgICAgICBsaW5rOiBzdHIgPSAiL3JlY2lwZT9maWxlbmFtZT17fSIuZm9ybWF0KGZpbGVuYW1lKQogICAgICAgICAgICAgICAganNvbl9yZXBzb25zZVtmaWxlbmFtZV0gPSB7Im5hbWUiOiBuYW1lLCAiZGVzY3JpcHRpb24iOiBkZXNjcmlwdGlvbiwgImxpbmsiOiBsaW5rfQoKICAgICAgICAgICAgc2VsZi5zZXJ2ZXIuc2VuZCgiSFRUUC8xLjAgMjAwIE9LXHJcbiIpCiAgICAgICAgICAgIHNlbGYuc2VydmVyLnNlbmQoIkNvbnRlbnQtVHlwZTogYXBwbGljYXRpb24vanNvblxyXG5cclxuIikKICAgICAgICAgICAgc2VsZi5zZXJ2ZXIuc2VuZChqc29uLmR1bXBzKGpzb25fcmVwc29uc2UpKQoKCiAgICAgICAgZGVmIF9faW5pdF9fKCk6CiAgICAgICAgICAgIHBhc3MKICAgICAgICAKCiAgICAgICAgZGVmIGhhc19jYXBhYmlsaXRpZXMoc2VsZikgLT4gYm9vbDoKICAgICAgICAgICAgcmV0dXJuIFRydWUKICAgICAgICAKICAgICAgICBkZWYgZGlzYWJsZV93aWZpKHNlbGYpOgogICAgICAgICAgICB3bGFuID0gbmV0d29yay5XTEFOKG5ldHdvcmsuU1RBX0lGKQogICAgICAgICAgICB3bGFuLmFjdGl2ZShGYWxzZSkKICAgICAgICAKCiAgICAgICAgZGVmIHNldHVwX3dlYnNlcnZlcihzZWxmKToKICAgICAgICAgICAgCiAgICAgICAgICAgICMgQUREIFJPVVRFUwogICAgICAgICAgICBzZWxmLnNlcnZlci5hZGRfcm91dGUoIi8iLCBzZWxmLnNlcnZlX2luZGV4KQogICAgICAgICAgICBzZWxmLnNlcnZlci5hZGRfcm91dGUoIi9pbmRleCIsIHNlbGYuc2VydmVfaW5kZXgpCiAgICAgICAgICAgIHNlbGYuc2VydmVyLm9uX25vdF9mb3VuZChzZWxmLnNlcnZlX2luZGV4KSAjIDQwNAoKICAgICAgICAgICAgc2VsZi5zZXJ2ZXIuYWRkX3JvdXRlKCIvcmVjaXBlIiwgc2VsZi5zZXJ2ZV9yZWNpcGUpCiAgICAgICAgICAgIHNlbGYuc2VydmVyLmFkZF9yb3V0ZSgiL3JlY2lwZXMiLCBzZWxmLnNlcnZlX3JlY2lwZXMpCgoKICAgICAgICAgICAgc2VsZi5zZXJ2ZXIubG9vcF9pbml0KCkKCiAgICAgICAgZGVmIHN0b3Bfd2Vic2VydmVyKHNlbGYpOgogICAgICAgICAgICBzZWxmLnNlcnZlci5zdG9wKCkKCiAgICAgICAgZGVmIGhhbmRsZV9jb25uZWN0aW9uKHNlbGYpOgogICAgICAgICAgICBzZWxmLnNlcnZlci5sb29wKCkKICAgCgogICAgICAgIGRlZiBvcGVuX2FjY2Vzc3BvaW50KHNlbGYsIF9zc2lkOiBzdHIsIF9wc2s6IHN0ciA9IE5vbmUpIC0+IHN0cjoKCiAgICAgICAgICAgIG5ldHdvcmsuY291bnRyeShjb25maWcuQ0ZHX05FVFdPUktfV0lGSUNPVU5UUlkpCiAgICAgICAgICAgIG5ldHdvcmsuaG9zdG5hbWUoY29uZmlnLkNGR19FRElUT1JfV0lGSV9TVEFfSE9TVE5BTUUuZm9ybWF0KCJfIiArIGhlbHBlci5nZXRfc3lzdGVtX2lkKCkpKQoKICAgICAgICAgICAgd2xhbiA9IG5ldHdvcmsuV0xBTihuZXR3b3JrLlNUQV9JRikKICAgICAgICAgICAgd2xhbi5hY3RpdmUoVHJ1ZSkKICAgICAgICAgICAgd2xhbi5jb25maWcoZXNzaWQ9X3NzaWQsIHBhc3N3b3JkPV9wc2spCiAgICAgICAgICAgIAogICAgICAgICAgIAogICAgICAgICAgICByZXR1cm4gd2xhbi5pZmNvbmZpZygpCiAgICAgICAgCgoKICAgICAgCiAgICAgICAgCgpleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgCiAgICBjbGFzcyByZWNpcGVfZWRpdG9yOgogICAgICAgIAogICAgICAgIGRlZiBfX2luaXRfXygpOgogICAgICAgICAgICBwYXNzCgogICAgICAgIGRlZiBoYXNfY2FwYWJpbGl0aWVzKHNlbGYpIC0+IGJvb2w6CiAgICAgICAgICAgIHJldHVybiBGYWxzZQoKICAgICAgICBkZWYgZGlzYWJsZV93aWZpKHNlbGYpOgogICAgICAgICAgICBwYXNzCiAgICAgICAgCiAgICAgICAgZGVmIHNldHVwX3dlYnNlcnZlcihzZWxmKToKICAgICAgICAgICAgcGFzcwogICAgICAgIAogICAgICAgIGRlZiBzdG9wX3dlYnNlcnZlcihzZWxmKToKICAgICAgICAgICAgcGFzcwoKICAgICAgICBkZWYgaGFuZGxlX2Nvbm5lY3Rpb24oc2VsZik6CiAgICAgICAgICAgIHBhc3MKCiAgICAgICAgZGVmIG9wZW5fYWNjZXNzcG9pbnQoc2VsZiwgX3NzaWQ6IHN0ciwgX3Bzazogc3RyID0gTm9uZSkgLT4gc3RyOgogICAgICAgICAgICByZXR1cm4gIiI=", "menu_entry_recipe_update.py": "ZnJvbSBhYmMgaW1wb3J0IGFic3RyYWN0bWV0aG9kCmltcG9ydCBtZW51X2VudHJ5CmltcG9ydCBzeXN0ZW1fY29tbWFuZApmcm9tIHVpIGltcG9ydCB1aQpmcm9tIGxlZHJpbmcgaW1wb3J0IGxlZHJpbmcKZnJvbSByZWNpcGVfdXBkYXRlciBpbXBvcnQgcmVjaXBlX3VwZGF0ZXIKZnJvbSBzdGF0aWNfbW9kdWxlcy5tZW51X21hbmFnZXIgaW1wb3J0IG1lbnVfbWFuYWdlcgppbXBvcnQgdGltZQpjbGFzcyBtZW51X2VudHJ5X3JlY2lwZV91cGRhdGUobWVudV9lbnRyeS5tZW51X2VudHJ5KToKCgogICAgdXBkYXRlX29rOiBib29sID0gRmFsc2UKCiAgICBkZWYgX19pbml0X18oc2VsZik6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXygiUkVDSVBFIFVQREFURSIsICJVcGRhdGUgcmVjaXBlcyBvdmVyIE1peE1lYXN1cmVCdWRkeSBBUEkiKQoKICAgIGRlZiBwcmV2aWV3KHNlbGYpOgogICAgICAgIHByaW50KCJwcmV2aWV3IHt9Ii5mb3JtYXQoc2VsZi5uYW1lKSkKICAgICAgICB1aSgpLnNob3dfcmVjaXBlX2luZm9ybWF0aW9uKHNlbGYubmFtZSwgc2VsZi5kZXNjcmlwdGlvbikKCgogICAgZGVmIGFjdGl2YXRlKHNlbGYpOgogICAgICAgIHNlbGYudXBkYXRlX29rID0gRmFsc2UKICAgICAgICAKICAgICAgICBwcmludCgiYWN0aXZhdGUge30iLmZvcm1hdChzZWxmLm5hbWUpKQogICAgICAgIHRyeToKICAgICAgICAgICAgdWkoKS5zaG93X21zZygiQ0hFQ0sgRk9SIFdJRkkgQ09OTkVDVElPTiIpCiAgICAgICAgICAgIGlmIHJlY2lwZV91cGRhdGVyLmNoZWNrX3VwZGF0ZV91cmwoKToKICAgICAgICAgICAgICAgIHVpKCkuc2hvd19tc2coIldJRkkgU1VDQ0VTUyIpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICB1aSgpLnNob3dfbXNnKCJFUlJPUjogQ0hFQ0sgQ1JFREVOVElBTFMiKQogICAgICAgICAgICAgICAgdGltZS5zbGVlcCgyKQogICAgICAgICAgICAgICAgbWVudV9tYW5hZ2VyKCkuZXhpdF9jdXJyZW50X21lbnUoKQoKICAgICAgICAgICAgdWkoKS5zaG93X21zZygiUkVDSVBFIEZFVENISU5HIFNUQVJURUQiKQogICAgICAgICAgICBzZWxmLnVwZGF0ZV9vayA9IHJlY2lwZV91cGRhdGVyLnVwZGF0ZV9yZWNpcGVzKCkKICAgICAgICAgICAgaWYgc2VsZi51cGRhdGVfb2s6CiAgICAgICAgICAgICAgICB1aSgpLnNob3dfcmVjaXBlX2luZm9ybWF0aW9uKCJQTEVBU0UgUE9XRVJDWUNMRSBUSEUgREVWSUNFIiwgIlByZXNzIE5FWFQvUFJFViB0byBzaG93IFFSIENvZGUgb3IgVVJMIikKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHVpKCkuc2hvd19yZWNpcGVfaW5mb3JtYXRpb24oIlVQREFURSBGQUlMRUQiLCAiUHJlc3MgTkVYVC9QUkVWIHRvIHNob3cgUVIgQ29kZSBvciBVUkwiKQoKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIHByaW50KGUpCiAgICAgICAgICAgIHVpKCkuc2hvd19tc2coIkVSUk9SOiBVUERBVEUgRVJST1IiKQogICAgICAgICAgICB0aW1lLnNsZWVwKDIpCiAgICAgICAgICAgIG1lbnVfbWFuYWdlcigpLmV4aXRfY3VycmVudF9tZW51KCkKCgogICAgICAgIAoKICAgIGRlZiB0ZWFyZG93bihzZWxmKToKICAgICAgICBwcmludCgidGVhcmRvd24ge30iLmZvcm1hdChzZWxmLm5hbWUpKQogICAgICAgIHRyeToKICAgICAgICAgICAgcmVjaXBlX3VwZGF0ZXIuZGlzYWJsZV93aWZpKCkKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIHByaW50KGUpCgoKCiAgICBkZWYgdXBkYXRlKHNlbGYsIF9zeXN0ZW1fY29tbWFuZDogc3lzdGVtX2NvbW1hbmQuc3lzdGVtX2NvbW1hbmQpOgogICAgICAgIGlmIF9zeXN0ZW1fY29tbWFuZC50eXBlID09IHN5c3RlbV9jb21tYW5kLnN5c3RlbV9jb21tYW5kLkNPTU1BTkRfVFlQRV9OQVZJR0FUSU9OOgogICAgICAgICAgICAjIFVQREFURSBET0VTIE5PVEhJTkcgRVhDRVBUIEdPSU5HIEJBQ0sgVE8gTUFJTiBNRU5VCiAgICAgICAgICAgIGlmIG5vdCBzZWxmLnVwZGF0ZV9vazoKICAgICAgICAgICAgICAgIG1lbnVfbWFuYWdlcigpLmV4aXRfY3VycmVudF9tZW51KCkKICAgICAgICBpZiBfc3lzdGVtX2NvbW1hbmQudHlwZSA9PSBzeXN0ZW1fY29tbWFuZC5zeXN0ZW1fY29tbWFuZC5DT01NQU5EX1RZUEVfTkFWSUdBVElPTjoKICAgICAgICAgICAgaWYgX3N5c3RlbV9jb21tYW5kLmFjdGlvbiA9PSBzeXN0ZW1fY29tbWFuZC5zeXN0ZW1fY29tbWFuZC5OQVZJR0FUSU9OX0VOVEVSOgogICAgICAgICAgICAgICAgbWVudV9tYW5hZ2VyKCkuZXhpdF9jdXJyZW50X21lbnUoKQogICAgICAgICAgICBlbGlmIF9zeXN0ZW1fY29tbWFuZC5hY3Rpb24gPT0gc3lzdGVtX2NvbW1hbmQuc3lzdGVtX2NvbW1hbmQuTkFWSUdBVElPTl9MRUZUOgogICAgICAgICAgICAgICAgdWkoKS5zaG93X2RldmljZV9xcl9jb2RlKHJlY2lwZV91cGRhdGVyLmdldF9hcGlfdXJsKCkpCiAgICAgICAgICAgIGVsaWYgX3N5c3RlbV9jb21tYW5kLmFjdGlvbiA9PSBzeXN0ZW1fY29tbWFuZC5zeXN0ZW1fY29tbWFuZC5OQVZJR0FUSU9OX1JJR0hUOgogICAgICAgICAgICAgICAgdWkoKS5zaG93X3VybChyZWNpcGVfdXBkYXRlci5nZXRfYXBpX3VybCgpKQ==", "menu_entry_recipe.py": "ZnJvbSBhYmMgaW1wb3J0IGFic3RyYWN0bWV0aG9kCmltcG9ydCBtZW51X2VudHJ5CmltcG9ydCBzeXN0ZW1fY29tbWFuZApmcm9tIHVpIGltcG9ydCB1aQpmcm9tIGxlZHJpbmcgaW1wb3J0IGxlZHJpbmcKZnJvbSBzdGF0aWNfbW9kdWxlcy5tZW51X21hbmFnZXIgaW1wb3J0IG1lbnVfbWFuYWdlcgppbXBvcnQgcmVjaXBlX2xvYWRlcgppbXBvcnQgcmVjaXBlCmltcG9ydCB0aW1lCmZyb20gU2NhbGVzIGltcG9ydCBTY2FsZUludGVyZmFjZQppbXBvcnQgY29uZmlnCgpjbGFzcyBtZW51X2VudHJ5X3JlY2lwZShtZW51X2VudHJ5Lm1lbnVfZW50cnkpOgogICAgUkVDSVBFX1NUQVRFX0lOSVQgPSAwCiAgICBSRUNJUEVfU1RBVEVfT1ZFUlZJRVcgPSAxCiAgICBSRUNJUEVTX1NUQVRFX0RSSU5LX01VTFRJUExJRVIgPSAyCiAgICBSRUNJUEVfU1RBVEVfSU5JVElBTF9UQVJFID0gMwogICAgUkVDSVBFX1JVTk5JTkdfSU5JVCA9IDQKICAgIFJFQ0lQRV9SVU5OSU5HX0dFVF9DVVJSRU5UX1NURVAgPSA1CiAgICBSRUNJUEVfUlVOTklOR19HRVRfTkVYVF9TVEVQID0gNgogICAgUkVDSVBFX1JVTk5JTkcgPSA3CiAgICBSRUNJUEVfRU5EX0NIRUNLID0gOAogICAgUkVDSVBFX0VORCA9IDkKCgogICAKICAgIHJlY2lwZV9maWxlbmFtZTogc3RyID0gIiIKICAgIGxvYWRlZF9yZWNpcGU6IHJlY2lwZS5yZWNpcGUgPSBOb25lCiAgICBsYXN0X3NjYWxlX3ZhbHVlOiBmbG9hdCA9IDAuMAogICAgbGFzdF90aW1lX3ZhbHVlIDogZmxvYXQgPSAwLjAKICAgIHJlY2lwZV9zdGF0ZTogaW50ID0gUkVDSVBFX1NUQVRFX09WRVJWSUVXCiAgICBjdXJyZW50X3JlY2lwZV9zdGVwOiByZWNpcGUucmVjaXBlX3N0ZXAgPSBOb25lCiAgICBpc19lbmRfc3RlcDogYm9vbCA9IEZhbHNlCiAgICBkcmlua19tdWx0aXBsaWVyOiBpbnQgPSAxCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIF9yZWNpcGVfZmlsZW5hbWU6IHN0ciwgX3JlY2lwZV9uYW1lOiBzdHIsIF9yZWNpcGVfZGVzY2lwdGlvbjogc3RyKToKICAgICAgICBzdXBlcigpLl9faW5pdF9fKF9yZWNpcGVfbmFtZSwgX3JlY2lwZV9kZXNjaXB0aW9uKQogICAgICAgIHNlbGYucmVjaXBlX2ZpbGVuYW1lID0gX3JlY2lwZV9maWxlbmFtZQoKICAgIGRlZiBwcmV2aWV3KHNlbGYpOgogICAgICAgIHByaW50KCJwcmV2aWV3IGN7fSIuZm9ybWF0KHNlbGYubmFtZSkpCiAgICAgICAgdWkoKS5zaG93X3JlY2lwZV9pbmZvcm1hdGlvbihzZWxmLm5hbWUsIHNlbGYuZGVzY3JpcHRpb24pCgoKICAgIGRlZiBhY3RpdmF0ZShzZWxmKToKICAgICAgICBwcmludCgiYWN0aXZhdGUge30iLmZvcm1hdChzZWxmLm5hbWUpKQogICAgICAgIHVpKCkuY2xlYXIoKQogICAgICAgICMgTE9BRCBSRUNJUEUKICAgICAgICBpZiBsZW4oc2VsZi5yZWNpcGVfZmlsZW5hbWUpIDw9IDA6CiAgICAgICAgICAgIHVpKCkuc2hvd19tc2coIlJlY2lwZSBmaWxlbmFtZSBlbXB0eS4gUGxlYXNlIGNoZWNrIGZpbGUiKQogICAgICAgICAgICB0aW1lLnNsZWVwKDIpCiAgICAgICAgICAgIG1lbnVfbWFuYWdlci5leGl0X2N1cnJlbnRfbWVudSgpCiAgICAgICAgICAgIHJldHVybgogICAgICAgIAogICAgICAgIHNlbGYubG9hZGVkX3JlY2lwZSA9IHJlY2lwZV9sb2FkZXIucmVjaXBlX2xvYWRlcigpLmdldF9yZWNpcGVfYnlfZmlsZW5hbWUoc2VsZi5yZWNpcGVfZmlsZW5hbWUpCgogICAgICAgIGlmIHNlbGYubG9hZGVkX3JlY2lwZSBpcyBOb25lIG9yIG5vdCBzZWxmLmxvYWRlZF9yZWNpcGUuaXNfdmFsaWQoKToKICAgICAgICAgICAgdWkoKS5zaG93X21zZygiUmVjaXBlIGxvYWRpbmcgZmFpbGVkLiBQbGVhc2UgY2hlY2sgZmlsZSBzdHJ1Y3R1cmUiKQogICAgICAgICAgICB0aW1lLnNsZWVwKDIpCiAgICAgICAgICAgIG1lbnVfbWFuYWdlci5leGl0X2N1cnJlbnRfbWVudSgpCiAgICAgICAgICAgIHJldHVybgoKCgogICAgICAgICMgU0hPVyBSRUNJUEUgT1ZFUlZJRVcgUEFHRQogICAgICAgIHNlbGYucmVjaXBlX3N0YXRlID0gc2VsZi5SRUNJUEVfU1RBVEVfSU5JVAogICAgICAgIHVpKCkuc2hvd19yZWNpcGVfaW5ncmVkaWVudHMoc2VsZi5sb2FkZWRfcmVjaXBlLmdldF9pbmdyZWRpZW50c19hc19uYW1lc19saXN0KCksIFRydWUpCgogICAgICAgICMgVEFSRSBTQ0FMRQogICAgICAgIFNjYWxlSW50ZXJmYWNlKCkudGFyZSgpCgogICAgICAgICMgUkVTRVQgUkVDSVBFCiAgICAgICAgc2VsZi5sb2FkZWRfcmVjaXBlLnJlc2V0X3N0ZXBzKCkKCiAgICBkZWYgdGVhcmRvd24oc2VsZik6CiAgICAgICAgcHJpbnQoInRlYXJkb3duIHt9Ii5mb3JtYXQoc2VsZi5uYW1lKSkKICAgICAgICAjIFVOTE9BRCBSRUNJUEUKICAgICAgICBpZiBzZWxmLmxvYWRlZF9yZWNpcGUgaXMgbm90IE5vbmU6CiAgICAgICAgICAgIGRlbCBzZWxmLmxvYWRlZF9yZWNpcGUKICAgICAgICAgICAgc2VsZi5sb2FkZWRfcmVjaXBlID0gTm9uZQoKCiAgICBkZWYgdGFyZV9zY2FsZShzZWxmKToKICAgICAgICAgICAgU2NhbGVJbnRlcmZhY2UoKS50YXJlKCkKICAgICAgICAgICAgdGltZS5zbGVlcCgxKQogICAgICAgICAgICBTY2FsZUludGVyZmFjZSgpLnRhcmUoKQogICAgICAgICAgICBzZWxmLmxhc3RfdGltZV92YWx1ZSA9IDAuMAoKCiAgICBkZWYgdXBkYXRlKHNlbGYsIF9zeXN0ZW1fY29tbWFuZDogc3lzdGVtX2NvbW1hbmQuc3lzdGVtX2NvbW1hbmQpOgogICAgICAgIGlmIHNlbGYubG9hZGVkX3JlY2lwZSBpcyBOb25lOgogICAgICAgICAgICBtZW51X21hbmFnZXIuZXhpdF9jdXJyZW50X21lbnUoKQoKICAgICAgICAjIDFzdCBXQUlUIEZPUiBJTklUSUFMIFNDQUxFIFZBTFVFCiAgICAgICAgaWYgc2VsZi5yZWNpcGVfc3RhdGUgPT0gc2VsZi5SRUNJUEVfU1RBVEVfSU5JVCBhbmQgX3N5c3RlbV9jb21tYW5kLnR5cGUgPT0gc3lzdGVtX2NvbW1hbmQuc3lzdGVtX2NvbW1hbmQuQ09NTUFORF9UWVBFX1NDQUxFX1ZBTFVFOgogICAgICAgICAgICBzZWxmLmxhc3Rfc2NhbGVfdmFsdWUgPSBfc3lzdGVtX2NvbW1hbmQudmFsdWUKICAgICAgICAgICAgc2VsZi5yZWNpcGVfc3RhdGUgPSBzZWxmLlJFQ0lQRV9TVEFURV9PVkVSVklFVwogICAgICAgICAgICAKICAgICAgICAjIElGIFVTRVIgSVMgSU4gT1ZFUlZJRVcgU0NSRUVOIFNXSVRDSCBUTyBGSVJTVCBSRUNJUEUgU1RFUCBJRiBVU0VSIFBSRVNTRUQgT0sKICAgICAgICBlbGlmIHNlbGYucmVjaXBlX3N0YXRlID09IHNlbGYuUkVDSVBFX1NUQVRFX09WRVJWSUVXOgogICAgICAgICAgICBpZiBfc3lzdGVtX2NvbW1hbmQudHlwZSA9PSBzeXN0ZW1fY29tbWFuZC5zeXN0ZW1fY29tbWFuZC5DT01NQU5EX1RZUEVfTkFWSUdBVElPTjoKICAgICAgICAgICAgICAgIHVpKCkuc2hvd19yZWNpcGVfaW5ncmVkaWVudHMoIkRSSU5LIFFVQU5USVRZIiwie314Ii5mb3JtYXQoc2VsZi5kcmlua19tdWx0aXBsaWVyKSkKICAgICAgICAgICAgICAgIHNlbGYucmVjaXBlX3N0YXRlID0gc2VsZi5SRUNJUEVTX1NUQVRFX0RSSU5LX01VTFRJUExJRVIKICAgICAgICAgICAgCiAgICAgICAgICAgIGVsaWYgX3N5c3RlbV9jb21tYW5kLnR5cGUgPT0gc3lzdGVtX2NvbW1hbmQuc3lzdGVtX2NvbW1hbmQuQ09NTUFORF9UWVBFX1NDQUxFX1ZBTFVFOgogICAgICAgICAgICAgICAgc2VsZi5sYXN0X3NjYWxlX3ZhbHVlID0gX3N5c3RlbV9jb21tYW5kLnZhbHVlCgogICAgICAgIGVsaWYgc2VsZi5yZWNpcGVfc3RhdGUgPT0gc2VsZi5SRUNJUEVTX1NUQVRFX0RSSU5LX01VTFRJUExJRVI6CgogICAgICAgICAgICAKICAgICAgICAgICAgaWYgX3N5c3RlbV9jb21tYW5kLnR5cGUgPT0gc3lzdGVtX2NvbW1hbmQuc3lzdGVtX2NvbW1hbmQuQ09NTUFORF9UWVBFX05BVklHQVRJT046CiAgICAgICAgICAgICAgICBpZiBfc3lzdGVtX2NvbW1hbmQuYWN0aW9uID09IHN5c3RlbV9jb21tYW5kLnN5c3RlbV9jb21tYW5kLk5BVklHQVRJT05fRU5URVI6CiAgICAgICAgICAgICAgICAgICAgdWkoKS5zaG93X21zZygiUGxlYXNlIHBsYWNlIGdsYXNzIGFuZCBwcmVzcyBvayB0byBiZWdpbiIpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5kcmlua19tdWx0aXBsaWVyID0gbWF4KDEsIHNlbGYuZHJpbmtfbXVsdGlwbGllcikKICAgICAgICAgICAgICAgICAgICBzZWxmLnJlY2lwZV9zdGF0ZSA9IHNlbGYuUkVDSVBFX1NUQVRFX0lOSVRJQUxfVEFSRQoKICAgICAgICAgICAgICAgIGVsaWYgX3N5c3RlbV9jb21tYW5kLnR5cGUgPT0gc3lzdGVtX2NvbW1hbmQuc3lzdGVtX2NvbW1hbmQuQ09NTUFORF9UWVBFX05BVklHQVRJT04gYW5kIF9zeXN0ZW1fY29tbWFuZC5hY3Rpb24gPT0gc3lzdGVtX2NvbW1hbmQuc3lzdGVtX2NvbW1hbmQuTkFWSUdBVElPTl9MRUZUOgogICAgICAgICAgICAgICAgICAgIHNlbGYuZHJpbmtfbXVsdGlwbGllciA9IHNlbGYuZHJpbmtfbXVsdGlwbGllciAtIDEKICAgICAgICAgICAgICAgICAgICBzZWxmLmRyaW5rX211bHRpcGxpZXIgPSBtYXgoMSwgc2VsZi5kcmlua19tdWx0aXBsaWVyKQoKICAgICAgICAgICAgICAgIGVsaWYgX3N5c3RlbV9jb21tYW5kLnR5cGUgPT0gc3lzdGVtX2NvbW1hbmQuc3lzdGVtX2NvbW1hbmQuQ09NTUFORF9UWVBFX05BVklHQVRJT04gYW5kIF9zeXN0ZW1fY29tbWFuZC5hY3Rpb24gPT0gc3lzdGVtX2NvbW1hbmQuc3lzdGVtX2NvbW1hbmQuTkFWSUdBVElPTl9SSUdIVDoKICAgICAgICAgICAgICAgICAgICBzZWxmLmRyaW5rX211bHRpcGxpZXIgPSBzZWxmLmRyaW5rX211bHRpcGxpZXIgKyAxCgogICAgICAgICAgICAgICAgdWkoKS5zaG93X3JlY2lwZV9pbmdyZWRpZW50cygiRFJJTksgUVVBTlRJVFkiLCJ7fXgiLmZvcm1hdChzZWxmLmRyaW5rX211bHRpcGxpZXIpKQogICAgICAgICAgICBlbGlmIF9zeXN0ZW1fY29tbWFuZC50eXBlID09IHN5c3RlbV9jb21tYW5kLnN5c3RlbV9jb21tYW5kLkNPTU1BTkRfVFlQRV9TQ0FMRV9WQUxVRToKICAgICAgICAgICAgICAgIHNlbGYubGFzdF9zY2FsZV92YWx1ZSA9IF9zeXN0ZW1fY29tbWFuZC52YWx1ZQoKICAgICAgICBlbGlmIHNlbGYucmVjaXBlX3N0YXRlID09IHNlbGYuUkVDSVBFX1NUQVRFX0lOSVRJQUxfVEFSRToKICAgICAgICAgICAgIyBVU0VSIFBMQUNFUyBHTEFTUyBBTkQgQ0xJQ0tFRCBBIEJVVFRPTiAKICAgICAgICAgICAgaWYgX3N5c3RlbV9jb21tYW5kLnR5cGUgPT0gc3lzdGVtX2NvbW1hbmQuc3lzdGVtX2NvbW1hbmQuQ09NTUFORF9UWVBFX05BVklHQVRJT046CiAgICAgICAgICAgICAgICBzZWxmLnRhcmVfc2NhbGUoKQogICAgICAgICAgICAgICAgc2VsZi5yZWNpcGVfc3RhdGUgPSBzZWxmLlJFQ0lQRV9SVU5OSU5HX0lOSVQKICAgICAgICAgICAgIyBTWVNURU0gV0FJVFMgRk9SIElOQ1JFQVNJTkcgTE9BRCBPTiBUSEUgU0NBTEUgQU5EIENPTlRJTk9VRVMgQVVUT01BVElDQUxMWQogICAgICAgICAgICBlbGlmIF9zeXN0ZW1fY29tbWFuZC50eXBlID09IHN5c3RlbV9jb21tYW5kLnN5c3RlbV9jb21tYW5kLkNPTU1BTkRfVFlQRV9TQ0FMRV9WQUxVRToKICAgICAgICAgICAgICAgIGlmIF9zeXN0ZW1fY29tbWFuZC52YWx1ZSA+IChzZWxmLmxhc3Rfc2NhbGVfdmFsdWUgKyBjb25maWcuQ0ZHX1NDQUxFX0dMQVNTX0FERElUSU9OX05FWFRfU1RFUF9XRUlHSFQpOgogICAgICAgICAgICAgICAgICAgIHNlbGYudGFyZV9zY2FsZSgpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5yZWNpcGVfc3RhdGUgPSBzZWxmLlJFQ0lQRV9SVU5OSU5HX0lOSVQKCiAgICAgICAgIyBMT0FEIEZJUlNUIFNURVAKICAgICAgICBlbGlmIHNlbGYucmVjaXBlX3N0YXRlID09IHNlbGYuUkVDSVBFX1JVTk5JTkdfSU5JVDoKICAgICAgICAgICAgc2VsZi5sb2FkZWRfcmVjaXBlLnJlc2V0X3N0ZXBzKCkKICAgICAgICAgICAgc2VsZi5yZWNpcGVfc3RhdGUgPSBzZWxmLlJFQ0lQRV9SVU5OSU5HX0dFVF9DVVJSRU5UX1NURVAKCiAgICAgICAgZWxpZiBzZWxmLnJlY2lwZV9zdGF0ZSA9PSBzZWxmLlJFQ0lQRV9SVU5OSU5HX0dFVF9ORVhUX1NURVA6CiAgICAgICAgICAgIHNlbGYubG9hZGVkX3JlY2lwZS5zd2l0Y2hfbmV4dF9zdGVwKCkKICAgICAgICAgICAgcHJpbnQoIlJFQ0lQRV9SVU5OSU5HX0dFVF9ORVhUX1NURVAiKQogICAgICAgICAgICBzZWxmLnJlY2lwZV9zdGF0ZSA9IHNlbGYuUkVDSVBFX1JVTk5JTkdfR0VUX0NVUlJFTlRfU1RFUAoKICAgICAgICBlbGlmIHNlbGYucmVjaXBlX3N0YXRlID09IHNlbGYuUkVDSVBFX1JVTk5JTkdfR0VUX0NVUlJFTlRfU1RFUDoKICAgICAgICAKICAgICAgICAgICAgc2VsZi50YXJlX3NjYWxlKCkKICAgICAgICAgICAgc2VsZi5jdXJyZW50X3JlY2lwZV9zdGVwLCBzZWxmLmlzX2VuZF9zdGVwID0gc2VsZi5sb2FkZWRfcmVjaXBlLmdldF9jdXJyZW50X3JlY2lwZV9zdGVwKCkKICAgICAgICAgICAgCiAgICAgICAgICAgIHNlbGYucmVjaXBlX3N0YXRlID0gc2VsZi5SRUNJUEVfUlVOTklORwoKICAgICAgICAgICAgaWYgc2VsZi5jdXJyZW50X3JlY2lwZV9zdGVwLmFjdGlvbiA9PSByZWNpcGUuVVNFUl9JTlRFUkFDVElPTl9NT0RFLlNDQUxFOgogICAgICAgICAgICAgICAgdWkoKS5zaG93X3JlY2lwZV9zdGVwKCJBREQiLCBzZWxmLmN1cnJlbnRfcmVjaXBlX3N0ZXAuaW5ncmVkaWVudF9uYW1lKQogICAgICAgICAgICAgICAgc2VsZi5jdXJyZW50X3JlY2lwZV9zdGVwLnRhcmdldF92YWx1ZSA9IHNlbGYuY3VycmVudF9yZWNpcGVfc3RlcCAqIHNlbGYuZHJpbmtfbXVsdGlwbGllcgogICAgICAgICAgICBlbGlmIHNlbGYuY3VycmVudF9yZWNpcGVfc3RlcC5hY3Rpb24gPT0gcmVjaXBlLlVTRVJfSU5URVJBQ1RJT05fTU9ERS5DT05GSVJNOgogICAgICAgICAgICAgICAgc2VsZi5jdXJyZW50X3JlY2lwZV9zdGVwLnRhcmdldF92YWx1ZSA9IHNlbGYuY3VycmVudF9yZWNpcGVfc3RlcCAqIHNlbGYuZHJpbmtfbXVsdGlwbGllcgogICAgICAgICAgICBlbGlmIHNlbGYuY3VycmVudF9yZWNpcGVfc3RlcC5hY3Rpb24gPT0gcmVjaXBlLlVTRVJfSU5URVJBQ1RJT05fTU9ERS5XQUlUIG9yIHNlbGYuY3VycmVudF9yZWNpcGVfc3RlcC5hY3Rpb24gPT0gcmVjaXBlLlVTRVJfSU5URVJBQ1RJT05fTU9ERS5DT05GSVJNOgogICAgICAgICAgICAgICAgdWkoKS5zaG93X3JlY2lwZV9zdGVwKHNlbGYuY3VycmVudF9yZWNpcGVfc3RlcC5jdXJyZW50X3N0ZXBfdGV4dCwgc2VsZi5jdXJyZW50X3JlY2lwZV9zdGVwLmluZ3JlZGllbnRfbmFtZSkKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHVpKCkuc2hvd19yZWNpcGVfc3RlcCgiRE8gU09NRVRISU5HIiwgc2VsZi5jdXJyZW50X3JlY2lwZV9zdGVwLmluZ3JlZGllbnRfbmFtZSkKCiAgICAgICAgICAgIHRpbWUuc2xlZXAoMSkKCiAgICAgICAgZWxpZiBzZWxmLnJlY2lwZV9zdGF0ZSA9PSBzZWxmLlJFQ0lQRV9SVU5OSU5HOgogICAgICAgICAgICAKICAgICAgICAgICAgaWYgc2VsZi5jdXJyZW50X3JlY2lwZV9zdGVwLmFjdGlvbiA9PSByZWNpcGUuVVNFUl9JTlRFUkFDVElPTl9NT0RFLlNDQUxFOgogICAgICAgICAgICAgICAgaWYgX3N5c3RlbV9jb21tYW5kLnR5cGUgPT0gc3lzdGVtX2NvbW1hbmQuc3lzdGVtX2NvbW1hbmQuQ09NTUFORF9UWVBFX05BVklHQVRJT04gYW5kIF9zeXN0ZW1fY29tbWFuZC5hY3Rpb24gPT0gc3lzdGVtX2NvbW1hbmQuc3lzdGVtX2NvbW1hbmQuTkFWSUdBVElPTl9FTlRFUjoKICAgICAgICAgICAgICAgICAgICBzZWxmLnJlY2lwZV9zdGF0ZSA9IHNlbGYuUkVDSVBFX0VORF9DSEVDSwogICAgICAgICAgICAgICAgZWxpZiBfc3lzdGVtX2NvbW1hbmQudHlwZSA9PSBzeXN0ZW1fY29tbWFuZC5zeXN0ZW1fY29tbWFuZC5DT01NQU5EX1RZUEVfU0NBTEVfVkFMVUU6CiAgICAgICAgICAgICAgICAgICAgIyBVUERBVCBMRUQgUklORwogICAgICAgICAgICAgICAgICAgIGlmIF9zeXN0ZW1fY29tbWFuZC52YWx1ZSA+IChzZWxmLmN1cnJlbnRfcmVjaXBlX3N0ZXAudGFyZ2V0X3ZhbHVlICogMC45KToKICAgICAgICAgICAgICAgICAgICAgICAgbGVkcmluZygpLnNldF9uZW9waXhlbF9wZXJjZW50YWdlKF9zeXN0ZW1fY29tbWFuZC52YWx1ZSAvIChzZWxmLmN1cnJlbnRfcmVjaXBlX3N0ZXAudGFyZ2V0X3ZhbHVlKjEuMCksX2luZGVwZW5kZW50X2NvbG9yaW5nID0gRmFsc2UpCiAgICAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgbGVkcmluZygpLnNldF9uZW9waXhlbF9wZXJjZW50YWdlKF9zeXN0ZW1fY29tbWFuZC52YWx1ZSAvIChzZWxmLmN1cnJlbnRfcmVjaXBlX3N0ZXAudGFyZ2V0X3ZhbHVlKjEuMCksX2luZGVwZW5kZW50X2NvbG9yaW5nID0gVHJ1ZSkKICAgICAgICAgICAgICAgICAgICAjIElGIFRBUkdFVCBWQUxVRSBSRUFDSEVEIEdPVE8gTkVYVCBTVEVQCiAgICAgICAgICAgICAgICAgICAgaWYgX3N5c3RlbV9jb21tYW5kLnZhbHVlID4gc2VsZi5jdXJyZW50X3JlY2lwZV9zdGVwLnRhcmdldF92YWx1ZToKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5yZWNpcGVfc3RhdGUgPSBzZWxmLlJFQ0lQRV9FTkRfQ0hFQ0sKICAgICAgICAgICAgZWxpZiBzZWxmLmN1cnJlbnRfcmVjaXBlX3N0ZXAuYWN0aW9uID09IHJlY2lwZS5VU0VSX0lOVEVSQUNUSU9OX01PREUuV0FJVDoKICAgICAgICAgICAgICAgICMgT04gRUFDSCBTWVNURU0gVElNRVIgVElDSyBDT1VOVCBVUCBUSEUgVElNRSBJTiBUSElTIFNURVAKICAgICAgICAgICAgICAgIGlmIF9zeXN0ZW1fY29tbWFuZC50eXBlID09IHN5c3RlbV9jb21tYW5kLnN5c3RlbV9jb21tYW5kLkNPTU1BTkRfVFlQRV9USU1FUl9JUlE6CiAgICAgICAgICAgICAgICAgICAgc2VsZi5sYXN0X3RpbWVfdmFsdWUgPSBzZWxmLmxhc3RfdGltZV92YWx1ZSArIChfc3lzdGVtX2NvbW1hbmQudmFsdWUgLyAxMDAwLjApCgogICAgICAgICAgICAgICAgbGVkcmluZygpLnNldF9uZW9waXhlbF9wZXJjZW50YWdlKHNlbGYubGFzdF90aW1lX3ZhbHVlIC8gKHNlbGYuY3VycmVudF9yZWNpcGVfc3RlcC50YXJnZXRfdmFsdWUqMS4wKSxfaW5kZXBlbmRlbnRfY29sb3JpbmcgPSBGYWxzZSkKICAgICAgICAgICAgICAgICMgSUYgVEFSR0VUIFBBU1NFRCBUSU1FIFZBTFVFIFJFQUNIRUQgLT4gR09UTyBORVhUIFNURVAKICAgICAgICAgICAgICAgIGlmIHNlbGYubGFzdF90aW1lX3ZhbHVlID4gc2VsZi5jdXJyZW50X3JlY2lwZV9zdGVwLnRhcmdldF92YWx1ZToKICAgICAgICAgICAgICAgICAgICBzZWxmLnJlY2lwZV9zdGF0ZSA9IHNlbGYuUkVDSVBFX0VORF9DSEVDSwoKICAgICAgICAgICAgIyBPTiBBTlkgQlVUVE9OIENMSUNLIFNXSVRDSCBUTyBORVhUIFNURVAKICAgICAgICAgICAgZWxpZiBzZWxmLmN1cnJlbnRfcmVjaXBlX3N0ZXAuYWN0aW9uID09IHJlY2lwZS5VU0VSX0lOVEVSQUNUSU9OX01PREUuQ09ORklSTToKICAgICAgICAgICAgICAgIGxlZHJpbmcoKS5zZXRfbmVvcGl4ZWxfZnVsbCgyMCwgMjAsIDIwKQogICAgICAgICAgICAgICAgaWYgX3N5c3RlbV9jb21tYW5kLnR5cGUgPT0gc3lzdGVtX2NvbW1hbmQuc3lzdGVtX2NvbW1hbmQuQ09NTUFORF9UWVBFX05BVklHQVRJT046CiAgICAgICAgICAgICAgICAgICAgc2VsZi5yZWNpcGVfc3RhdGUgPSBzZWxmLlJFQ0lQRV9FTkRfQ0hFQ0sKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHNlbGYucmVjaXBlX3N0YXRlID0gc2VsZi5SRUNJUEVfRU5EX0NIRUNLCgogICAgICAgICMgQ0hFQ0sgSUYgVEhJUyBUSEUgTEFTVCBTVEVQIElOIFJFQ0lQRQogICAgICAgICMgVE9ETyBSRVdPUksKICAgICAgICBlbGlmIHNlbGYucmVjaXBlX3N0YXRlID09IHNlbGYuUkVDSVBFX0VORF9DSEVDSzoKICAgICAgICAgICAgc2VsZi5yZWNpcGVfc3RhdGUgPSBzZWxmLlJFQ0lQRV9SVU5OSU5HX0dFVF9ORVhUX1NURVAKICAgICAgICAgICAgIyBDSEVDSyBJRiBMQVNUIFNURVAKICAgICAgICAgICAgaWYgc2VsZi5pc19lbmRfc3RlcDoKICAgICAgICAgICAgICAgIHNlbGYucmVjaXBlX3N0YXRlID0gc2VsZi5SRUNJUEVfRU5ECiAgICAgICAgIyBTSE9XIEVORCBTQ1JFRU4KICAgICAgICBlbGlmIHNlbGYucmVjaXBlX3N0YXRlID09IHNlbGYuUkVDSVBFX0VORDoKICAgICAgICAgICAgdWkoKS5zaG93X21zZygiRU5KT1kiKQogICAgICAgICAgICBsZWRyaW5nKCkuc2V0X25lb3BpeGVsX2Z1bGxfaHN2KGxlZHJpbmcoKS5DT0xPUl9QUkVTRVRfSFNWX0hfX0dSRUVOKQogICAgICAgICAgICB0aW1lLnNsZWVwKDIpCiAgICAgICAgICAgIG1lbnVfbWFuYWdlcigpLmV4aXRfY3VycmVudF9tZW51KCk=", "recipe_updater.py": "aW1wb3J0IGNvbmZpZwppbXBvcnQgc2V0dGluZ3MKaW1wb3J0IHRpbWUKaW1wb3J0IGhlbHBlcgoKCmNsYXNzIHJlY2lwZV91cGRhdGVfaGVscGVyOgoKCiAgICBAc3RhdGljbWV0aG9kCiAgICBkZWYgaGFzX25ldHdvcmtfY2FwYWJpbGl0aWVzKCkgLT4gYm9vbDoKICAgICAgICB0cnk6CiAgICAgICAgICAgIGltcG9ydCBuZXR3b3JrCiAgICAgICAgICAgIGltcG9ydCBzb2NrZXQKICAgICAgICAgICAgaW1wb3J0IHVyZXF1ZXN0cwogICAgICAgICAgICByZXR1cm4gVHJ1ZQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgcmV0dXJuIEZhbHNlCgogICAgQHN0YXRpY21ldGhvZAogICAgZGVmIGdldF9hcGlfdXJsKCkgLT4gc3RyOgogICAgICAgIGFwaV9lbmRwb2ludDogc3RyID0gc2V0dGluZ3Muc2V0dGluZ3MoKS5nZXRfc2V0dGluZ3NfZW50cnkoc2V0dGluZ3MuU0VUVElOR1NfRU5UUklFUy5ORVRXT1JLX0FQSV9FTlBPSU5UKQogICAgICAgIGlmIGFwaV9lbmRwb2ludCBpcyBOb25lOgogICAgICAgICAgICByZXR1cm4gTm9uZQoKCiAgICAgICAgaWYgbm90IGFwaV9lbmRwb2ludC5zdGFydHN3aXRoKCdodHRwOi8vJyk6CiAgICAgICAgICAgIGFwaV9lbmRwb2ludCA9ICdodHRwOi8vJyArIGFwaV9lbmRwb2ludAogICAgICAgIHByaW50KCJjaGVja191cGRhdGVfdXJsOiBzZXQgYXBpIGVuZHBvaW50IHVybCB7fSIuZm9ybWF0KGFwaV9lbmRwb2ludCkpCiAgICAgICAgCiAgICAgICAgIyBSRU1PVkUgVEFJTElORyAvIFRPIE1BS0UgRk9XTExJTkcgVVJMIENBTExTIFZBTElECiAgICAgICAgaWYgYXBpX2VuZHBvaW50LmVuZHN3aXRoKCcvJykgYW5kIGxlbihhcGlfZW5kcG9pbnQpID4gMDoKICAgICAgICAgICAgYXBpX2VuZHBvaW50ID0gYXBpX2VuZHBvaW50WzotMV0KCiAgICAgICAgCiAgICAgICAgZmluYWxfYXBpX3VybDogc3RyID0gInt9L3t9Ii5mb3JtYXQoYXBpX2VuZHBvaW50LCBzdHIoaGVscGVyLmdldF9zeXN0ZW1faWQoKSkpCiAgICAgICAgcmV0dXJuIGZpbmFsX2FwaV91cmwKCnRyeToKICAgIGltcG9ydCBuZXR3b3JrCiAgICBpbXBvcnQgc29ja2V0CiAgICBpbXBvcnQgdXJlcXVlc3RzCgogICAgY2xhc3MgcmVjaXBlX3VwZGF0ZXI6CiAgICAgICAgCiAgICAgICAgQHN0YXRpY21ldGhvZAogICAgICAgIGRlZiBkaXNhYmxlX3dpZmkoKToKICAgICAgICAgICAgd2xhbiA9IG5ldHdvcmsuV0xBTihuZXR3b3JrLlNUQV9JRikKICAgICAgICAgICAgd2xhbi5hY3RpdmUoRmFsc2UpCiAgICAgICAgCgogICAgICAgIEBzdGF0aWNtZXRob2QKICAgICAgICBkZWYgZ2V0X2FwaV91cmwoKSAtPiBzdHI6CiAgICAgICAgICAgIHJldHVybiByZWNpcGVfdXBkYXRlX2hlbHBlci5nZXRfYXBpX3VybCgpCgogICAgICAgIEBzdGF0aWNtZXRob2QKICAgICAgICBkZWYgY29ubmVjdF93aWZpKCkgLT4gYm9vbDoKICAgICAgICAgICAgbmV0d29yay5jb3VudHJ5KGNvbmZpZy5DRkdfTkVUV09SS19XSUZJQ09VTlRSWSkKICAgICAgICAgICAgbmV0d29yay5ob3N0bmFtZShjb25maWcuQ0ZHX05FVFdPUktfSE9TVE5BTUUpICMuZm9ybWF0KGhlbHBlci5nZXRfc3lzdGVtX2lkKCkpKQoKICAgICAgICAgICAgd2xhbiA9IG5ldHdvcmsuV0xBTihuZXR3b3JrLlNUQV9JRikKICAgICAgICAgICAgd2xhbi5hY3RpdmUoVHJ1ZSkKICAgICAgICAgICAgCiAgICAgICAgICAgIAogICAgICAgICAgICBzc2lkID0gc2V0dGluZ3Muc2V0dGluZ3MoKS5nZXRfc2V0dGluZ3NfZW50cnkoc2V0dGluZ3MuU0VUVElOR1NfRU5UUklFUy5ORVRXT1JLX1dJRklfU1NJRCkKICAgICAgICAgICAgcHNrID0gc2V0dGluZ3Muc2V0dGluZ3MoKS5nZXRfc2V0dGluZ3NfZW50cnkoc2V0dGluZ3MuU0VUVElOR1NfRU5UUklFUy5ORVRXT1JLX1dJRklfUFNLKQogICAgICAgICAgICAKICAgICAgICAgICAgaWYgc3NpZCBpcyBOb25lIG9yIHBzayBpcyBOb25lOgogICAgICAgICAgICAgICAgcHJpbnQoIlNTSUQgT1IgUFNLIEZPUiBXSUZJIENPTk5FQ1RJT04gTk9UIFNFVCIpCiAgICAgICAgICAgICAgICByZXR1cm4gRmFsc2UKCgogICAgICAgICAgICBwcmludCgiQ09OTkVDVElORyBUTzoge30iLmZvcm1hdChzc2lkKSkKICAgICAgICAgICAgd2xhbi5jb25uZWN0KHNzaWQsIHBzaykKICAgICAgICAgICAgdGltZXIgPSAwCiAgICAgICAgICAgIHdoaWxlIHdsYW4uaXNjb25uZWN0ZWQoKSA9PSBGYWxzZToKICAgICAgICAgICAgICAgIHByaW50KCdXYWl0aW5nIGZvciBjb25uZWN0aW9uLi4uJykKICAgICAgICAgICAgICAgIHRpbWUuc2xlZXAoMSkKICAgICAgICAgICAgICAgIHRpbWVyID0gdGltZXIgKyAxCgogICAgICAgICAgICAgICAgaWYgdGltZXIgPiAxMDoKICAgICAgICAgICAgICAgICAgICB3bGFuLmFjdGl2ZShGYWxzZSkKICAgICAgICAgICAgICAgICAgICByZXR1cm4gRmFsc2UKICAgICAgICAgICAgCiAgICAgICAgICAgIGlmIHdsYW4uaXNjb25uZWN0ZWQoKToKICAgICAgICAgICAgICAgIHJldHVybiBUcnVlCiAgICAgICAgICAgIHJldHVybiBGYWxzZQogICAgICAgIAoKICAgICAgICBAc3RhdGljbWV0aG9kCiAgICAgICAgZGVmIGNoZWNrX3VwZGF0ZV91cmwoKSAtPiBib29sOgogICAgICAgICAgICBpZiBub3QgcmVjaXBlX3VwZGF0ZXIuY29ubmVjdF93aWZpKCk6CiAgICAgICAgICAgICAgICByZXR1cm4gRmFsc2UKICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgIyBHRVQgTElTVCBPRiBSRUNJUEVTCiAgICAgICAgICAgICAgICByID0gdXJlcXVlc3RzLmdldChyZWNpcGVfdXBkYXRlX2hlbHBlci5nZXRfYXBpX3VybCgpKQogICAgICAgICAgICAgICAgci5jbG9zZSgpCiAgICAgICAgICAgICAgICByZXR1cm4gVHJ1ZSAgICAgICAgCiAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgICAgIHByaW50KHN0cihlKSkKICAgICAgICAgICAgICAgIHJldHVybiBGYWxzZQoKICAgICAgICAgICAgCiAgICAgICAgQHN0YXRpY21ldGhvZCAgIAogICAgICAgIGRlZiB1cGRhdGVfcmVjaXBlcygpIC0+IGJvb2w6CiAgICAgICAgICAgIGlmIG5vdCByZWNpcGVfdXBkYXRlci5jaGVja191cGRhdGVfdXJsKCk6CiAgICAgICAgICAgICAgICByZXR1cm4gRmFsc2UKCiAgICAgICAgICAgIGFwaV9lbmRwb2ludDogc3RyID0gcmVjaXBlX3VwZGF0ZV9oZWxwZXIuZ2V0X2FwaV91cmwoKQogICAgICAgIAogICAgICAgICAgICBwcmludCgiQVBJOiB7fSIuZm9ybWF0KGFwaV9lbmRwb2ludCkpCgogICAgICAgICAgICB0aW1lLnNsZWVwKDIpCiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICMgR0VUIExJU1QgT0YgUkVDSVBFUwogICAgICAgICAgICAgICAgaGVhZGVyczogZGljdCA9IHt9CiAgICAgICAgICAgICAgICByID0gdXJlcXVlc3RzLmdldCgie30vcmVjaXBlcyIuZm9ybWF0KGFwaV9lbmRwb2ludCksICBoZWFkZXJzPWhlYWRlcnMpCiAgICAgICAgICAgICAgICByZWNpcGVfbGlzdCA9IHIuanNvbigpICMgWyJyZXNpcGVfZmlsZV91cmlfcmVsYXRpdmUiXQogICAgICAgICAgICAgICAgci5jbG9zZSgpCiAgICAgICAgICAgICAgICBpZiByZWNpcGVfbGlzdCBpcyBub3QgTm9uZToKICAgICAgICAgICAgICAgICAgICAjIERPTldMT0FEIEVBQ0ggUkVDSVBFCiAgICAgICAgICAgICAgICAgICAgZm9yIHJlY2lwZSBpbiByZWNpcGVfbGlzdDoKICAgICAgICAgICAgICAgICAgICAgICAgciA9IHVyZXF1ZXN0cy5nZXQoInt9L3JlY2lwZS97fSIuZm9ybWF0KGFwaV9lbmRwb2ludCwgcmVjaXBlKSwgIGhlYWRlcnM9aGVhZGVycykKICAgICAgICAgICAgICAgICAgICAgICAgZGxfcmVjaXBlID0gci5qc29uKCkgIyBbe2ZpbGVuYW1lX3dpdGhvdXRfZW5kaW5nLCByZWNpcGV9XQogICAgICAgICAgICAgICAgICAgICAgICByLmNsb3NlKCkKCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICdyZWNpcGUnIGluIGRsX3JlY2lwZToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNldHRpbmdzLnNldHRpbmdzLmluc3RhbmNlKCkud3JpdGVfanNvbl9maWxlKGRsX3JlY2lwZVsnbmFtZSddICsgIi5yZWNpcGUiLCBkbF9yZWNpcGVbJ3JlY2lwZSddKQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnQoImNhbnQgc3RvcmUgcmVjaXBlZCBkYXRhIGJsb2NrIGR1ZSB0byBtaXNzaW5nIHJlY2lwZSBkaWN0IGJsb2NrIikKICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgICAgIHByaW50KHN0cihlKSkKICAgIAogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgCiAgICAgICAgICAgIHJlY2lwZV91cGRhdGVyLmRpc2FibGVfd2lmaSgpCiAgICAgICAgICAgIHJldHVybiBUcnVlCiAgICAgICAgCgpleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgCiAgICBjbGFzcyByZWNpcGVfdXBkYXRlcjoKICAgICAgICAKICAgICAgICBAc3RhdGljbWV0aG9kCiAgICAgICAgZGVmIGdldF9hcGlfdXJsKCkgLT4gc3RyOgogICAgICAgICAgICByZXR1cm4gcmVjaXBlX3VwZGF0ZV9oZWxwZXIuZ2V0X2FwaV91cmwoKQoKICAgICAgICBAc3RhdGljbWV0aG9kCiAgICAgICAgZGVmIGRpc2FibGVfd2lmaSgpOgogICAgICAgICAgICBwYXNzCiAgICAgICAgCiAgICAgICAgQHN0YXRpY21ldGhvZAogICAgICAgIGRlZiBjaGVja191cGRhdGVfdXJsKCkgLT4gYm9vbDoKICAgICAgICAgICAgcmV0dXJuIEZhbHNlCgogICAgICAgIEBzdGF0aWNtZXRob2QKICAgICAgICBkZWYgY29ubmVjdF93aWZpKCkgLT4gYm9vbDoKICAgICAgICAgICAgcmV0dXJuIEZhbHNlCgogICAgICAgIEBzdGF0aWNtZXRob2QKICAgICAgICBkZWYgdXBkYXRlX3JlY2lwZXMoKSAtPiBib29sOgogICAgICAgICAgICByZXR1cm4gRmFsc2U=", "menu_entry_recipe_editor.py": "aW1wb3J0IG1lbnVfZW50cnkKaW1wb3J0IHN5c3RlbV9jb21tYW5kCmZyb20gdWkgaW1wb3J0IHVpCmZyb20gbGVkcmluZyBpbXBvcnQgbGVkcmluZwpmcm9tIHJlY2lwZV91cGRhdGVyIGltcG9ydCByZWNpcGVfdXBkYXRlcgpmcm9tIHN0YXRpY19tb2R1bGVzLm1lbnVfbWFuYWdlciBpbXBvcnQgbWVudV9tYW5hZ2VyCmZyb20gcmVjaXBlX2VkaXRvciBpbXBvcnQgcmVjaXBlX2VkaXRvcgppbXBvcnQgaGVscGVyCmltcG9ydCBjb25maWcKCgpjbGFzcyBtZW51X2VudHJ5X3JlY2lwZV9lZGl0b3IobWVudV9lbnRyeS5tZW51X2VudHJ5KToKCiAgICBlZGl0b3I6IHJlY2lwZV9lZGl0b3IgPSBOb25lCiAgICBpbml0X3N1Y2Nlc3M6IGJvb2wgPSBGYWxzZQogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oIlJFQ0lQRSBFRElUT1IiLCAiRW5hYmxlIFdpZmkgYmFzZWQgb25saW5lIHJlY2lwZSBlZGl0b3IiKQoKICAgIGRlZiBwcmV2aWV3KHNlbGYpOgogICAgICAgIHByaW50KCJwcmV2aWV3IHt9Ii5mb3JtYXQoc2VsZi5uYW1lKSkKICAgICAgICB1aSgpLnNob3dfcmVjaXBlX2luZm9ybWF0aW9uKHNlbGYubmFtZSwgc2VsZi5kZXNjcmlwdGlvbikKCgogICAgZGVmIGFjdGl2YXRlKHNlbGYpOgogICAgICAgIHByaW50KCJhY3RpdmF0ZSB7fSIuZm9ybWF0KHNlbGYubmFtZSkpCiAgICAgICAgaWYgc2VsZi5lZGl0b3IgaXMgbm90IE5vbmU6CiAgICAgICAgICAgIHNlbGYudGVhcmRvd24oKQoKICAgICAgICBzZWxmLmVkaXRvciA9IHJlY2lwZV9lZGl0b3IoKQoKICAgICAgICBpZiBub3Qgc2VsZi5lZGl0b3IuaGFzX2NhcGFiaWxpdGllcygpOgogICAgICAgICAgICBzZWxmLmluaXRfc3VjY2VzcyA9IFRydWUKICAgICAgICAgICAgdWkoKS5zaG93X21zZygiV2lmaSBhY2Nlc3MgcG9pbnQgaXMgbm90IHN1cHBvcnRlZCIpCiAgICAgICAgICAgIHJldHVybgogICAgICAgIAogICAgICAgICMgIENGR19FRElUT1JfV0lGSV9TVEFfU1NJRCBDRkdfRURJVE9SX1dJRklfU1RBX1BTSwogICAgICAgIHNzaWQ6IHN0ciA9IGNvbmZpZy5DRkdfRURJVE9SX1dJRklfU1RBX1NTSUQuZm9ybWF0KGhlbHBlci5nZXRfc3lzdGVtX2lkKCkpCiAgICAgICAgcHNrOiBzdHIgPSAgY29uZmlnLkNGR19FRElUT1JfV0lGSV9TVEFfUFNLLmZvcm1hdChoZWxwZXIuZ2V0X3N5c3RlbV9pZCgpKQoKICAgICAgICBpcDogc3RyPSBzZWxmLmVkaXRvci5vcGVuX2FjY2Vzc3BvaW50KHNzaWQsIHBzaykgICAgCiAgICAgICAgdWkoKS5zaG93X3JlY2lwZV9pbmZvcm1hdGlvbigiUGxlYXNlIGNvbm5lY3QgdXNpbmcgOiIsICJJUDp7fVxuU1NJRDp7fVxuUFNLOnt9Ii5mb3JtYXQoaXAsIHNzaWQsIHBzaykpCgogICAgICAgIHNlbGYuZWRpdG9yLnNldHVwX3dlYnNlcnZlcigpCgogICAgICAgIHNlbGYuaW5pdF9zdWNjZXNzID0gVHJ1ZQoKCiAgICBkZWYgdGVhcmRvd24oc2VsZik6CiAgICAgICAgcHJpbnQoInRlYXJkb3duIHt9Ii5mb3JtYXQoc2VsZi5uYW1lKSkKICAgICAgICBzZWxmLmVkaXRvci5zdG9wX3dlYnNlcnZlcigpCiAgICAgICAgc2VsZi5lZGl0b3IuZGlzYWJsZV93aWZpKCkKICAgICAgICBkZWwgZWRpdG9yCgoKICAgIGRlZiB1cGRhdGUoc2VsZiwgX3N5c3RlbV9jb21tYW5kOiBzeXN0ZW1fY29tbWFuZC5zeXN0ZW1fY29tbWFuZCk6CiAgICAgICAgaWYgc2VsZi5pbml0X3N1Y2Nlc3M6CiAgICAgICAgICAgIHNlbGYuZWRpdG9yLmhhbmRsZV9jb25uZWN0aW9uKCk=", "settings.py": "aW1wb3J0IHNkY2FyZAppbXBvcnQgbWFjaGluZQppbXBvcnQgdW9zCmltcG9ydCBqc29uCmltcG9ydCBjb25maWcKaW1wb3J0IG9zCmZyb20gc2luZ2xldG9uIGltcG9ydCBzaW5nbGV0b24KCmNsYXNzIFNFVFRJTkdTX0VOVFJJRVMob2JqZWN0KToKICAgIFNDQUxFX0NBTElCUkFUSU9OX01JTl9WQUxVRTogc3RyID0gInNjYWxlX21pbiIKICAgIFNDQUxFX0NBTElCUkFUSU9OX01BWF9WQUxVRTogc3RyID0gInNjYWxlX2Z1bGwiCiAgICBTQ0FMRV9DQUxJQlJBVElPTl9DQUxJQlJBVElPTl9XRUlHSFQ6IHN0ciA9ICJzY2FsZV93ZWlnaHQiCiAgICBTQ0FMRV9DQUxJQlJBVElPTl9DQUxJQlJBVElPTl9XRUlHSFQ6IHN0ciA9ICJzY2FsZV93ZWlnaHQiCiAgICBTQ0FMRV9DQUxJQlJBVElPTl9DQUxJQlJBVElPTl9JTlZFUlQ6IHN0ciA9ICJzY2FsZV9pbnZlcnRfZmFjdG9yIgogICAgTkVUV09SS19XSUZJX1NTSUQ6IHN0ciA9ICJ3aWZpX3NzaWQiCiAgICBORVRXT1JLX1dJRklfUFNLOiBzdHIgPSAid2lmaV9wc2siCiAgICBORVRXT1JLX0FQSV9FTlBPSU5UOiBzdHIgPSAiYXBpX2VucG9pbnQiCgoKCkBzaW5nbGV0b24KY2xhc3Mgc2V0dGluZ3Mob2JqZWN0KToKCiAgIAoKICAgIHNkID0gTm9uZSAjIHNkY2FyZCBjbGFzcyBpbnN0YW5jZQoKICAgIFJFQ0lQRV9CQVNFX0RJUjogc3RyID0gIi9kYXRhIiAjIEZPTERFUiBPRiBUSEUgU0VUVElOR1MgRklMRVMgU1RPUkFHRSBJRiBTRCBDQVJEIEZPVU5EIFNEIENBUkQgV0lMTCBCRSBNT1VOVEVEIFRIRVJFCiAgICBTRVRUSU5HU19GSUxFTkFNRTogc3RyID0gIlNFVFRJTkdTLmpzb24iCiAgICAgCiAgICBkZWYgX19pbml0X18oc2VsZiwgX3NwaSA9IE5vbmUsIF9jc19waW4gPSBjb25maWcuQ0ZHX1NEQ0FSRF9DU19QSU4sIF9kYXRhX2Rpcjogc3RyID0gIi9kYXRhIik6CiAgICAgICAgc2VsZi5SRUNJUEVfQkFTRV9ESVIgPSBfZGF0YV9kaXIKCiAgICAgICAgaWYgX3NwaSBpcyBOb25lOgogICAgICAgICAgICBfc3BpID0gbWFjaGluZS5TUEkoY29uZmlnLkNGR19TRENBUkRfU1BJSU5TVEFOQ0UsIGJhdWRyYXRlPTEwMDAwMDAsIHBvbGFyaXR5PTAsIHBoYXNlPTAsIGJpdHM9OCwgZmlyc3RiaXQ9bWFjaGluZS5TUEkuTVNCLCBzY2s9bWFjaGluZS5QaW4oY29uZmlnLkNGR19TRENBUkRfU0NLX1BJTiksIG1vc2k9bWFjaGluZS5QaW4oY29uZmlnLkNGR19TRENBUkRfTU9TSV9QSU4pLCBtaXNvPW1hY2hpbmUuUGluKGNvbmZpZy5DRkdfU0RDQVJEX01JU09fUElOKSkKICAgICAgICAjIEFzc2lnbiBjaGlwIHNlbGVjdCAoQ1MpIHBpbiAoYW5kIHN0YXJ0IGl0IGhpZ2gpCiAgICAgICAgc2VsZi5jcyA9IG1hY2hpbmUuUGluKF9jc19waW4sIG1hY2hpbmUuUGluLk9VVCkKCiAgICAgICAgc2VsZi5zZCA9IE5vbmUKICAgICAgICB0cnk6CiAgICAgICAgICAgIHNlbGYuc2QgPSBzZGNhcmQuU0RDYXJkKF9zcGksIHNlbGYuY3MpCgogICAgICAgICAjIE1vdW50IGZpbGVzeXN0ZW0KICAgICAgICAgICAgc2VsZi52ZnMgPSB1b3MuVmZzRmF0KHNlbGYuc2QpCiAgICAgICAgICAgIHVvcy5tb3VudChzZWxmLnZmcywgc2VsZi5SRUNJUEVfQkFTRV9ESVIpCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICBwcmludCgic2RjYXJkIGluaXQgZmFpbGVkIHVzaW5nIGxvY2FsIGZpbGVzeXN0ZW0gb24gL2RhdGEiLCBzdHIoZSkpCgoKICAgICAgICBpZiBzZWxmLnNkIGlzIE5vbmU6CiAgICAgICAgICAgIHRyeTogCiAgICAgICAgICAgICAgICBvcy5ta2RpcihzZWxmLlJFQ0lQRV9CQVNFX0RJUikgCiAgICAgICAgICAgICAgICBwcmludCgiRGlyZWN0b3J5ICclcycgY3JlYXRlZCBzdWNjZXNzZnVsbHkiICUgc2VsZi5SRUNJUEVfQkFTRV9ESVIpIAogICAgICAgICAgICBleGNlcHQgT1NFcnJvciBhcyBlcnJvcjogCiAgICAgICAgICAgICAgICBwcmludCgiRGlyZWN0b3J5ICclcycgY2FuIG5vdCBiZSBjcmVhdGVkIiAlIHNlbGYuUkVDSVBFX0JBU0VfRElSKQoKCiAgICAgICAgc2VsZi5jcmVhdGVfc2V0dGluZ3NfZmlsZSgpCiAgICAgICAgc2VsZi5jcmVhdGVfaW5pdGlhbF9jb25maWcoKQoKICAgIGRlZiBjcmVhdGVfc2V0dGluZ3NfZmlsZShzZWxmKToKICAgICAgICBzZXR0aW5nc19kaWN0OiBkaWN0ID0ge30KICAgICAgICBpZiBub3Qgc2VsZi5TRVRUSU5HU19GSUxFTkFNRSBpbiBzZWxmLmxpc3RfZmlsZXMoKToKICAgICAgICAgICAgc2VsZi53cml0ZV9qc29uX2ZpbGUoc2VsZi5SRUNJUEVfQkFTRV9ESVIgKyAiLyIgKyBzZWxmLlNFVFRJTkdTX0ZJTEVOQU1FLCBzZXR0aW5nc19kaWN0KQoKICAgIGRlZiBjcmVhdGVfaW5pdGlhbF9jb25maWcoc2VsZik6CiAgICAgICAgbWVtYmVycyA9IFthdHRyIGZvciBhdHRyIGluIGRpcihTRVRUSU5HU19FTlRSSUVTKSBpZiBub3QgY2FsbGFibGUoZ2V0YXR0cihTRVRUSU5HU19FTlRSSUVTLCBhdHRyKSkgYW5kIG5vdCBhdHRyLnN0YXJ0c3dpdGgoIl9fIildCiAgICAgICAgIyBQT1BVTEFURSBDT05GSUcgRklMRSBXSVRIIEFMTCBQT1NTSUJMRSBLRVlTCiAgICAgICAgZm9yIG0gaW4gbWVtYmVyczoKICAgICAgICAgICAgaWYgc2VsZi5nZXRfc2V0dGluZ3NfZW50cnkobSkgaXMgbm90IE5vbmU6CiAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgICBzZWxmLnNldF9zZXR0aW5nc19lbnRyeShtLCBOb25lKSAgCgoKICAgICAgICAjIEFERCBTT01FIERFRkFVTFQgVkFMVUVTIEZST00gQ09ORklHCgogICAgICAgIGlmIHNlbGYuZ2V0X3NldHRpbmdzX2VudHJ5KFNFVFRJTkdTX0VOVFJJRVMuTkVUV09SS19XSUZJX1NTSUQpIGlzIE5vbmU6CiAgICAgICAgICAgIHNlbGYuc2V0X3NldHRpbmdzX2VudHJ5KFNFVFRJTkdTX0VOVFJJRVMuTkVUV09SS19XSUZJX1NTSUQsIGNvbmZpZy5DRkdfTkVUV09SS19XSUZJX1NTSUQpCgogICAgICAgIGlmIHNlbGYuZ2V0X3NldHRpbmdzX2VudHJ5KFNFVFRJTkdTX0VOVFJJRVMuTkVUV09SS19XSUZJX1BTSykgaXMgTm9uZToKICAgICAgICAgICAgc2VsZi5zZXRfc2V0dGluZ3NfZW50cnkoU0VUVElOR1NfRU5UUklFUy5ORVRXT1JLX1dJRklfUFNLLCBjb25maWcuQ0ZHX05FVFdPUktfV0lGSV9QU0spCgogICAgICAgIGlmIHNlbGYuZ2V0X3NldHRpbmdzX2VudHJ5KFNFVFRJTkdTX0VOVFJJRVMuTkVUV09SS19BUElfRU5QT0lOVCkgaXMgTm9uZToKICAgICAgICAgICAgc2VsZi5zZXRfc2V0dGluZ3NfZW50cnkoU0VUVElOR1NfRU5UUklFUy5ORVRXT1JLX0FQSV9FTlBPSU5ULCBjb25maWcuQ0ZHX05FVFdPUktfQVBJX0VORFBPSU5UKQoKCiAgICAgICAgaWYgc2VsZi5nZXRfc2V0dGluZ3NfZW50cnkoU0VUVElOR1NfRU5UUklFUy5TQ0FMRV9DQUxJQlJBVElPTl9DQUxJQlJBVElPTl9JTlZFUlQpIGlzIE5vbmU6CiAgICAgICAgICAgIHNlbGYuc2V0X3NldHRpbmdzX2VudHJ5KFNFVFRJTkdTX0VOVFJJRVMuU0NBTEVfQ0FMSUJSQVRJT05fQ0FMSUJSQVRJT05fSU5WRVJULCBjb25maWcuQ0ZHX1NDQUxFX0lOVkVSVF9XRUlHSFRfTUVBU1VSRURfVkFMVUUpCiAgICAgICAgCgoKICAgICAgICAKCgogICAgZGVmIGdldF9zZXR0aW5nc19lbnRyeShzZWxmLCBfa2V5OiBzdHIpIC0+IGFueToKICAgICAgICBzZXR0aW5nc19kaWN0OiBkaWN0ID0gc2VsZi5sb2FkX2pzb25fZmlsZShzZWxmLlJFQ0lQRV9CQVNFX0RJUiArICIvIiArIHNlbGYuU0VUVElOR1NfRklMRU5BTUUpCgogICAgICAgIGlmIF9rZXkgaW4gc2V0dGluZ3NfZGljdDoKICAgICAgICAgICAgcmV0dXJuIHNldHRpbmdzX2RpY3RbX2tleV0KCiAgICAgICAgcHJpbnQoImdldF9zZXR0aW5nc19lbnRyeSBrZXk6IHt9IG5vdCBmb3VuZCBpbiBzZXR0aW5ncyBmaWxlIi5mb3JtYXQoX2tleSkpCiAgICAgICAgcmV0dXJuIE5vbmUKICAgIAoKCiAgICBkZWYgc2V0X3NldHRpbmdzX2VudHJ5KHNlbGYsIF9rZXk6IHN0ciwgX3ZhbHVlOiBhbnkpOgogICAgICAgIHNldHRpbmdzX2RpY3Q6IGRpY3QgPSBzZWxmLmxvYWRfanNvbl9maWxlKHNlbGYuUkVDSVBFX0JBU0VfRElSICsgIi8iICsgc2VsZi5TRVRUSU5HU19GSUxFTkFNRSkKCiAgICAgICAgc2V0dGluZ3NfZGljdFtzdHIoX2tleSldID0gX3ZhbHVlCgogICAgICAgIHNlbGYud3JpdGVfanNvbl9maWxlKHNlbGYuUkVDSVBFX0JBU0VfRElSICsgIi8iICsgc2VsZi5TRVRUSU5HU19GSUxFTkFNRSwgc2V0dGluZ3NfZGljdCkKCgoKICAgIGRlZiBnZXRfc2V0dGluZ3NfYmFzZV9mb2xkZXJfcGF0aChzZWxmKSAtPiBzdHI6CiAgICAgICAgcmV0dXJuIHNlbGYuUkVDSVBFX0JBU0VfRElSCgogICAgZGVmIGxpc3RfZmlsZXMoc2VsZikgLT5saXN0W3N0cl06CiAgICAgICAgcmV0dXJuIG9zLmxpc3RkaXIoc2VsZi5SRUNJUEVfQkFTRV9ESVIpCgoKICAgIAogICAgZGVmIHdyaXRlX2pzb25fZmlsZShzZWxmLCBfcGF0aDpzdHIsIF9kaWN0X2NvbnRlbnQ6IGRpY3QpOgogICAgICAgICMgQUREIFNFVFRJTkdTIFNUT1JBR0UgRElSRUNUT1JZIElGIFJFTCBQQVRIIElTIFJFUVVFU1RFRAogICAgICAgIGlmIG5vdCBfcGF0aC5zdGFydHN3aXRoKCIvIik6CiAgICAgICAgICAgIF9wYXRoID0gc2VsZi5SRUNJUEVfQkFTRV9ESVIgKyAiLyIgKyBfcGF0aAoKICAgICAgICB3aXRoIG9wZW4oX3BhdGgsICJ3IikgYXMgZmlsZToKICAgICAgICAgICAgZmlsZS53cml0ZShqc29uLmR1bXBzKF9kaWN0X2NvbnRlbnQpKQoKCiAgICBkZWYgbG9hZF9qc29uX2ZpbGUoc2VsZiwgX3BhdGg6IHN0cikgLT4gZGljdDoKCiAgICAgICAgaWYgbm90IF9wYXRoLnN0YXJ0c3dpdGgoIi8iKToKICAgICAgICAgICAgX3BhdGggPSBzZWxmLlJFQ0lQRV9CQVNFX0RJUiArICIvIiArIF9wYXRoCiAgICAgICAgCiAgICAgICAgIyBUT0RPIEFERCBDSEVDSyBGT1IgRklMRSBFWFNJVFMKICAgICAgICB0cnk6CiAgICAgICAgICAgIHNldHRpbmdzX2RpY3Q6IGRpY3QgPSB7fQogICAgICAgICAgICB3aXRoIG9wZW4oX3BhdGgsICJyIikgYXMgZmlsZToKICAgICAgICAgICAgICAgIHNldHRpbmdzX2RpY3QgPSBqc29uLmxvYWRzKGZpbGUucmVhZCgpKQogICAgICAgICAgICByZXR1cm4gc2V0dGluZ3NfZGljdAogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgcHJpbnQoZSkKICAgICAgICAgICAgcmV0dXJuIHt9CgogICAgIyMjIyMjIyMjIyMjIyMjIyBTUEVDSUZJQyBTRVRUSU5HUyBMT0FESU5HIEZVQ1RJT05TICMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKCgogICAgZGVmIHNhdmVfc2NhbGVfY2FsaWJyYXRpb25fdmFsdWVzKHNlbGYsIF9zY2FsZV9jYWxpYnJhdGlvbl8wZzogZmxvYXQsIF9zY2FsZV9jYWxpYnJhdGlvbl81MGc6IGZsb2F0LCBfc2NhbGVfY2FsaWJyYXRpb25fd2VpZ2h0X3dlaWdodDogZmxvYXQgPSBjb25maWcuQ0ZHX0NBTElCUkFUSU9OX1dFSUdIVF9XRUlHSFQsIF9zY2FsZV9pbnZlcnRfZmFjdG9yOiBmbG9hdCA9IGNvbmZpZy5DRkdfU0NBTEVfSU5WRVJUX1dFSUdIVF9NRUFTVVJFRF9WQUxVRSk6CiAgICAgICAgc2VsZi5zZXRfc2V0dGluZ3NfZW50cnkoU0VUVElOR1NfRU5UUklFUy5TQ0FMRV9DQUxJQlJBVElPTl9NSU5fVkFMVUUsIF9zY2FsZV9jYWxpYnJhdGlvbl8wZykKICAgICAgICBzZWxmLnNldF9zZXR0aW5nc19lbnRyeShTRVRUSU5HU19FTlRSSUVTLlNDQUxFX0NBTElCUkFUSU9OX01BWF9WQUxVRSwgX3NjYWxlX2NhbGlicmF0aW9uXzUwZykKICAgICAgICBzZWxmLnNldF9zZXR0aW5nc19lbnRyeShTRVRUSU5HU19FTlRSSUVTLlNDQUxFX0NBTElCUkFUSU9OX0NBTElCUkFUSU9OX1dFSUdIVCwgX3NjYWxlX2NhbGlicmF0aW9uX3dlaWdodF93ZWlnaHQpCiAgICAgICAgc2VsZi5zZXRfc2V0dGluZ3NfZW50cnkoU0VUVElOR1NfRU5UUklFUy5TQ0FMRV9DQUxJQlJBVElPTl9DQUxJQlJBVElPTl9JTlZFUlQsIF9zY2FsZV9pbnZlcnRfZmFjdG9yKQoKICAgIAogICAgICAgIHByaW50KCJzYXZlX3NjYWxlX2NhbGlicmF0aW9uX3ZhbHVlcyAoe30te30pIC8ge30gd2l0aCBpbnZlcnQgZmFjdG9yIG9mOiB7fSIuZm9ybWF0KF9zY2FsZV9jYWxpYnJhdGlvbl8wZywgX3NjYWxlX2NhbGlicmF0aW9uXzUwZywgX3NjYWxlX2NhbGlicmF0aW9uX3dlaWdodF93ZWlnaHQsIF9zY2FsZV9pbnZlcnRfZmFjdG9yKSkKCgogICAgCiAgICBkZWYgZ2V0X3NjYWxlX2NhbGlicmF0aW9uX2ZhY3RvcihzZWxmKToKICAgICAgICBzY19taW4gPSAzMDAwLjAKICAgICAgICBzY19mdWxsID0gNTAwMC4wCiAgICAgICAgc2Nfd2VpZ2h0ID0gY29uZmlnLkNGR19DQUxJQlJBVElPTl9XRUlHSFRfV0VJR0hUCiAgICAgICAgc2NfaW52ZXJ0ID0gY29uZmlnLkNGR19TQ0FMRV9JTlZFUlRfV0VJR0hUX01FQVNVUkVEX1ZBTFVFCiAgICAgICAgdHJ5OgogICAgICAgICAgICBzY19taW4gPSBmbG9hdChzZWxmLmdldF9zZXR0aW5nc19lbnRyeShTRVRUSU5HU19FTlRSSUVTLlNDQUxFX0NBTElCUkFUSU9OX01JTl9WQUxVRSkpCiAgICAgICAgICAgIHNjX2Z1bGwgPSBmbG9hdChzZWxmLmdldF9zZXR0aW5nc19lbnRyeShTRVRUSU5HU19FTlRSSUVTLlNDQUxFX0NBTElCUkFUSU9OX01BWF9WQUxVRSkpCiAgICAgICAgICAgIHNjX3dlaWdodCA9IGZsb2F0KHNlbGYuZ2V0X3NldHRpbmdzX2VudHJ5KFNFVFRJTkdTX0VOVFJJRVMuU0NBTEVfQ0FMSUJSQVRJT05fQ0FMSUJSQVRJT05fV0VJR0hUKSkKICAgICAgICAgICAgc2NfaW52ZXJ0ID0gZmxvYXQoc2VsZi5nZXRfc2V0dGluZ3NfZW50cnkoU0VUVElOR1NfRU5UUklFUy5TQ0FMRV9DQUxJQlJBVElPTl9DQUxJQlJBVElPTl9JTlZFUlQpKQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgc2VsZi5zYXZlX3NjYWxlX2NhbGlicmF0aW9uX3ZhbHVlcyhzY19taW4sIHNjX2Z1bGwpCgoKICAgICAgICBjYWxpYnJhdGlvbl9mYWN0b3IgPSAgKHNjX21pbiAtIHNjX2Z1bGwpIC8gc2Nfd2VpZ2h0CiAgICAgICAgcHJpbnQoImdldF9zY2FsZV9jYWxpYnJhdGlvbl9mYWN0b3IgdXNpbmcgKHt9LXt9KSAvIHt9ID0ge30gd2l0aCBpbnZlcnQgZmFjdG9yIG9mOiB7fSIuZm9ybWF0KHNjX21pbiwgc2NfZnVsbCwgc2Nfd2VpZ2h0LCBjYWxpYnJhdGlvbl9mYWN0b3IsIHNjX2ludmVydCkpCiAgICAgICAgcmV0dXJuIGNhbGlicmF0aW9uX2ZhY3RvciAqIHNjX2ludmVydA==", "recipe.py": "CmNsYXNzIFVTRVJfSU5URVJBQ1RJT05fTU9ERToKICAgIFVOS05PV04gPSAtMQogICAgU0NBTEUgPSAwCiAgICBDT05GSVJNID0gMQogICAgV0FJVCA9IDIKCmNsYXNzIGluZ3JlZGllbnQ6CgogICAgbmFtZTogc3RyID0gIiIKICAgIGFtb3VudDogaW50ID0gLTEKICAgIGlkOiBpbnQgPSAwCiAgICB1bml0OiBzdHIgPSAiIgoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBfbmFtZTogc3RyLCBfYW1vdW50OiBpbnQgPSAtMSwgX2lkOiBpbnQgPSAwLCBfdW5pdDogc3RyID0gIiIpOgogICAgICAgIHNlbGYubmFtZSA9IF9uYW1lCiAgICAgICAgc2VsZi5hbW91bnQgPSBfYW1vdW50CiAgICAgICAgc2VsZi5pZCA9IF9pZAogICAgICAgIHNlbGYudW5pdCA9IF91bml0CmNsYXNzIHJlY2lwZV9zdGVwOgoKICAgIGFjdGlvbjogVVNFUl9JTlRFUkFDVElPTl9NT0RFID0gVVNFUl9JTlRFUkFDVElPTl9NT0RFLlVOS05PV04KICAgIGluZ3JlZGllbnRfbmFtZTogc3RyID0gIiIKICAgIGN1cnJlbnRfc3RlcF90ZXh0OiBzdHIgPSAiLS0tIgogICAgdGFyZ2V0X3ZhbHVlOiBpbnQgPSAwCgoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBfYWN0aW9uOiBVU0VSX0lOVEVSQUNUSU9OX01PREUgPSBVU0VSX0lOVEVSQUNUSU9OX01PREUuVU5LTk9XTiwgX2luZ3JlZGllbnRfbmFtZTogc3RyID0gIiIsIF9jdXJyZW50X3N0ZXBfdGV4dDogc3RyID0gIi0tLSIsIF90YXJnZXRfdmFsdWU6IGludCA9IDApOgogICAgICAgIHNlbGYuYWN0aW9uID0gX2FjdGlvbgogICAgICAgIHNlbGYuaW5ncmVkaWVudF9uYW1lID0gX2luZ3JlZGllbnRfbmFtZQogICAgICAgIHNlbGYuY3VycmVudF9zdGVwX3RleHQgPSBfY3VycmVudF9zdGVwX3RleHQKICAgICAgICBzZWxmLnRhcmdldF92YWx1ZSA9IF90YXJnZXRfdmFsdWUKCiAgICAgICAgaWYgc2VsZi50YXJnZXRfdmFsdWUgaXMgTm9uZToKICAgICAgICAgICAgc2VsZi50YXJnZXRfdmFsdWUgPSAwCgogICAgZGVmIHRvX2RpY3Qoc2VsZikgLT4gZGljdDoKICAgICAgICByZXR1cm4gewogICAgICAgICAgICAnYWN0aW9uJzogc2VsZi5hY3Rpb24sCiAgICAgICAgICAgICdpbmdyZWRpZW50JyA6IHNlbGYuaW5ncmVkaWVudF9uYW1lLAogICAgICAgICAgICAnYW1vdW50Jzogc2VsZi50YXJnZXRfdmFsdWUsCiAgICAgICAgICAgICd0ZXh0Jzogc2VsZi5jdXJyZW50X3N0ZXBfdGV4dAogICAgICAgICAgICB9CiAgICAKICAgIGRlZiBmcm9tX2RpY3Qoc2VsZiwgX3N0ZXBfZGljdDogZGljdCk6CiAgICAgICAgaWYgJ2FjdGlvbicgaW4gX3N0ZXBfZGljdDoKICAgICAgICAgICAgc2VsZi5hY3Rpb24gPSBfc3RlcF9kaWN0WydhY3Rpb24nXQogICAgICAgIGlmICdpbmdyZWRpZW50JyBpbiBfc3RlcF9kaWN0OgogICAgICAgICAgICBzZWxmLmluZ3JlZGllbnRfbmFtZSA9IF9zdGVwX2RpY3RbJ2luZ3JlZGllbnQnXQogICAgICAgIGlmICdhbW91bnQnIGluIF9zdGVwX2RpY3Q6CiAgICAgICAgICAgIHNlbGYudGFyZ2V0X3ZhbHVlID0gX3N0ZXBfZGljdFsnYW1vdW50J10KICAgICAgICAgICAgCiAgICAgICAgaWYgJ3RleHQnIGluIF9zdGVwX2RpY3Q6CiAgICAgICAgICAgIHNlbGYuY3VycmVudF9zdGVwX3RleHQgPSBfc3RlcF9kaWN0Wyd0ZXh0J10KCiAgICAgICAgaWYgc2VsZi50YXJnZXRfdmFsdWUgaXMgTm9uZToKICAgICAgICAgICAgc2VsZi50YXJnZXRfdmFsdWUgPSAwCmNsYXNzIHJlY2lwZToKICAgIAogICAgbmFtZTogc3RyID0gIiIKICAgIGRlc2NyaXB0aW9uOiBzdHIgPSAiIgogICAgdmVyc2lvbjogc3RyID0gIjEuMC4wIgogICAgZmlsZW5hbWU6IHN0ciA9ICIiCiAgICBzdGVwczogbGlzdFtyZWNpcGVfc3RlcF0gPSBbXQogICAgY2F0ZWdvcmllczogbGlzdFtzdHJdID0gWyJldmVyeXRoaW5nIl0KICAgIHZhbGlkOiBib29sID0gRmFsc2UKCiAgICBjdXJyZW50X3N0ZXBfaW5kZXg6IGludCA9IC0xCgogICAgZGVmIF9faW5pdF9fKHNlbGYsIF9uYW1lOiBzdHIgPSAiUmVjaXBlIiwgX2Rlc2NyaXB0aW9uOnN0ciA9ICJBIG5pY2UgY29ja3RhaWwiLCBfdmVyc2lvbjogc3RyID0gIjEuMC4wIiwgX2NhdGVnb3JpZXM6IGxpc3Rbc3RyXSA9IFsiZXZlcnl0aGluZyJdKSAtPiBOb25lOgogICAgICAgIHNlbGYubmFtZSA9IF9uYW1lCiAgICAgICAgc2VsZi5kZXNjcmlwdGlvbiA9IF9kZXNjcmlwdGlvbgogICAgICAgIHNlbGYudmVyc2lvbiA9IF92ZXJzaW9uCgogICAgICAgIHNlbGYuZmlsZW5hbWUgPSBzZWxmLm5hbWUucmVwbGFjZSgiICIsICJfIikucmVwbGFjZSgiLnJlY2lwZSIsICIiKQogICAgICAgIHNlbGYuZmlsZW5hbWUgPSBzZWxmLmZpbGVuYW1lICsgIi5yZWNpcGUiCgogICAgICAgIHNlbGYuY2F0ZWdvcmllcyA9IF9jYXRlZ29yaWVzCiAgICAgICAgaWYgbGVuKHNlbGYuY2F0ZWdvcmllcykgPD0gMDoKICAgICAgICAgICAgc2VsZi5jYXRlZ29yaWVzLmFwcGVuZCgiZXZlcnl0aGluZyIpCgogICAgICAgCiAgICAgICAgc2VsZi5zdGVwcyA9IFtdCiAgICAgICAgc2VsZi5yZXNldF9zdGVwcygpCgogICAKCiAgICBkZWYgYWRkX3N0ZXAoc2VsZiwgX3N0ZXA6IHJlY2lwZV9zdGVwKToKICAgICAgICBzZWxmLnN0ZXBzLmFwcGVuZChfc3RlcCkKICAgICAgICAgICAKCiAgICAKICAgIGRlZiBmcm9tX2RpY3Qoc2VsZiwgX2pzb25fZGljdDogZGljdCkgLT4gYm9vbDoKICAgICAgICBpZiAnbmFtZScgaW4gX2pzb25fZGljdDoKICAgICAgICAgICAgc2VsZi5uYW1lID0gX2pzb25fZGljdFsnbmFtZSddCiAgICAgICAgaWYgJ2Rlc2NyaXB0aW9uJyBpbiBfanNvbl9kaWN0OgogICAgICAgICAgICBzZWxmLmRlc2NyaXB0aW9uID0gX2pzb25fZGljdFsnZGVzY3JpcHRpb24nXQogICAgICAgIGlmICd2ZXJzaW9uJyBpbiBfanNvbl9kaWN0OgogICAgICAgICAgICBzZWxmLnZlcnNpb24gPSBfanNvbl9kaWN0Wyd2ZXJzaW9uJ10KCiAgICAgICAgaWYgJ3N0ZXBzJyBpbiBfanNvbl9kaWN0OgogICAgICAgICAgICBzdGVwcyA9IF9qc29uX2RpY3RbJ3N0ZXBzJ10KICAgICAgICAgICAgc2VsZi5zdGVwcyA9IFtdCiAgICAgICAgICAgIGlmIGxlbihzdGVwcykgPiAwOgogICAgICAgICAgICAgICAgZm9yIHMgaW4gc3RlcHM6CiAgICAgICAgICAgICAgICAgICAgc3RlcDogcmVjaXBlX3N0ZXAgPSByZWNpcGVfc3RlcCgpCiAgICAgICAgICAgICAgICAgICAgc3RlcC5mcm9tX2RpY3QocykKICAgICAgICAgICAgICAgICAgICBzZWxmLmFkZF9zdGVwKHN0ZXApCiAgICAgICAgCiAgICAgIAogICAgICAgIHNlbGYuZmlsZW5hbWUgPSBzZWxmLm5hbWUucmVwbGFjZSgiICIsICJfIikucmVwbGFjZSgiLnJlY2lwZSIsICIiKQogICAgICAgIHNlbGYuZmlsZW5hbWUgPSBzZWxmLmZpbGVuYW1lICsgIi5yZWNpcGUiCiAgICAgICAgc2VsZi52YWxpZCA9IFRydWUKICAgICAgICAKICAgIGRlZiB0b19kaWN0KHNlbGYsIF9hZGRfZmlsZW5hbWVfYXNfcm9vdF9rZXk6IGJvb2wgPSBGYWxzZSkgLT4gZGljdDoKICAgICAgICByZXQ6IGRpY3QgPSB7fQogICAgICAgIHJldFtzZWxmLmZpbGVuYW1lXSA9IHsKICAgICAgICAgICAgJ25hbWUnOiBzZWxmLm5hbWUsCiAgICAgICAgICAgICdkZXNjcmlwdGlvbic6IHNlbGYuZGVzY3JpcHRpb24sCiAgICAgICAgICAgICd2ZXJzaW9uJzogc2VsZi52ZXJzaW9uLAogICAgICAgICAgICAnZmlsZW5hbWUnOiBzZWxmLmZpbGVuYW1lCiAgICAgICAgfQogICAgICAgICMgQUREIFNURVBTCiAgICAgICAgcmV0W3NlbGYuZmlsZW5hbWVdWydzdGVwcyddID0gW10KICAgICAgICBmb3IgcyBpbiBzZWxmLnN0ZXBzOgogICAgICAgICAgICByZXRbc2VsZi5maWxlbmFtZV1bJ3N0ZXBzJ10uYXBwZW5kKHMudG9fZGljdCgpKQoKICAgIAogICAgICAgIGlmIF9hZGRfZmlsZW5hbWVfYXNfcm9vdF9rZXk6CiAgICAgICAgICAgIHJldHVybiByZXQKCiAgICAgICAgcmV0dXJuIHJldFtzZWxmLmZpbGVuYW1lXQoKCiAgICBkZWYgaXNfdmFsaWQoc2VsZikgLT4gYm9vbDoKICAgICAgICByZXR1cm4gc2VsZi52YWxpZAoKCiAgICBkZWYgZ2V0X2Rlc2NyaXB0aW9uKHNlbGYpIC0+IHN0cjoKICAgICAgICByZXR1cm4gc2VsZi5kZXNjcmlwdGlvbgoKICAgIGRlZiBnZXRfY2F0ZWdvcmllcyhzZWxmKSAtPiBsaXN0W3N0cl06CiAgICAgICAgcmV0dXJuIHNlbGYuY2F0ZWdvcmllcwoKICAgIAoKCiAgICBkZWYgZ2V0X3JlY2lwZV9pbmZvcm1hdGlvbihzZWxmKSAtPiB0dXBsZVtzdHIsIHN0cl06CiAgICAgICAgcmV0dXJuIChzZWxmLm5hbWUsIHNlbGYuZGVzY3JpcHRpb24pCiAgICAKCiAgICBkZWYgc3dpdGNoX25leHRfc3RlcChzZWxmKToKICAgICAgICBpZiBsZW4oc2VsZi5zdGVwcykgPCAwOgogICAgICAgICAgICBzZWxmLmN1cnJlbnRfc3RlcF9pbmRleCA9IC0xCiAgICAgICAgICAgIHJldHVybgogICAgICAgIHNlbGYuY3VycmVudF9zdGVwX2luZGV4ID0gKHNlbGYuY3VycmVudF9zdGVwX2luZGV4ICsgMSkgJSBsZW4oc2VsZi5zdGVwcykKICAgICAgICAgICAgICAgICAgCiAgICBkZWYgc3dpdGNoX3ByZXZfc3RlcChzZWxmKToKICAgICAgICBpZiBsZW4oc2VsZi5zdGVwcykgPCAwOgogICAgICAgICAgICBzZWxmLmN1cnJlbnRfc3RlcF9pbmRleCA9IC0xCiAgICAgICAgICAgIHJldHVybgogICAgICAgIHNlbGYuY3VycmVudF9zdGVwX2luZGV4ID0gKHNlbGYuY3VycmVudF9zdGVwX2luZGV4IC0gMSkgJSBsZW4oc2VsZi5zdGVwcykKCiAgICBkZWYgcmVzZXRfc3RlcHMoc2VsZik6CiAgICAgICAgaWYgbGVuKHNlbGYuc3RlcHMpIDwgMDoKICAgICAgICAgICAgc2VsZi5jdXJyZW50X3N0ZXBfaW5kZXggPSAtMQogICAgICAgICAgICByZXR1cm4KICAgICAgICBzZWxmLmN1cnJlbnRfc3RlcF9pbmRleCA9IDAKICAgIAoKICAgIGRlZiBnZXRfaW5ncmVkaWVudHMoc2VsZikgLT4gbGlzdFtpbmdyZWRpZW50XToKICAgICAgICByZXM6IGxpc3RbaW5ncmVkaWVudF0gPSBbXQogICAgICAgIGluZ3JlZGllbnRfZGljdDogZGljdCA9IHt9CiAgICAgICAgIyBERVRFUk0gVEhFIFRPVEFMIElOR1JFRElFTlQgQU1PVU5UIE9WRVIgQUxMIFNURVBTCiAgICAgICAgIyBUT0RPIFJFV09SSwogICAgICAgIGZvciBzIGluIHNlbGYuc3RlcHM6CiAgICAgICAgICAgICMgU0tJUCBVU0VSIEFDVElPTlMgV0lUSCBOTyBQSFlTSUNBTCBJTkdSRURJRU5UUwogICAgICAgICAgICBpZiBzLmFjdGlvbiA9PSBVU0VSX0lOVEVSQUNUSU9OX01PREUuV0FJVCBvciBzLmFjdGlvbiA9PSBVU0VSX0lOVEVSQUNUSU9OX01PREUuVU5LTk9XTjoKICAgICAgICAgICAgICAgIGNvbnRpbnVlCgoKICAgICAgICAgICAgaWYgbm90IHMuaW5ncmVkaWVudF9uYW1lIGluIGluZ3JlZGllbnRfZGljdDoKICAgICAgICAgICAgICAgIGluZ3JlZGllbnRfZGljdFtzLmluZ3JlZGllbnRfbmFtZV0gPSB7J2Ftb3VudCc6IDAsICd1bml0JzogJyd9CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGlmIHMuYWN0aW9uID09IFVTRVJfSU5URVJBQ1RJT05fTU9ERS5TQ0FMRToKICAgICAgICAgICAgICAgICAgICBpbmdyZWRpZW50X2RpY3Rbcy5pbmdyZWRpZW50X25hbWVdWyd1bml0J10gPSAnZycKICAgICAgICAgICAgICAgIGVsaWYgcy5hY3Rpb24gPT0gVVNFUl9JTlRFUkFDVElPTl9NT0RFLkNPTkZJUk06CiAgICAgICAgICAgICAgICAgICAgaW5ncmVkaWVudF9kaWN0W3MuaW5ncmVkaWVudF9uYW1lXVsndW5pdCddID0gJ3gnCgogICAgICAgICAgICBpZiBzLnRhcmdldF92YWx1ZSA+IDA6CiAgICAgICAgICAgICAgICBpbmdyZWRpZW50X2RpY3Rbcy5pbmdyZWRpZW50X25hbWVdWydhbW91bnQnXSA9IGluZ3JlZGllbnRfZGljdFtzLmluZ3JlZGllbnRfbmFtZV1bJ2Ftb3VudCddICsgcy50YXJnZXRfdmFsdWUKCiAgICAgICAgICAgIAogICAgICAgICMgUkVBU1NFTUJMRSBESUNUIElOVE8gQVJSQVkKICAgICAgICBpbmRleDogaW50ID0gMAogICAgICAgIGZvciBrLCB2IGluIGluZ3JlZGllbnRfZGljdC5pdGVtcygpOgogICAgICAgICAgICByZXMuYXBwZW5kKGluZ3JlZGllbnQoaywgdlsnYW1vdW50J10sIGluZGV4LCB2Wyd1bml0J10pKQogICAgICAgICAgICBpbmRleCA9IGluZGV4ICsxCgogICAgICAgIHJldHVybiByZXMKICAgICAgIAogICAgCiAgICBkZWYgZ2V0X2luZ3JlZGllbnRzX2FzX25hbWVzX2xpc3Qoc2VsZiwgX3dpdGhvdXRfYW1vdW50OiBib29sID0gVHJ1ZSkgLT4gbGlzdFtzdHJdOgogICAgICAgIHJ0OiBsaXN0W3N0cl0gPSBbXQogICAgICAgIGZvciBpIGluIHNlbGYuZ2V0X2luZ3JlZGllbnRzKCk6CiAgICAgICAgICAgIGlmIGkuYW1vdW50IGlzIE5vbmUgb3IgaS5hbW91bnQgPD0gMCBvciBfd2l0aG91dF9hbW91bnQ6CiAgICAgICAgICAgICAgICBydC5hcHBlbmQoInt9Ii5mb3JtYXQoaS5uYW1lKSkKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJ0LmFwcGVuZCgie317fSB7fSIuZm9ybWF0KGkuYW1vdW50LCBpLnVuaXQsIGkubmFtZSkpCiAgICAKICAgICAgICByZXR1cm4gcnQKCgogICAgZGVmIGdldF9jdXJyZW50X3JlY2lwZV9zdGVwKHNlbGYpIC0+IHR1cGxlW3JlY2lwZV9zdGVwLCBib29sXTogCiAgICAgICAgaWYgbGVuKHNlbGYuc3RlcHMpIDw9IDAgb3Igc2VsZi5jdXJyZW50X3N0ZXBfaW5kZXggPCAwOgogICAgICAgICAgICBwcmludCgic2VsZi5jdXJyZW50X3N0ZXBfaW5kZXggaXMgaW52YWxpZCAvIG91dCBvZiByYW5nZSIpCiAgICAgICAgICAgIHJldHVybiByZWNpcGVfc3RlcCgpLCBUcnVlCiAgICAgICAgdHJ5OgogICAgICAgICAgICAjREVURVJNIElGIFRISVMgSVMgVEhFIExBU1QgU1RFUAogICAgICAgICAgICBpc19lbmRzdGVwOiBib29sID0gRmFsc2UKICAgICAgICAgICAgaWYgc2VsZi5jdXJyZW50X3N0ZXBfaW5kZXggPj0gbGVuKHNlbGYuc3RlcHMpIC0xOgogICAgICAgICAgICAgICAgaXNfZW5kc3RlcCA9IFRydWUKCiAgICAgICAgICAgIHJldHVybiBzZWxmLnN0ZXBzW3NlbGYuY3VycmVudF9zdGVwX2luZGV4XSwgaXNfZW5kc3RlcAogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgcHJpbnQoZSkKCiAgICAgICAgcmV0dXJuIHJlY2lwZV9zdGVwKCksIFRydWUKICAgICAgICAKICAgIAoKCgoKCgppZiBfX25hbWVfXyA9PSAiX19tYWluX18iOgogICAgaW1wb3J0IGV4YW1wbGVfcmVjaXBlcwoKICAgIHIgPSBleGFtcGxlX3JlY2lwZXMuRVhBTVBMRV9SRUNJUEVTX0NPTExFQ1RJT05fVEVTVCgpCiAgICBpID0gci5nZXRfaW5ncmVkaWVudHMoKQogICAgbCA9IHIuZ2V0X2luZ3JlZGllbnRzX2FzX25hbWVzX2xpc3QoKQogICAgZXIgPSAwCgogICAg", "main.py": "ZnJvbSB1dGltZSBpbXBvcnQgc2xlZXBfdXMNCmltcG9ydCB1YXN5bmNpbyBhcyBhaW8NCmZyb20gYWlvYnV0dG9uIGltcG9ydCBBSU9CdXR0b24NCmltcG9ydCBtYWNoaW5lDQppbXBvcnQgaGVscGVyDQpmcm9tIFNjYWxlcyBpbXBvcnQgU2NhbGVJbnRlcmZhY2UNCmZyb20gbGVkcmluZyBpbXBvcnQgbGVkcmluZw0KaW1wb3J0IHN5c3RlbV9jb21tYW5kDQojIE5FRURFRCBGT1IgRU5DT0RFUg0KZnJvbSBzeXMgaW1wb3J0IHBsYXRmb3JtDQppZiAnZXNwJyBpbiBwbGF0Zm9ybTogDQogICAgZnJvbSByb3RhcnlfaXJxX2VzcCBpbXBvcnQgUm90YXJ5SVJRDQplbGlmICdycCcgaW4gcGxhdGZvcm06DQogICAgZnJvbSByb3RhcnlfaXJxX3JwMiBpbXBvcnQgUm90YXJ5SVJRDQplbHNlOg0KICAgIGZyb20gcm90YXJ5X2lycV9weWIgaW1wb3J0IFJvdGFyeUlSUQ0KDQoNCmltcG9ydCBjb25maWcNCmltcG9ydCByZWNpcGVfbG9hZGVyDQppbXBvcnQgcmVjaXBlX3VwZGF0ZXINCmZyb20gdWkgaW1wb3J0IHVpDQppbXBvcnQgc2V0dGluZ3MNCmltcG9ydCBzdGF0aWNfbW9kdWxlcy5tZW51X21hbmFnZXIgYXMgbWVudV9tYW5hZ2VyDQojIFBMVUdJTlMNCmltcG9ydCBtZW51X2VudHJ5X3N1Ym1lbnUNCmltcG9ydCBtZW51X2VudHJ5X3JlY2lwZV91cGRhdGUNCmltcG9ydCBtZW51X2VudHJ5X3JlY2lwZV9lZGl0b3INCmltcG9ydCBtZW51X2VudHJ5X3NjYWxlDQppbXBvcnQgc3RhdGljX21vZHVsZXMubWVudV9lbnRyeV9pbmZvIGFzIG1lbnVfZW50cnlfaW5mbw0KaW1wb3J0IG1lbnVfZW50cnlfcmVjaXBlDQppbXBvcnQgc3RhdGljX21vZHVsZXMubWVudV9lbnRyeV9oYXJkd2FyZXRlc3QgYXMgbWVudV9lbnRyeV9oYXJkd2FyZXRlc3QNCmltcG9ydCBtZW51X2VudHJ5X2NhbGlicmF0aW9uDQppbXBvcnQgc3RhdGljX21vZHVsZXMubWVudV9lbnRyeV9yZXN0b3JlIGFzIG1lbnVfZW50cnlfcmVzdG9yZQ0KDQoNClRJTUVfRUxBUFNFRF9ESVZJREVSOiBpbnQgPSAyDQpwcmludCgibWFpbjogX19lbnRyeV9fIikNCg0KQlVUVE9OX0lOREVYX0xFRlQgPSAwDQpCVVRUT05fSU5ERVhfUklHSFQgPSAxDQpCVVRUT05fSU5ERVhfTUVOVSA9IDINCg0KQlVUVE9OX1BSRVNTRUQgPSAwDQpCVVRUT05fSE9MRCA9IDENCkJVVFRPTl9SRUxFQVNFRCA9IDINCg0KbGFzdF9sZWZ0X2J1dHRvbl9zdGF0ZTogaW50ID0gMA0KYnV0dG9uX3N0YXRlX2RpY3Q6IGxpc3QgPSBbLTEsIC0xLCAtMV0NCmVuY29kZXJfbWlkZGxlX3BvaW50OiBpbnQgPSAxDQpjdXJyZW50X2J1dHRvbl9jbWQ6IHN5c3RlbV9jb21tYW5kLnN5c3RlbV9jb21tYW5kID0gc3lzdGVtX2NvbW1hbmQuc3lzdGVtX2NvbW1hbmQoKQ0KY3VycmVudF9idXR0b25fY21kLnR5cGUgPSBzeXN0ZW1fY29tbWFuZC5zeXN0ZW1fY29tbWFuZC5DT01NQU5EX1RZUEVfTkFWSUdBVElPTg0KIyBHRU5FUkFURUQgU1lTVEVNIEVWRU5UUyBERVBFTklORyBPTiBUSEUgUFJFU1NFRCBCVVRUT04gVE8gTkFWSUdBVEUgVEhPVUdIVCBNRU5VUw0KZGVmIGdlbmVyYXRlX2J1dHRvbl9zdGF0ZShfYnV0dG9uX2luZGV4OiBpbnQsIF9idXR0b25fZXZlbnQ6IGludCwgX2J1dHRvbl9zdGF0ZTogYm9vbCk6DQoNCiAgICBpZiBidXR0b25fc3RhdGVfZGljdFtfYnV0dG9uX2luZGV4XSA9PSBCVVRUT05fUFJFU1NFRCBhbmQgX2J1dHRvbl9ldmVudCA9PSBCVVRUT05fUkVMRUFTRUQ6DQogICAgICAgIGlmIF9idXR0b25faW5kZXggPT0gQlVUVE9OX0lOREVYX0xFRlQ6DQogICAgICAgICAgICBjdXJyZW50X2J1dHRvbl9jbWQuYWN0aW9uID0gc3lzdGVtX2NvbW1hbmQuc3lzdGVtX2NvbW1hbmQuTkFWSUdBVElPTl9MRUZUDQogICAgICAgIGVsaWYgX2J1dHRvbl9pbmRleCA9PSBCVVRUT05fSU5ERVhfUklHSFQ6DQogICAgICAgICAgICBjdXJyZW50X2J1dHRvbl9jbWQuYWN0aW9uID0gc3lzdGVtX2NvbW1hbmQuc3lzdGVtX2NvbW1hbmQuTkFWSUdBVElPTl9SSUdIVA0KICAgICAgICBlbGlmIF9idXR0b25faW5kZXggPT0gQlVUVE9OX0lOREVYX01FTlU6DQogICAgICAgICAgICBjdXJyZW50X2J1dHRvbl9jbWQuYWN0aW9uID0gc3lzdGVtX2NvbW1hbmQuc3lzdGVtX2NvbW1hbmQuTkFWSUdBVElPTl9FTlRFUg0KDQogICAgICAgIG1lbnVfbWFuYWdlci5tZW51X21hbmFnZXIoKS5wcm9jZXNzX3VzZXJfY29tbWFuZHMoY3VycmVudF9idXR0b25fY21kKQ0KDQogICAgZWxpZiBfYnV0dG9uX2V2ZW50ID09IEJVVFRPTl9IT0xEOg0KICAgICAgICBpZiBfYnV0dG9uX2luZGV4ID09IEJVVFRPTl9JTkRFWF9MRUZUOg0KICAgICAgICAgICAgY3VycmVudF9idXR0b25fY21kLmFjdGlvbiA9IHN5c3RlbV9jb21tYW5kLnN5c3RlbV9jb21tYW5kLk5BVklHQVRJT05fRVhJVA0KICAgICAgICBlbGlmIF9idXR0b25faW5kZXggPT0gQlVUVE9OX0lOREVYX1JJR0hUOg0KICAgICAgICAgICAgY3VycmVudF9idXR0b25fY21kLmFjdGlvbiA9IHN5c3RlbV9jb21tYW5kLnN5c3RlbV9jb21tYW5kLk5BVklHQVRJT05fRU5URVINCiAgICAgICAgZWxpZiBfYnV0dG9uX2luZGV4ID09IEJVVFRPTl9JTkRFWF9NRU5VOg0KICAgICAgICAgICAgY3VycmVudF9idXR0b25fY21kLmFjdGlvbiA9IHN5c3RlbV9jb21tYW5kLnN5c3RlbV9jb21tYW5kLk5BVklHQVRJT05fRVhJVA0KDQogICAgICAgIA0KICAgICAgICBtZW51X21hbmFnZXIubWVudV9tYW5hZ2VyKCkucHJvY2Vzc191c2VyX2NvbW1hbmRzKGN1cnJlbnRfYnV0dG9uX2NtZCkNCiAgICANCiAgICBidXR0b25fc3RhdGVfZGljdFtfYnV0dG9uX2luZGV4XSA9IF9idXR0b25fZXZlbnQNCiAgIA0KICAgDQogICANCg0KDQoNCmlmIF9fbmFtZV9fID09ICJfX21haW5fXyI6DQogICAgDQogICAgIyBJTklUIFJFQ0lQRSBMT0FERVIgQU5EIElOSVQgU0QgQ0FSRA0KICAgIHNldHRpbmdzLnNldHRpbmdzKCkubGlzdF9maWxlcygpDQogICAgIyBSRUNJUEUgU1RPUkFHRQ0KICAgIHJlY2lwZV9sb2FkZXIucmVjaXBlX2xvYWRlcigpLmxpc3RfcmVjcGllcygpDQogICAgIyBJTklUIExFRCBSSU5HDQogICAgbGVkcmluZygpLnNldF9uZW9waXhlbF9mdWxsX2hzdihsZWRyaW5nKCkuQ09MT1JfUFJFU0VUX0hTVl9IX19CTFVFKQ0KICAgICMgSU5JVCBVSQ0KICAgIHVpKCkuY2xlYXIoKQ0KICAgICMgSU5JVCBTQ0FMRQ0KICAgIFNjYWxlSW50ZXJmYWNlKCkudGFyZSgpDQoNCiAgICAjIElOSVQgVVNFUiBJTlBVVCBCVVRUT05TDQogICAgbGVmdF9idXR0b25fcGluOiBtYWNoaW5lLlBpbiA9IG1hY2hpbmUuUGluKGNvbmZpZy5DRkdfQlVUVE9OX0xFRlRfUElOLCBtYWNoaW5lLlBpbi5JTiwgbWFjaGluZS5QaW4uUFVMTF9VUCkNCiAgICBsZWZ0X2J1dHRvbiA9IEFJT0J1dHRvbihsYW1iZGEgYnRuOiBub3QgbGVmdF9idXR0b25fcGluLnZhbHVlKCkpDQogICAgbGVmdF9idXR0b24uc2V0X2hvbGRfbXMoY29uZmlnLkNGR19VU0VSX0xPTkdfQlVUVE9OX1BSRVNTX1RJTUUpDQogICAgIyBSZWdpc3RlciBidXR0b24gZXZlbnQgaGFuZGxlcnMNCiAgICBsZWZ0X2J1dHRvbi5zZXRfaG9sZF9oYW5kbGVyKGxhbWJkYSBidG46IGdlbmVyYXRlX2J1dHRvbl9zdGF0ZShCVVRUT05fSU5ERVhfTEVGVCwgQlVUVE9OX0hPTEQsIGJ0bi5nZXRfZGVib3VuY2VkKCkpKSAgIA0KICAgIGxlZnRfYnV0dG9uLnNldF9wcmVzc19oYW5kbGVyKGxhbWJkYSBidG46IGdlbmVyYXRlX2J1dHRvbl9zdGF0ZShCVVRUT05fSU5ERVhfTEVGVCwgQlVUVE9OX1BSRVNTRUQsIGJ0bi5nZXRfZGVib3VuY2VkKCkpKQ0KICAgIGxlZnRfYnV0dG9uLnNldF9yZWxlYXNlX2hhbmRsZXIobGFtYmRhIGJ0bjogZ2VuZXJhdGVfYnV0dG9uX3N0YXRlKEJVVFRPTl9JTkRFWF9MRUZULCBCVVRUT05fUkVMRUFTRUQsIGJ0bi5nZXRfZGVib3VuY2VkKCkpKSANCiAgICANCiAgICByaWdodF9idXR0b25fcGluOiBtYWNoaW5lLlBpbiA9IG1hY2hpbmUuUGluKGNvbmZpZy5DRkdfQlVUVE9OX1JJR0hUX1BJTiwgbWFjaGluZS5QaW4uSU4sIG1hY2hpbmUuUGluLlBVTExfVVApDQogICAgcmlnaHRfYnV0dG9uID0gQUlPQnV0dG9uKGxhbWJkYSBidG46IG5vdCByaWdodF9idXR0b25fcGluLnZhbHVlKCkpDQogICAgcmlnaHRfYnV0dG9uLnNldF9ob2xkX21zKGNvbmZpZy5DRkdfVVNFUl9MT05HX0JVVFRPTl9QUkVTU19USU1FKQ0KICAgICMgUmVnaXN0ZXIgYnV0dG9uIGV2ZW50IGhhbmRsZXJzDQogICAgcmlnaHRfYnV0dG9uLnNldF9ob2xkX2hhbmRsZXIobGFtYmRhIGJ0bjogZ2VuZXJhdGVfYnV0dG9uX3N0YXRlKEJVVFRPTl9JTkRFWF9SSUdIVCwgQlVUVE9OX0hPTEQsIGJ0bi5nZXRfZGVib3VuY2VkKCkpKSAgIA0KICAgIHJpZ2h0X2J1dHRvbi5zZXRfcHJlc3NfaGFuZGxlcihsYW1iZGEgYnRuOiBnZW5lcmF0ZV9idXR0b25fc3RhdGUoQlVUVE9OX0lOREVYX1JJR0hULCBCVVRUT05fUFJFU1NFRCwgYnRuLmdldF9kZWJvdW5jZWQoKSkpDQogICAgcmlnaHRfYnV0dG9uLnNldF9yZWxlYXNlX2hhbmRsZXIobGFtYmRhIGJ0bjogZ2VuZXJhdGVfYnV0dG9uX3N0YXRlKEJVVFRPTl9JTkRFWF9SSUdIVCwgQlVUVE9OX1JFTEVBU0VELCBidG4uZ2V0X2RlYm91bmNlZCgpKSkgDQogICAgDQoNCiAgICANCiAgICAjIyBSRUdJU1RFUiBFTkNPREVSIEJVVFRPTiBFVkVOVFMgQlkgUkVNQVBQSU5HIFRIRSBFTkNPREVSIFNXSVRDSCANCiAgICBlbmNvZGVyX2J1dHRvbl9waW46IG1hY2hpbmUuUGluID0gbWFjaGluZS5QaW4oY29uZmlnLkNGR19FTkNPREVSX1NXX1BJTiwgbWFjaGluZS5QaW4uSU4sIG1hY2hpbmUuUGluLlBVTExfVVApDQogICAgI3doaWxlIFRydWU6DQogICAgIyAgICBwcmludChlbmNvZGVyX2J1dHRvbl9waW4udmFsdWUoKSkNCiAgICANCiAgICBlbmNvZGVyX2J1dHRvbiA9IEFJT0J1dHRvbihsYW1iZGEgYnRuOiBub3QgZW5jb2Rlcl9idXR0b25fcGluLnZhbHVlKCkpDQogICAgZW5jb2Rlcl9idXR0b24uc2V0X2hvbGRfaGFuZGxlcihsYW1iZGEgYnRuOiBnZW5lcmF0ZV9idXR0b25fc3RhdGUoQlVUVE9OX0lOREVYX01FTlUsIEJVVFRPTl9IT0xELCBidG4uZ2V0X2RlYm91bmNlZCgpKSkgICANCiAgICBlbmNvZGVyX2J1dHRvbi5zZXRfcHJlc3NfaGFuZGxlcihsYW1iZGEgYnRuOiBnZW5lcmF0ZV9idXR0b25fc3RhdGUoQlVUVE9OX0lOREVYX01FTlUsIEJVVFRPTl9QUkVTU0VELCBidG4uZ2V0X2RlYm91bmNlZCgpKSkNCiAgICBlbmNvZGVyX2J1dHRvbi5zZXRfcmVsZWFzZV9oYW5kbGVyKGxhbWJkYSBidG46IGdlbmVyYXRlX2J1dHRvbl9zdGF0ZShCVVRUT05fSU5ERVhfTUVOVSwgQlVUVE9OX1JFTEVBU0VELCBidG4uZ2V0X2RlYm91bmNlZCgpKSkgDQogICAgDQogICAgIyBDT05GSUdVUkUgRU5DT0RFUg0KICAgIGVuY29kZXI6IFJvdGFyeUlSUSA9IFJvdGFyeUlSUShwaW5fbnVtX2Nsaz1jb25maWcuQ0ZHX0VOQ09ERVJfQ0xLX1BJTiwgcGluX251bV9kdD1jb25maWcuQ0ZHX0VOQ09ERVJfRFRfUElOLCBtaW5fdmFsPWVuY29kZXJfbWlkZGxlX3BvaW50LWVuY29kZXJfbWlkZGxlX3BvaW50LCBtYXhfdmFsPWVuY29kZXJfbWlkZGxlX3BvaW50KjIsIHJldmVyc2U9Y29uZmlnLkNGR19FTkNPREVSX0lOVkVSVCwgcmFuZ2VfbW9kZT1Sb3RhcnlJUlEuUkFOR0VfV1JBUCkNCiAgICBlbmNvZGVyLnNldF9jdXJyZW50X3ZhbHVlKGVuY29kZXJfbWlkZGxlX3BvaW50KQ0KICAgICMgSU5JVCBNRU5VIFNZU1RFTQ0KICAgIA0KICAgICMgQUREIFJFQ0lQRVMNCiAgICBmb3IgciBpbiByZWNpcGVfbG9hZGVyLnJlY2lwZV9sb2FkZXIoKS5saXN0X3JlY3BpZXMoX2luY2x1ZGVfZGVzY3JpcHRpb249VHJ1ZSk6DQogICAgICAgIGZpbGVuYW1lLCBuYW1lLCBkZXNjcmlwdGlvbiA9IHINCiAgICAgICAgcHJpbnQoImFkZGluZyByZWNpcGUgZW50cnk6IHt9Ii5mb3JtYXQoZmlsZW5hbWUpKQ0KICAgICAgICAjIG5hbWUgZGVzY3JpcHRpb24gYXJlIG9ubHkgdXNlZCBmb3IgbWVudSBlbnRyaWVzLCByZWNpcGUgd2lsbCBiZSBsb2FkZWQgYWdhaW4gYnkgZmlsZW5hbWUNCiAgICAgICAgbWVudV9tYW5hZ2VyLm1lbnVfbWFuYWdlcigpLmFkZF9zdWJlbnRyaWVzKG1lbnVfZW50cnlfcmVjaXBlLm1lbnVfZW50cnlfcmVjaXBlKGZpbGVuYW1lLCBuYW1lLCBkZXNjcmlwdGlvbikpDQoNCiAgICANCiAgICANCiAgICAjIEFERCBGVVJUSEVSIFNZU1RFTSBNRU5VUw0KICAgIG1lbnVfbWFuYWdlci5tZW51X21hbmFnZXIoKS5hZGRfc3ViZW50cmllcyhtZW51X2VudHJ5X3NjYWxlLm1lbnVfZW50cnlfc2NhbGUoKSkNCg0KICAgICMgQUREIFNZU1RFTSBNRU5VUw0KICAgIHN5c3RlbV9tZW51OiBtZW51X2VudHJ5X3N1Ym1lbnUubWVudV9lbnRyeV9zdWJtZW51ID0gbWVudV9lbnRyeV9zdWJtZW51Lm1lbnVfZW50cnlfc3VibWVudSgiU1lTVEVNIiwgIkFDQ0VTUyBTWVNURU0gU0VUVElOR1MiKQ0KICAgIHN5c3RlbV9tZW51LmFkZF9zdWJlbnRyaWVzKG1lbnVfZW50cnlfY2FsaWJyYXRpb24ubWVudV9lbnRyeV9jYWxpYnJhdGlvbigpKQ0KICAgIHN5c3RlbV9tZW51LmFkZF9zdWJlbnRyaWVzKG1lbnVfZW50cnlfaW5mby5tZW51X2VudHJ5X2luZm8oKSkNCiAgICBzeXN0ZW1fbWVudS5hZGRfc3ViZW50cmllcyhtZW51X2VudHJ5X3Jlc3RvcmUubWVudV9lbnRyeV9yZXN0b3JlKCkpDQogICAgaWYgY29uZmlnLkNGR19ERUJVRzoNCiAgICAgICAgc3lzdGVtX21lbnUuYWRkX3N1YmVudHJpZXMobWVudV9lbnRyeV9oYXJkd2FyZXRlc3QubWVudV9lbnRyeV9oYXJkd2FyZXRlc3QoKSkNCiAgICANCiAgICAjIEFERCBSRUNJUEUgVVBEQVRFIEZVTkNUSU9OUw0KICAgIGlmIHJlY2lwZV91cGRhdGVyLnJlY2lwZV91cGRhdGVfaGVscGVyLmhhc19uZXR3b3JrX2NhcGFiaWxpdGllcygpOg0KICAgICAgICBzeXN0ZW1fbWVudS5hZGRfc3ViZW50cmllcyhtZW51X2VudHJ5X3JlY2lwZV91cGRhdGUubWVudV9lbnRyeV9yZWNpcGVfdXBkYXRlKCkpDQogICAgICAgIHN5c3RlbV9tZW51LmFkZF9zdWJlbnRyaWVzKG1lbnVfZW50cnlfcmVjaXBlX2VkaXRvci5tZW51X2VudHJ5X3JlY2lwZV9lZGl0b3IoKSkNCg0KDQogICAgbWVudV9tYW5hZ2VyLm1lbnVfbWFuYWdlcigpLmFkZF9zdWJlbnRyaWVzKHN5c3RlbV9tZW51KQ0KDQogICAgYXN5bmMgZGVmIG1haW5fdGFzaygpOg0KICAgICAgICANCiAgICAgICAgbGFzdF9zY2FsZV91cGRhdGUgPSBoZWxwZXIubWlsbGlzKCkNCiAgICAgICAgbGFzdF90aW1lcl91cGRhdGUgPSBoZWxwZXIubWlsbGlzKCkNCg0KICAgICAgICAjIERFQ0xFQVJFIFNPTUUgU1lTVEVNIFNUQVRFIE1FU1NBR0VTIElOIE9SREVSIFRPIEFDVk9JRCBSRUFMTE9DQVRJT04NCiAgICAgICAgY3VycmVudF9zY2FsZV9jbWQ6IHN5c3RlbV9jb21tYW5kLnN5c3RlbV9jb21tYW5kID0gc3lzdGVtX2NvbW1hbmQuc3lzdGVtX2NvbW1hbmQoc3lzdGVtX2NvbW1hbmQuc3lzdGVtX2NvbW1hbmQuQ09NTUFORF9UWVBFX1NDQUxFX1ZBTFVFLCBzeXN0ZW1fY29tbWFuZC5zeXN0ZW1fY29tbWFuZC5TQ0FMRV9DVVJSRU5UX1ZBTFVFKQ0KICAgICAgICBjdXJyZW50X3RpbWVydGlja19jbWQ6IHN5c3RlbV9jb21tYW5kLnN5c3RlbV9jb21tYW5kID0gc3lzdGVtX2NvbW1hbmQuc3lzdGVtX2NvbW1hbmQoc3lzdGVtX2NvbW1hbmQuc3lzdGVtX2NvbW1hbmQuQ09NTUFORF9UWVBFX1RJTUVSX0lSUSwgc3lzdGVtX2NvbW1hbmQuc3lzdGVtX2NvbW1hbmQuVElNRVJfVElDSykNCg0KICAgICAgICAjIENSRUFURSBUQVNLUyBGT1IgVVNFUiBJTlBVVA0KICAgICAgICB0YXNrX2xlZnQgPSBhaW8uY3JlYXRlX3Rhc2sobGVmdF9idXR0b24uY29yb19jaGVjaygpKQ0KICAgICAgICB0YXNrX3JpZ2h0ID0gYWlvLmNyZWF0ZV90YXNrKHJpZ2h0X2J1dHRvbi5jb3JvX2NoZWNrKCkpDQogICAgICAgIHRhc2tfbWVudSA9IGFpby5jcmVhdGVfdGFzayhlbmNvZGVyX2J1dHRvbi5jb3JvX2NoZWNrKCkpDQogICAgICAgIA0KICAgICAgICBjdXJyZW50X2VuY29kZXJfY21kOiBzeXN0ZW1fY29tbWFuZC5zeXN0ZW1fY29tbWFuZCA9IHN5c3RlbV9jb21tYW5kLnN5c3RlbV9jb21tYW5kKCkNCiAgICAgICAgY3VycmVudF9lbmNvZGVyX2NtZC50eXBlID0gc3lzdGVtX2NvbW1hbmQuc3lzdGVtX2NvbW1hbmQuQ09NTUFORF9UWVBFX05BVklHQVRJT04NCiAgICAgICANCiAgICAgICAgd2hpbGUgVHJ1ZToNCiAgICAgICAgICAgIGF3YWl0IGFpby5zbGVlcF9tcygxKQ0KDQoNCiAgICAgICAgICAgICMgUVVFUlkgRU5DT0RFUiBBTkQgREVURVJNIFVTRVIgSU5UUFVUIFNUQVRFDQogICAgICAgICAgICBjdXJyZW50X2VuY29kZXJfdmFsdWUgPSBlbmNvZGVyLnZhbHVlKCkNCiAgICAgICAgICAgIGlmIGN1cnJlbnRfZW5jb2Rlcl92YWx1ZSAhPSBlbmNvZGVyX21pZGRsZV9wb2ludDoNCiAgICAgICAgICAgICAgICBjdXJyZW50X2VuY29kZXJfY21kLnZhbHVlID0gY3VycmVudF9lbmNvZGVyX3ZhbHVlDQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgaWYgY3VycmVudF9lbmNvZGVyX3ZhbHVlID4gZW5jb2Rlcl9taWRkbGVfcG9pbnQ6DQogICAgICAgICAgICAgICAgICAgIGVuY29kZXIuc2V0X2N1cnJlbnRfdmFsdWUoZW5jb2Rlcl9taWRkbGVfcG9pbnQpDQogICAgICAgICAgICAgICAgICAgIGN1cnJlbnRfZW5jb2Rlcl9jbWQuYWN0aW9uID0gc3lzdGVtX2NvbW1hbmQuc3lzdGVtX2NvbW1hbmQuTkFWSUdBVElPTl9MRUZUDQogICAgICAgICAgICAgICAgICAgIG1lbnVfbWFuYWdlci5tZW51X21hbmFnZXIoKS5wcm9jZXNzX3VzZXJfY29tbWFuZHMoY3VycmVudF9lbmNvZGVyX2NtZCkNCiAgICAgICAgICAgICAgICBlbGlmIGN1cnJlbnRfZW5jb2Rlcl92YWx1ZSA8IGVuY29kZXJfbWlkZGxlX3BvaW50Og0KICAgICAgICAgICAgICAgICAgICBlbmNvZGVyLnNldF9jdXJyZW50X3ZhbHVlKGVuY29kZXJfbWlkZGxlX3BvaW50KQ0KICAgICAgICAgICAgICAgICAgICBjdXJyZW50X2VuY29kZXJfY21kLmFjdGlvbiA9IHN5c3RlbV9jb21tYW5kLnN5c3RlbV9jb21tYW5kLk5BVklHQVRJT05fUklHSFQNCiAgICAgICAgICAgICAgICAgICAgbWVudV9tYW5hZ2VyLm1lbnVfbWFuYWdlcigpLnByb2Nlc3NfdXNlcl9jb21tYW5kcyhjdXJyZW50X2VuY29kZXJfY21kKQ0KICAgICAgICAgICAgICANCg0KICAgICAgICAgICAgIyBQRVJJT0RJQyBSRUFEIE9GIFRIRSBTQ0FMRQ0KICAgICAgICAgICAgaWYgIGFicyhsYXN0X3NjYWxlX3VwZGF0ZSAtIGhlbHBlci5taWxsaXMoKSkgPiAoNTAvVElNRV9FTEFQU0VEX0RJVklERVIpOg0KICAgICAgICAgICAgICAgIGxhc3Rfc2NhbGVfdXBkYXRlID0gaGVscGVyLm1pbGxpcygpDQogICAgICAgICAgICAgICAgIyBVUERBVEUgU0NBTEUgVkFMVUUgQU5EIFNFTkQgVE8gUFJPQ0VTUw0KICAgICAgICAgICAgICAgIGN1cnJlbnRfc2NhbGVfY21kLnZhbHVlID0gU2NhbGVJbnRlcmZhY2UoKS5nZXRfY3VycmVudF93ZWlnaHQoKQ0KICAgICAgICAgICAgICAgIG1lbnVfbWFuYWdlci5tZW51X21hbmFnZXIoKS5wcm9jZXNzX3N5c3RlbV9jb21tYW5kcyhjdXJyZW50X3NjYWxlX2NtZCkNCg0KICAgICAgICAgICAgIyBTWVNURU0gVElDSyBUTyBJTVBMRU1FTlQgVElNRVJTIFNVQ0ggQVMgV0FJVElORyBGT1IgWCBTRUNPTkRTIElOIFJFQ0lQRVMNCiAgICAgICAgICAgIGlmICBhYnMobGFzdF90aW1lcl91cGRhdGUgLSBoZWxwZXIubWlsbGlzKCkpID4gKDEwMDAvVElNRV9FTEFQU0VEX0RJVklERVIpOg0KICAgICAgICAgICAgICAgIGN1cnJlbnRfdGltZXJ0aWNrX2NtZC52YWx1ZSA9IGFicyhsYXN0X3RpbWVyX3VwZGF0ZSAtIGhlbHBlci5taWxsaXMoKSkNCiAgICAgICAgICAgICAgICBtZW51X21hbmFnZXIubWVudV9tYW5hZ2VyKCkucHJvY2Vzc19zeXN0ZW1fY29tbWFuZHMoY3VycmVudF90aW1lcnRpY2tfY21kKQ0KICAgICAgICAgICAgICAgIGxhc3RfdGltZXJfdXBkYXRlID0gaGVscGVyLm1pbGxpcygpDQoNCiAgICBhaW8ucnVuKG1haW5fdGFzaygpKQ0KDQo=", "menu_entry_calibration.py": "ZnJvbSBhYmMgaW1wb3J0IGFic3RyYWN0bWV0aG9kCmltcG9ydCBtZW51X2VudHJ5CmltcG9ydCBzeXN0ZW1fY29tbWFuZApmcm9tIHVpIGltcG9ydCB1aQpmcm9tIGxlZHJpbmcgaW1wb3J0IGxlZHJpbmcKZnJvbSBTY2FsZXMgaW1wb3J0IFNjYWxlSW50ZXJmYWNlCmltcG9ydCB0aW1lCmltcG9ydCBjb25maWcKaW1wb3J0IHN0YXRpY19tb2R1bGVzLm1lbnVfbWFuYWdlciBhcyBtZW51X21hbmFnZXIKaW1wb3J0IHNldHRpbmdzCgoKY2xhc3MgbWVudV9lbnRyeV9jYWxpYnJhdGlvbihtZW51X2VudHJ5Lm1lbnVfZW50cnkpOgoKICAgIE1FTlVfU1RBVEVfQ0xFQVJfUExBVEVfSU5JVCA9IDAKICAgIE1FTlVfU1RBVEVfQ0xFQVJfUExBVEVfVEFSSU5HID0gMQoKICAgIE1FTlVfU1RBVEVfRlVMTF9QTEFURV9JTklUID0gMgogICAgTUVOVV9TVEFURV9GVUxMX1BMQVRFX1BMQUNFID0gMwogICAgTUVOVV9TVEFURV9GVUxMX1BMQVRFX1RBUklORyA9IDQKCiAgICBNRUFTVVJFTUVOVF9BVkVSQUdJTkdfUE9JTlRTOiBpbnQgPSAxMAogICAgQ0FMSUJSQVRJT05fV0VJR0hUX1VTRVJfU1RFUFM6IGZsb2F0ID0gNS4wCiAgICBNSU5fQ0FMSUJSQVRJT05fV0VJR0hUOiBmbG9hdCA9IDUwLjAKICAgIG1lbnVfc3RhdGU6IGludCA9IDAKCiAgICBjYWxpYnJhdGlvbl92YWx1ZV9lbXB0eTogZmxvYXQgPSAwLjAKICAgIGNhbGlicmF0aW9uX3ZhbHVlX2Z1bGw6IGZsb2F0ID0gMC4wCiAgICBjYWxpYnJhdGlvbl92YWx1ZV9pbnZlcnQ6IGZsb2F0ID0gMS4wCiAgICBjYWxpYnJhdGlvbl93ZWlnaHRfd2VpZ2h0OiBmbG9hdCA9IG1heChjb25maWcuQ0ZHX0NBTElCUkFUSU9OX1dFSUdIVF9XRUlHSFQsIE1JTl9DQUxJQlJBVElPTl9XRUlHSFQpCgogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIHN1cGVyKCkuX19pbml0X18oIkNBTElCUkFUSU9OIiwgIkNhbGlicmF0ZSBzeXN0ZW0gc2NhbGUiKQoKICAgIGRlZiBwcmV2aWV3KHNlbGYpOgogICAgICAgIHByaW50KCJwcmV2aWV3IHt9Ii5mb3JtYXQoc2VsZi5uYW1lKSkKICAgICAgICB1aSgpLnNob3dfcmVjaXBlX2luZm9ybWF0aW9uKHNlbGYubmFtZSwgc2VsZi5kZXNjcmlwdGlvbikKCgogICAgZGVmIGFjdGl2YXRlKHNlbGYpOgogICAgICAgIHByaW50KCJhY3RpdmF0ZSB7fSIuZm9ybWF0KHNlbGYubmFtZSkpCiAgICAgICAgCiAgICAgICAgU2NhbGVJbnRlcmZhY2UoKS5yZXNldF9jYWxpYnJhdGlvbigpCiAgICAgICAgbGVkcmluZygpLnNldF9uZW9waXhlbF9mdWxsKDEwLCAxMCwgMTApCgogICAgICAgIHVpKCkuc2hvd19tc2coIlBsZWFzZSBjbGVhciBzY2FsZSBwbGF0ZSBhbmQgcHJlc3Mgb2siKQogICAgICAgIHNlbGYubWVudV9zdGF0ZSA9IHNlbGYuTUVOVV9TVEFURV9DTEVBUl9QTEFURV9JTklUCgogICAgICAgICMgUkVTRVQgTUVBU1VSRUQgVkFMVUVTCiAgICAgICAgc2VsZi5jYWxpYnJhdGlvbl92YWx1ZV9lbXB0eSA9IDAuMAogICAgICAgIHNlbGYuY2FsaWJyYXRpb25fdmFsdWVfZnVsbCA9IDAuMAogICAgICAgIHNlbGYuY2FsaWJyYXRpb25fdmFsdWVfaW52ZXJ0ID0gMS4wCiAgICAgICAgc2VsZi5jYWxpYnJhdGlvbl93ZWlnaHRfd2VpZ2h0ID0gbWF4KGNvbmZpZy5DRkdfQ0FMSUJSQVRJT05fV0VJR0hUX1dFSUdIVCwgc2VsZi5NSU5fQ0FMSUJSQVRJT05fV0VJR0hUKQoKCiAgICBkZWYgdGVhcmRvd24oc2VsZik6CiAgICAgICAgcHJpbnQoInRlYXJkb3duIHt9Ii5mb3JtYXQoc2VsZi5uYW1lKSkKCgogICAgZGVmIHVwZGF0ZShzZWxmLCBfc3lzdGVtX2NvbW1hbmQ6IHN5c3RlbV9jb21tYW5kLnN5c3RlbV9jb21tYW5kKToKICAgICAgICBpZiBfc3lzdGVtX2NvbW1hbmQudHlwZSA9PSBzeXN0ZW1fY29tbWFuZC5zeXN0ZW1fY29tbWFuZC5DT01NQU5EX1RZUEVfTkFWSUdBVElPTjoKICAgICAgICAgICAgCiAgICAgICAgICAgIGlmIHNlbGYubWVudV9zdGF0ZSA9PSBzZWxmLk1FTlVfU1RBVEVfQ0xFQVJfUExBVEVfSU5JVCBhbmQgX3N5c3RlbV9jb21tYW5kLmFjdGlvbiA9PSBzeXN0ZW1fY29tbWFuZC5zeXN0ZW1fY29tbWFuZC5OQVZJR0FUSU9OX0VOVEVSOgogICAgICAgICAgICAgICAgc2VsZi5tZW51X3N0YXRlID0gc2VsZi5NRU5VX1NUQVRFX0NMRUFSX1BMQVRFX1RBUklORwogICAgICAgICAgICAgICAgbGVkcmluZygpLnNldF9uZW9waXhlbF9mdWxsKDUwLCAwLCAwKQogICAgICAgICAgICAgICAgdWkoKS5zaG93X3JlY2lwZV9pbmZvcm1hdGlvbigiUExFQVNFIFdBSVQiLCAiVEFSSU5HIikKICAgICAgICAgICAgICAgIHRpbWUuc2xlZXAoMikKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgZm9yIGkgaW4gcmFuZ2Uoc2VsZi5NRUFTVVJFTUVOVF9BVkVSQUdJTkdfUE9JTlRTKToKICAgICAgICAgICAgICAgICAgICBsZWRyaW5nKCkuc2V0X25lb3BpeGVsX3BlcmNlbnRhZ2UoaS8oc2VsZi5NRUFTVVJFTUVOVF9BVkVSQUdJTkdfUE9JTlRTKjEuMCkpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5jYWxpYnJhdGlvbl92YWx1ZV9lbXB0eSArPSBTY2FsZUludGVyZmFjZSgpLmdldF9jdXJyZW50X3dlaWdodCgpCiAgICAgICAgICAgICAgICAgICAgdWkoKS5zaG93X3JlY2lwZV9pbmZvcm1hdGlvbigiUExFQVNFIFdBSVQiLCAiTUVBU1VSSU5HOiB7fS97fSIuZm9ybWF0KGksIHNlbGYuTUVBU1VSRU1FTlRfQVZFUkFHSU5HX1BPSU5UUykpCiAgICAgICAgICAgICAgICAgICAgdGltZS5zbGVlcCgwLjUpCgogICAgICAgICAgICAgICAgc2VsZi5jYWxpYnJhdGlvbl92YWx1ZV9lbXB0eSA9IHNlbGYuY2FsaWJyYXRpb25fdmFsdWVfZW1wdHkgL3NlbGYuTUVBU1VSRU1FTlRfQVZFUkFHSU5HX1BPSU5UUwogICAgICAgICAgICAgICAgdWkoKS5zaG93X3JlY2lwZV9pbmZvcm1hdGlvbigiRklSU1QgUlVOIERPTkUiLCAiUkFXX1ZBTFVFOnt9Ii5mb3JtYXQoc2VsZi5jYWxpYnJhdGlvbl92YWx1ZV9lbXB0eSkpCiAgICAgICAgICAgICAgICB0aW1lLnNsZWVwKDEpCiAgICAgICAgICAgICAgICBzZWxmLm1lbnVfc3RhdGUgPSBzZWxmLk1FTlVfU1RBVEVfRlVMTF9QTEFURV9JTklUCiAgICAgICAgICAgICAgICB1aSgpLmNsZWFyKCkKICAgICAgICAgICAgICAgIHVpKCkuc2hvd19yZWNpcGVfaW5mb3JtYXRpb24oIlNFVCBSRUZFUkVOQ0UgV0VJR0hUIiwgIlxuXG4ge31nIi5mb3JtYXQoc2VsZi5jYWxpYnJhdGlvbl93ZWlnaHRfd2VpZ2h0KSkKCiAgICAgICAgICAgICAgICBsZWRyaW5nKCkuc2V0X25lb3BpeGVsX2Z1bGwoMCwgMCwgMTApCgoKICAgICAgICAgICAgZWxpZiBzZWxmLm1lbnVfc3RhdGUgPT0gc2VsZi5NRU5VX1NUQVRFX0ZVTExfUExBVEVfSU5JVDoKICAgICAgICAgICAgICAgIAoKICAgICAgICAgICAgICAgIGlmIF9zeXN0ZW1fY29tbWFuZC5hY3Rpb24gPT0gc3lzdGVtX2NvbW1hbmQuc3lzdGVtX2NvbW1hbmQuTkFWSUdBVElPTl9FTlRFUjoKICAgICAgICAgICAgICAgICAgICBpZiBzZWxmLmNhbGlicmF0aW9uX3dlaWdodF93ZWlnaHQgPj0gc2VsZi5NSU5fQ0FMSUJSQVRJT05fV0VJR0hUOgogICAgICAgICAgICAgICAgICAgICAgICB1aSgpLnNob3dfbXNnKCJQbGVhc2UgcGxhY2UgY2FsaWJyYXRpb24gd2VpZ2h0IG9uIHRoZSBwbGF0ZSBhbmQgcHJlc3Mgb2siKQogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLm1lbnVfc3RhdGUgPSAgc2VsZi5NRU5VX1NUQVRFX0ZVTExfUExBVEVfUExBQ0UKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgdWkoKS5zaG93X21zZygiQ2FsaWJyYXRpb24gd2VpZ2h0IG11c3QgYmUgYXQgbGVhc3Qge31nIi5mb3JtYXQoc2VsZi5NSU5fQ0FMSUJSQVRJT05fV0VJR0hUKSkKICAgICAgICAgICAgICAgICAgICAgICAgdGltZS5zbGVlcCgyKQoKICAgICAgICAgICAgICAgIGVsaWYgX3N5c3RlbV9jb21tYW5kLmFjdGlvbiA9PSBzeXN0ZW1fY29tbWFuZC5zeXN0ZW1fY29tbWFuZC5OQVZJR0FUSU9OX1JJR0hUOgogICAgICAgICAgICAgICAgICAgIHNlbGYuY2FsaWJyYXRpb25fd2VpZ2h0X3dlaWdodCA9IHNlbGYuY2FsaWJyYXRpb25fd2VpZ2h0X3dlaWdodCArIHNlbGYuQ0FMSUJSQVRJT05fV0VJR0hUX1VTRVJfU1RFUFMKICAgICAgICAgICAgICAgIGVsaWYgX3N5c3RlbV9jb21tYW5kLmFjdGlvbiA9PSBzeXN0ZW1fY29tbWFuZC5zeXN0ZW1fY29tbWFuZC5OQVZJR0FUSU9OX0xFRlQ6CiAgICAgICAgICAgICAgICAgICAgaWYgc2VsZi5jYWxpYnJhdGlvbl93ZWlnaHRfd2VpZ2h0ID49IChzZWxmLk1JTl9DQUxJQlJBVElPTl9XRUlHSFQgKyBzZWxmLkNBTElCUkFUSU9OX1dFSUdIVF9VU0VSX1NURVBTKToKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5jYWxpYnJhdGlvbl93ZWlnaHRfd2VpZ2h0ID0gc2VsZi5jYWxpYnJhdGlvbl93ZWlnaHRfd2VpZ2h0IC0gc2VsZi5DQUxJQlJBVElPTl9XRUlHSFRfVVNFUl9TVEVQUwoKICAgICAgICAgICAgICAgICMgVVBEQVRFIFZBTFVFIE9OIERJU1BMQVkKICAgICAgICAgICAgICAgIHVpKCkuY2xlYXIoKQogICAgICAgICAgICAgICAgdWkoKS5zaG93X3JlY2lwZV9pbmZvcm1hdGlvbigiU0VUIFJFRiBXRUlHSFQiLCAiXG5cbiB7fWciLmZvcm1hdChzZWxmLmNhbGlicmF0aW9uX3dlaWdodF93ZWlnaHQpKQoKCiAgICAgICAgICAgIGVsaWYgc2VsZi5tZW51X3N0YXRlID09IHNlbGYuTUVOVV9TVEFURV9GVUxMX1BMQVRFX1BMQUNFOgogICAgICAgICAgICAgICAgaWYgX3N5c3RlbV9jb21tYW5kLmFjdGlvbiA9PSBzeXN0ZW1fY29tbWFuZC5zeXN0ZW1fY29tbWFuZC5OQVZJR0FUSU9OX0VOVEVSOgogICAgICAgICAgICAgICAgICAgIGxlZHJpbmcoKS5zZXRfbmVvcGl4ZWxfZnVsbCg1MCwgMCwgMCkKICAgICAgICAgICAgICAgICAgICB1aSgpLnNob3dfcmVjaXBlX2luZm9ybWF0aW9uKCJQTEVBU0UgV0FJVCIsICJUQVJJTkciKQogICAgICAgICAgICAgICAgICAgIHRpbWUuc2xlZXAoMikKICAgICAgICAgICAgICAgICAgICBzZWxmLm1lbnVfc3RhdGUgPSBzZWxmLk1FTlVfU1RBVEVfQ0xFQVJfUExBVEVfVEFSSU5HCgogICAgICAgICAgICAgICAgICAgIGZvciBpIGluIHJhbmdlKHNlbGYuTUVBU1VSRU1FTlRfQVZFUkFHSU5HX1BPSU5UUyk6CiAgICAgICAgICAgICAgICAgICAgICAgIGxlZHJpbmcoKS5zZXRfbmVvcGl4ZWxfcGVyY2VudGFnZShpLyhzZWxmLk1FQVNVUkVNRU5UX0FWRVJBR0lOR19QT0lOVFMqMS4wKSkKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5jYWxpYnJhdGlvbl92YWx1ZV9mdWxsICs9IFNjYWxlSW50ZXJmYWNlKCkuZ2V0X3VudGFyZWRfd2VpZ2h0KCkKICAgICAgICAgICAgICAgICAgICAgICAgdWkoKS5zaG93X3JlY2lwZV9pbmZvcm1hdGlvbigiUExFQVNFIFdBSVQiLCAiTUVBU1VSSU5HOiB7fS97fSIuZm9ybWF0KGksIHNlbGYuTUVBU1VSRU1FTlRfQVZFUkFHSU5HX1BPSU5UUykpCiAgICAgICAgICAgICAgICAgICAgICAgIHRpbWUuc2xlZXAoMC41KQoKICAgICAgICAgICAgICAgICAgICBzZWxmLmNhbGlicmF0aW9uX3ZhbHVlX2Z1bGwgPSBzZWxmLmNhbGlicmF0aW9uX3ZhbHVlX2Z1bGwgL3NlbGYuTUVBU1VSRU1FTlRfQVZFUkFHSU5HX1BPSU5UUwogICAgICAgICAgICAgICAgICAgIHVpKCkuc2hvd19yZWNpcGVfaW5mb3JtYXRpb24oIlNFQ09ORCBSVU4iLCAiUkFXX1ZBTFVFOnt9L3t9Ii5mb3JtYXQoc2VsZi5jYWxpYnJhdGlvbl92YWx1ZV9lbXB0eSwgc2VsZi5jYWxpYnJhdGlvbl92YWx1ZV9mdWxsKSkKICAgICAgICAgICAgICAgICAgICB0aW1lLnNsZWVwKDIpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5tZW51X3N0YXRlID0gc2VsZi5NRU5VX1NUQVRFX0ZVTExfUExBVEVfSU5JVAogICAgICAgICAgICAgICAgICAgICMgREVURVJNIFRIRSBMT0FEQ0VMTCBPUklFTlRBVElPTgogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIHNlbGYuY2FsaWJyYXRpb25fdmFsdWVfaW52ZXJ0ID0gMS4wCiAgICAgICAgICAgICAgICAgICAgc2V0dGluZ3Muc2V0dGluZ3MoKS5zYXZlX3NjYWxlX2NhbGlicmF0aW9uX3ZhbHVlcyhzZWxmLmNhbGlicmF0aW9uX3ZhbHVlX2VtcHR5LCBzZWxmLmNhbGlicmF0aW9uX3ZhbHVlX2Z1bGwsIHNlbGYuY2FsaWJyYXRpb25fd2VpZ2h0X3dlaWdodCwgc2VsZi5jYWxpYnJhdGlvbl92YWx1ZV9pbnZlcnQpCiAgICAgICAgICAgICAgICAgICAgU2NhbGVJbnRlcmZhY2UoKS5yZWxvYWRfY2FsaWJyYXRpb24oKQogICAgICAgICAgICAgICAgICAgIGNhbGlicmF0ZWRfbWVhc3VyZW1lbnQ6IGZsb2F0ID0gMC4wCiAgICAgICAgICAgICAgICAgICAgIyBGSVJTVCBSRUFEIHggRFVNTVkgUkVBRFMgVEhFTiBVU0UgVEhFIExFRlQgT1ZFUiBUTyBDQUxDVUxBVEUgRklOQUwgQURESVRJT05BTCBPRkZTRVQKICAgICAgICAgICAgICAgICAgICBmb3IgaSBpbiByYW5nZShzZWxmLk1FQVNVUkVNRU5UX0FWRVJBR0lOR19QT0lOVFMpOgogICAgICAgICAgICAgICAgICAgICAgICBsZWRyaW5nKCkuc2V0X25lb3BpeGVsX3BlcmNlbnRhZ2UoaS8oc2VsZi5NRUFTVVJFTUVOVF9BVkVSQUdJTkdfUE9JTlRTKSkKICAgICAgICAgICAgICAgICAgICAgICAgU2NhbGVJbnRlcmZhY2UoKS5nZXRfdW50YXJlZF93ZWlnaHQoKQoKICAgICAgICAgICAgICAgICAgICBsZWRyaW5nKCkuc2V0X25lb3BpeGVsX2Z1bGwoNTAsIDAsIDApCiAgICAgICAgICAgICAgICAgICAgdGltZS5zbGVlcCgxLjApCiAgICAgICAgICAgICAgICAgICAgY3c6IGZsb2F0ID0gMC4wCiAgICAgICAgICAgICAgICAgICAgZm9yIGkgaW4gcmFuZ2Uoc2VsZi5NRUFTVVJFTUVOVF9BVkVSQUdJTkdfUE9JTlRTKToKICAgICAgICAgICAgICAgICAgICAgICAgbGVkcmluZygpLnNldF9uZW9waXhlbF9wZXJjZW50YWdlKGkvKHNlbGYuTUVBU1VSRU1FTlRfQVZFUkFHSU5HX1BPSU5UUyoxLjApKSAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgIGN3ID0gU2NhbGVJbnRlcmZhY2UoKS5nZXRfdW50YXJlZF93ZWlnaHQoKQogICAgICAgICAgICAgICAgICAgICAgICB1aSgpLnNob3dfcmVjaXBlX2luZm9ybWF0aW9uKCJUSFJJRCBSVU4iLCAiQ1VSUkVOVCBXRUlHSFQ6IHt9IHt9Ii5mb3JtYXQoY3csIGNhbGlicmF0ZWRfbWVhc3VyZW1lbnQpKSAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgIGNhbGlicmF0ZWRfbWVhc3VyZW1lbnQgKz0gY3cgCgoKICAgICAgICAgICAgICAgICAgICBjYWxpYnJhdGVkX21lYXN1cmVtZW50ID0gKGNhbGlicmF0ZWRfbWVhc3VyZW1lbnQgLyBzZWxmLk1FQVNVUkVNRU5UX0FWRVJBR0lOR19QT0lOVFMpCiAgICAgICAgICAgICAgICAgICAgaWYgY2FsaWJyYXRlZF9tZWFzdXJlbWVudCA8PSAwLjA6CiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuY2FsaWJyYXRpb25fdmFsdWVfaW52ZXJ0ID0gLTEuMAogICAgICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuY2FsaWJyYXRpb25fdmFsdWVfaW52ZXJ0ID0gMS4wCiAgICAgICAgICAgICAgICAgICAgI3NlbGYuY2FsaWJyYXRpb25fdmFsdWVfaW52ZXJ0ID0gc2VsZi5jYWxpYnJhdGlvbl93ZWlnaHRfd2VpZ2h0IC8gY2FsaWJyYXRlZF9tZWFzdXJlbWVudAogICAgICAgICAgICAgICAgICAgIHVpKCkuc2hvd19yZWNpcGVfaW5mb3JtYXRpb24oIlRIUklEIFJVTiIsICJJTlZFUlRfRkFDVE9SOiB7fSAtIHt9Ii5mb3JtYXQoc2VsZi5jYWxpYnJhdGlvbl92YWx1ZV9pbnZlcnQsIGNhbGlicmF0ZWRfbWVhc3VyZW1lbnQpKQogICAgICAgICAgICAgICAgICAgIHRpbWUuc2xlZXAoMikKICAgICAgICAgICAgICAgICAgICB1aSgpLnNob3dfbXNnKCJTQVZFIENBTElCUkFUSU9OIikKICAgICAgICAgICAgICAgICAgICBsZWRyaW5nKCkuc2V0X25lb3BpeGVsX2Z1bGwoMCwgMCwgMTApCgogICAgICAgICAgICAgICAgICAgICMgU0FWRSBDQUxJQlJBVElPTiBUTyBGSUxFCiAgICAgICAgICAgICAgICAgICAgI2lmIHNlbGYuY2FsaWJyYXRpb25fdmFsdWVfZW1wdHkgPiBzZWxmLmNhbGlicmF0aW9uX3ZhbHVlX2Z1bGw6CiAgICAgICAgICAgICAgICAgICAgIyAgIHQ6IGZsb2F0ID0gc2VsZi5jYWxpYnJhdGlvbl92YWx1ZV9lbXB0eQogICAgICAgICAgICAgICAgICAgICMgICBzZWxmLmNhbGlicmF0aW9uX3ZhbHVlX2VtcHR5ID0gc2VsZi5jYWxpYnJhdGlvbl92YWx1ZV9mdWxsCiAgICAgICAgICAgICAgICAgICAgIyAgIHNlbGYuY2FsaWJyYXRpb25fdmFsdWVfZnVsbCA9IHQKCiAgICAgICAgICAgICAgICAgICAgc2V0dGluZ3Muc2V0dGluZ3MoKS5zYXZlX3NjYWxlX2NhbGlicmF0aW9uX3ZhbHVlcyhzZWxmLmNhbGlicmF0aW9uX3ZhbHVlX2VtcHR5LCBzZWxmLmNhbGlicmF0aW9uX3ZhbHVlX2Z1bGwsIHNlbGYuY2FsaWJyYXRpb25fd2VpZ2h0X3dlaWdodCwgc2VsZi5jYWxpYnJhdGlvbl92YWx1ZV9pbnZlcnQpCiAgICAgICAgICAgICAgICAgICAgI0xPQUQgTkVXIENBTElCUkFJT04gRkFDVE9SIElOCiAgICAgICAgICAgICAgICAgICAgU2NhbGVJbnRlcmZhY2UoKS5yZWxvYWRfY2FsaWJyYXRpb24oKQogICAgICAgICAgICAgICAgICAgICMgTEVBVkUgTUVOVQogICAgICAgICAgICAgICAgICAgIG1lbnVfbWFuYWdlci5tZW51X21hbmFnZXIoKS5leGl0X2N1cnJlbnRfbWVudSgpCgoKICAgICAgICAgICAgICAgICAgICAKCg=="}

# FOR DEBUGGING
ALWAYS_HARD_RESTORE: bool = False

RESTORE_IGNORED_FILES_LIST = ['static_modules', 'thridparty_libs', 'boot.py', 'lib', 'fsdatareconstructor']

def restore_filesystem(_basepath: str = "/", _override: bool = False, _erase: bool = False):
    import ubinascii
    import os

    if _erase:
        print("erase enabled")
        for f in os.listdir():
            if f in __file__:
                print("skipping {} to vaoid installer override".format(f))
                continue 
            
            # UGLY REWORK
            for n in RESTORE_IGNORED_FILES_LIST:
                if n in f:
                    print("skipping {} to vaoid installer override".format(f))
                    continue

            os.remove(f)

    for k in FILE_DATA:

        if k in os.listdir() and not _override:
            continue
        
        print(k)
        d = FILE_DATA[k]
        ubinascii.a2b_base64(d)

        with open(_basepath + "/" + k, "w") as file:
            file.write(ubinascii.a2b_base64(d))

    # CLEANUP
    del ubinascii
    del os


def restore(_hard_restore: bool = False):
    import machine
    import time
    RESTORE_BUTTON_PIN: int = 15
    RESTORE_LED_PIN: int = 25

    push_button_restore = machine.Pin(RESTORE_BUTTON_PIN, machine.Pin.IN, machine.Pin.PULL_UP)
    led_onboard = machine.Pin(RESTORE_LED_PIN, machine.Pin.OUT)

    if not push_button_restore.value() or ALWAYS_HARD_RESTORE or _hard_restore:
        led_onboard.on()
        time.sleep(0.2)
        led_onboard.off()
        time.sleep(0.2)
        led_onboard.on()
        time.sleep(0.2)
        led_onboard.on()
        # RESTORE HARD OVERRIDE USER CHANGES
        restore_filesystem(_override=True, _erase=True)
        led_onboard.off()

    else:
        led_onboard.on()
        # RESTORE SOFT ONLY ADD MISSING FILES IN VIRTUAL FS
        restore_filesystem()
        led_onboard.off()

    # RESTORE PIN STATE
    machine.Pin(RESTORE_BUTTON_PIN, machine.Pin.IN, machine.Pin.OPEN_DRAIN)
    machine.Pin(RESTORE_LED_PIN, machine.Pin.IN)
    
    del machine


if __name__ == "__main__":
    restore()

